{"cells":[{"cell_type":"code","source":["# !sudo apt-get install -y fonts-nanum\n","# !sudo fc-cache -fv\n","# !rm ~/.cache/matplotlib -rf # 런타임 재시작 필요"],"metadata":{"id":"bdyHOwlPq_FN","executionInfo":{"status":"ok","timestamp":1701144497761,"user_tz":-540,"elapsed":726,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["\n","import matplotlib.pyplot as plt\n","from matplotlib import rc\n","\n","rc('font', family='NanumGothic')\n","plt.rcParams['axes.unicode_minus'] = False"],"metadata":{"id":"DGsec7ncrWGj","executionInfo":{"status":"ok","timestamp":1701144499031,"user_tz":-540,"elapsed":628,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GOAa-42mFwRr","colab":{"base_uri":"https://localhost:8080/"},"outputId":"41e46210-bc9f-4c97-a398-c8cc6a431876"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: optuna in /usr/local/lib/python3.10/dist-packages (3.4.0)\n","Requirement already satisfied: alembic>=1.5.0 in /usr/local/lib/python3.10/dist-packages (from optuna) (1.12.1)\n","Requirement already satisfied: colorlog in /usr/local/lib/python3.10/dist-packages (from optuna) (6.7.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from optuna) (1.23.5)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from optuna) (23.2)\n","Requirement already satisfied: sqlalchemy>=1.3.0 in /usr/local/lib/python3.10/dist-packages (from optuna) (2.0.23)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from optuna) (4.66.1)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.10/dist-packages (from optuna) (6.0.1)\n","Requirement already satisfied: Mako in /usr/local/lib/python3.10/dist-packages (from alembic>=1.5.0->optuna) (1.3.0)\n","Requirement already satisfied: typing-extensions>=4 in /usr/local/lib/python3.10/dist-packages (from alembic>=1.5.0->optuna) (4.5.0)\n","Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.10/dist-packages (from sqlalchemy>=1.3.0->optuna) (3.0.1)\n","Requirement already satisfied: MarkupSafe>=0.9.2 in /usr/local/lib/python3.10/dist-packages (from Mako->alembic>=1.5.0->optuna) (2.1.3)\n"]}],"source":["!pip install optuna"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mnN-KYrOxo_D"},"outputs":[],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ApYbkF_H12eb"},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import os\n","import random\n","from tqdm.auto import tqdm\n","import optuna\n","\n","# DATA_PATH = \"/content/drive/MyDrive/DACON_DAEGU/data/\"\n","DATA_PATH = '/content/drive/MyDrive/데이터 분석/데이콘 캐글 컴페티션/예슬 개인 참가/대구 교통사고 피해 예측/data/'\n","SEED = 42"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HdZD9ZFYUJLN"},"outputs":[],"source":["def seed_everything(seed):\n","    random.seed(seed)\n","    os.environ['PYTHONHASHSEED'] = str(seed)\n","    np.random.seed(seed)\n","\n","seed_everything(SEED)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"95j4Fl6vGAlY"},"outputs":[],"source":["import numpy as snp\n","import matplotlib.pyplot as plt\n","%matplotlib inline\n","import seaborn as sns\n","from datetime import datetime\n","import warnings\n","warnings.filterwarnings(action='ignore')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oe5-_qWdGEDe"},"outputs":[],"source":["from lightgbm import LGBMRegressor\n","from xgboost import XGBRegressor\n","from sklearn.linear_model import LinearRegression\n","from sklearn.tree import DecisionTreeClassifier, DecisionTreeRegressor\n","from sklearn.ensemble import RandomForestClassifier, RandomForestRegressor\n","from lightgbm import LGBMClassifier, LGBMRegressor\n","from sklearn import tree\n","# from catboost import CatBoostRegressor\n","from sklearn.preprocessing import MinMaxScaler, LabelEncoder\n","\n","from sklearn.model_selection import KFold, train_test_split, cross_val_score, StratifiedKFold\n","from sklearn.metrics import confusion_matrix, accuracy_score, classification_report\n","from sklearn.metrics import mean_absolute_error, r2_score, mean_squared_error, make_scorer, mean_squared_log_error"]},{"cell_type":"markdown","metadata":{"id":"XnOXfEebGGcW"},"source":["# DATA Load"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"26YvH7WwyEjz"},"outputs":[],"source":["train_df = pd.read_csv(f\"{DATA_PATH}train.csv\")\n","test_df = pd.read_csv(f\"{DATA_PATH}test.csv\")\n","accident_df = pd.read_csv(f\"{DATA_PATH}countrywide_accident.csv\")\n","DG_cctv = pd.read_csv(f\"{DATA_PATH}대구 CCTV 정보.csv\", encoding='cp949')\n","DG_parking = pd.read_csv(f\"{DATA_PATH}대구 주차장 정보.csv\", encoding='cp949')\n","DG_children_area = pd.read_csv(f\"{DATA_PATH}대구 어린이 보호 구역 정보.csv\", encoding='cp949')\n","DG_seculight = pd.read_csv(f\"{DATA_PATH}대구 보안등 정보.csv\", encoding='cp949')\n","submission = pd.read_csv(f\"{DATA_PATH}sample_submission.csv\")\n","\n","train_df.shape, test_df.shape, # accident_df.shape, cctv_df.shape, park_df.shape, zone_df.shape, security_df.shape"]},{"cell_type":"code","source":["time_pattern = r'(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2})'\n","\n","train_df[['연', '월', '일', '시간']] = train_df['사고일시'].str.extract(time_pattern)\n","train_df[['연', '월', '일', '시간']] = train_df[['연', '월', '일', '시간']].apply(pd.to_numeric)\n","train_df = train_df.drop(columns=['사고일시'])\n","\n","test_df[['연', '월', '일', '시간']] = test_df['사고일시'].str.extract(time_pattern)\n","test_df[['연', '월', '일', '시간']] = test_df[['연', '월', '일', '시간']].apply(pd.to_numeric)\n","test_df = test_df.drop(columns=['사고일시'])"],"metadata":{"id":"X6whvzRypvUH"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["location_pattern = r'(\\S+) (\\S+) (\\S+)'\n","\n","train_df[['도시', '구', '동']] = train_df['시군구'].str.extract(location_pattern)\n","train_df = train_df.drop(columns=['시군구'])\n","\n","# test 데이터 반영\n","test_df[['도시', '구', '동']] = test_df['시군구'].str.extract(location_pattern)\n","test_df = test_df.drop(columns=['시군구'])"],"metadata":{"id":"d2fA3CjFpxVN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["road_pattern = r'(.+) - (.+)'\n","\n","train_df[['도로형태1', '도로형태2']] = train_df['도로형태'].str.extract(road_pattern)\n","train_df = train_df.drop(columns=['도로형태'])\n","\n","# test 데이터 반영\n","test_df[['도로형태1', '도로형태2']] = test_df['도로형태'].str.extract(road_pattern)\n","test_df = test_df.drop(columns=['도로형태'])"],"metadata":{"id":"5VoKdw96py6H"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# train_df = pd.read_csv(f'{DATA_PATH}train_df_150_1125.csv')\n","# test_df = pd.read_csv(f'{DATA_PATH}test_df_150_1125.csv')\n","\n","train_df.shape, test_df.shape"],"metadata":{"id":"Xo3gX-bQtI6R"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Feature 1 : train에만 있는 feature\n","\n","- 세부분류\n","- 법규위반\n","- 가해운전자/피해운전자 차종\n","- 가해운전자/피해운전자 성별\n","- 가해운전자/피해운전자 연령\n","\n","- 피해운전자 상해정도별 -> ECLO는 숫자, 상해정도는 개별, 총 ECLO와의 인과관계 적어서 일단 제거함"],"metadata":{"id":"fGIfJT9xNZha"}},{"cell_type":"code","source":["train_ft1 = pd.read_csv(f\"{DATA_PATH}train.csv\")\n","train_ft1\n","\n","# 시간\n","time_pattern = r'(\\d{4})-(\\d{1,2})-(\\d{1,2}) (\\d{1,2})'\n","\n","train_ft1[['연', '월', '일', '시간']] = train_ft1['사고일시'].str.extract(time_pattern)\n","train_ft1[['연', '월', '일', '시간']] = train_ft1[['연', '월', '일', '시간']].apply(pd.to_numeric)\n","train_ft1 = train_ft1.drop(columns=['사고일시'])\n","\n","# 시군구\n","location_pattern = r'(\\S+) (\\S+) (\\S+)'\n","\n","train_ft1[['도시', '구', '동']] = train_ft1['시군구'].str.extract(location_pattern)\n","train_ft1 = train_ft1.drop(columns=['시군구'])\n","\n","# 도로형태\n","\n","road_pattern = r'(.+) - (.+)'\n","\n","train_ft1[['도로형태1', '도로형태2']] = train_ft1['도로형태'].str.extract(road_pattern)\n","train_ft1 = train_ft1.drop(columns=['도로형태'])"],"metadata":{"id":"QMgS-YQyOHnN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["basic_cols = train_ft1.iloc[:, list(range(1, 5)) + list(range(20, len(train_ft1.columns)))].columns.tolist()\n","basic_cols"],"metadata":{"id":"qvp-Y90aOVzy"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["- 세부분류"],"metadata":{"id":"xFSA5qzGPsD1"}},{"cell_type":"code","source":["df = train_ft1.groupby(['사고유형 - 세부분류'])[['ECLO']].mean().reset_index()\n","df0 = train_ft1.groupby(['사고유형 - 세부분류'])[['ECLO']].count().reset_index().iloc[:,1:]\n","df1 = train_ft1.groupby(['사고유형 - 세부분류'])[['ECLO']].sum().reset_index().iloc[:,1:]\n","df2 = train_ft1.groupby(['사고유형 - 세부분류'])[['ECLO']].min().reset_index().iloc[:,1:]\n","df3 = train_ft1.groupby(['사고유형 - 세부분류'])[['ECLO']].max().reset_index().iloc[:,1:]\n","df4 = train_ft1.groupby(['사고유형 - 세부분류'])[['ECLO']].median().reset_index().iloc[:,1:]\n","df5 = train_ft1.groupby(['사고유형 - 세부분류'])[['ECLO']].std().reset_index().iloc[:,1:]\n","\n","# 실험\n","df_acc = pd.concat([df, df4,df0, df1, df2, df3, df5], axis=1)\n","df_acc.columns = ['사고유형 - 세부분류','median','mean','count','sum','min','max','std']\n","df_acc['max_mean'] = df_acc['max'] * df_acc['mean']\n","df_acc['max_median'] = df_acc['max'] * df_acc['median']\n","df_acc['max_std'] = df_acc['max'] * df_acc['std']\n","df_acc['mean_median'] = df_acc['mean'] * df_acc['median']\n","df_acc['max_count'] = df_acc['max'] * (df_acc['count'])\n","df_acc['max_count_medianmean'] = df_acc['max'] * df_acc['count'] * (df_acc['mean'] + df_acc['median'])/2\n","df_acc['max_count_log'] = df_acc['max'] * np.log(df_acc['count'])\n","\n","# max count_log의 조합을 기준으로 정렬해서 라벨 인코딩 (비슷한 범주가 라벨링된다는 가정하에 범주를 평균할 수 있으므로)\n","df_acc = df_acc.sort_values(by='max_count_log', ascending=False)\n","# display(df_acc)\n","\n","df_cols = df_acc['사고유형 - 세부분류'].tolist()"],"metadata":{"id":"J-ULVY6UNa9y"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_cols"],"metadata":{"id":"2zopQfHsPpHS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["label_mapping = {label: index for index, label in enumerate(df_cols)}\n","train_ft1['사고유형 - 세부분류_sorted'] = train_ft1['사고유형 - 세부분류'].map(label_mapping)"],"metadata":{"id":"e0gtbiUePe-V"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for col in train_ft1[['사고유형 - 세부분류_sorted', '사고유형 - 세부분류']]:\n","    sns.scatterplot(x=train_ft1[col], y=train_ft1['ECLO'])\n","    break"],"metadata":{"id":"8f6QTCCBPjWZ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["- 법규위반"],"metadata":{"id":"RcM4bDIiSK9e"}},{"cell_type":"code","source":["train_ft1.columns"],"metadata":{"id":"orKt_JbtP4nG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df = train_ft1.groupby(['법규위반'])[['ECLO']].mean().reset_index()\n","df0 = train_ft1.groupby(['법규위반'])[['ECLO']].count().reset_index().iloc[:,1:]\n","df1 = train_ft1.groupby(['법규위반'])[['ECLO']].sum().reset_index().iloc[:,1:]\n","df2 = train_ft1.groupby(['법규위반'])[['ECLO']].min().reset_index().iloc[:,1:]\n","df3 = train_ft1.groupby(['법규위반'])[['ECLO']].max().reset_index().iloc[:,1:]\n","df4 = train_ft1.groupby(['법규위반'])[['ECLO']].median().reset_index().iloc[:,1:]\n","df5 = train_ft1.groupby(['법규위반'])[['ECLO']].std().reset_index().iloc[:,1:]\n","\n","\n","df_acc = pd.concat([df, df4,df0, df1, df2, df3, df5], axis=1)\n","df_acc.columns = ['법규위반','median','mean','count','sum','min','max','std']\n","df_acc['max_mean'] = df_acc['max'] * df_acc['mean']\n","df_acc['max_median'] = df_acc['max'] * df_acc['median']\n","df_acc['max_std'] = df_acc['max'] * df_acc['std']\n","df_acc['mean_median'] = df_acc['mean'] * df_acc['median']\n","df_acc['max_count'] = df_acc['max'] * (df_acc['count'])\n","df_acc['max_count_medianmean'] = df_acc['max'] * df_acc['count'] * (df_acc['mean'] + df_acc['median'])/2\n","df_acc['max_count_log'] = df_acc['max'] * np.log(df_acc['count'])\n","df_acc['max_count_log_mean'] = df_acc['max'] * np.log(df_acc['count']) *np.log(df_acc['mean'])\n","df_acc['count_log_median'] = np.log(df_acc['count']) * df_acc['median']\n","df_acc['max_count_log_median'] = df_acc['max'] * np.log(df_acc['count']) *df_acc['median']\n","\n","\n","# max count_log의 조합을 기준으로 정렬해서 라벨 인코딩 (비슷한 범주가 라벨링된다는 가정하에 범주를 평균할 수 있으므로)\n","df_acc = df_acc.sort_values(by='max_count_log', ascending=False)\n","# display(df_acc)\n","\n","df_cols = df_acc['법규위반'].tolist()"],"metadata":{"id":"We784berP2S-"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_cols"],"metadata":{"id":"kbwhyQGZP2S_"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["label_mapping = {label: index for index, label in enumerate(df_cols)}\n","train_ft1['법규위반_sorted'] = train_ft1['법규위반'].map(label_mapping)"],"metadata":{"id":"hBfR6FRIP2S_"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for col in train_ft1[['법규위반_sorted', '법규위반']]:\n","    sns.scatterplot(x=train_ft1[col], y=train_ft1['ECLO'])\n","    break"],"metadata":{"id":"dtzGvm68P2TA"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["- 가해운전자 차종"],"metadata":{"id":"ansEdRsZn-jw"}},{"cell_type":"code","source":["df = train_ft1.groupby(['가해운전자 차종'])[['ECLO']].mean().reset_index()\n","df0 = train_ft1.groupby(['가해운전자 차종'])[['ECLO']].count().reset_index().iloc[:,1:]\n","df1 = train_ft1.groupby(['가해운전자 차종'])[['ECLO']].sum().reset_index().iloc[:,1:]\n","df2 = train_ft1.groupby(['가해운전자 차종'])[['ECLO']].min().reset_index().iloc[:,1:]\n","df3 = train_ft1.groupby(['가해운전자 차종'])[['ECLO']].max().reset_index().iloc[:,1:]\n","df4 = train_ft1.groupby(['가해운전자 차종'])[['ECLO']].median().reset_index().iloc[:,1:]\n","df5 = train_ft1.groupby(['가해운전자 차종'])[['ECLO']].std().reset_index().iloc[:,1:]\n","\n","\n","df_acc = pd.concat([df, df4,df0, df1, df2, df3, df5], axis=1)\n","df_acc.columns = ['가해운전자 차종','median','mean','count','sum','min','max','std']\n","df_acc['max_mean'] = df_acc['max'] * df_acc['mean']\n","df_acc['max_median'] = df_acc['max'] * df_acc['median']\n","df_acc['max_std'] = df_acc['max'] * df_acc['std']\n","df_acc['mean_median'] = df_acc['mean'] * df_acc['median']\n","df_acc['max_count'] = df_acc['max'] * (df_acc['count'])\n","df_acc['max_count_medianmean'] = df_acc['max'] * df_acc['count'] * (df_acc['mean'] + df_acc['median'])/2\n","df_acc['max_count_log'] = df_acc['max'] * np.log(df_acc['count'])\n","df_acc['max_count_log_mean'] = df_acc['max'] * np.log(df_acc['count']) *np.log(df_acc['mean'])\n","df_acc['count_log_median'] = np.log(df_acc['count']) * df_acc['median']\n","df_acc['max_count_log_median'] = df_acc['max'] * np.log(df_acc['count']) *df_acc['median']\n","\n","\n","# max count_log의 조합을 기준으로 정렬해서 라벨 인코딩 (비슷한 범주가 라벨링된다는 가정하에 범주를 평균할 수 있으므로)\n","df_acc = df_acc.sort_values(by='max_count_log', ascending=False)\n","# display(df_acc)\n","\n","df_cols = df_acc['가해운전자 차종'].tolist()"],"metadata":{"id":"_u6xuQpPn8HW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_cols"],"metadata":{"id":"CzoSn7HOn8Hm"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["label_mapping = {label: index for index, label in enumerate(df_cols)}\n","train_ft1['가해운전자 차종_sorted'] = train_ft1['가해운전자 차종'].map(label_mapping)"],"metadata":{"id":"oC8mtfv9n8Hm"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for col in train_ft1[['가해운전자 차종_sorted', '가해운전자 차종']]:\n","    sns.scatterplot(x=train_ft1[col], y=train_ft1['ECLO'])\n","    break"],"metadata":{"id":"BkQGPB5Dn8Hm"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["- 피해운전자 차종"],"metadata":{"id":"JoUiH4SfoPVU"}},{"cell_type":"code","source":["df = train_ft1.groupby(['피해운전자 차종'])[['ECLO']].mean().reset_index()\n","df0 = train_ft1.groupby(['피해운전자 차종'])[['ECLO']].count().reset_index().iloc[:,1:]\n","df1 = train_ft1.groupby(['피해운전자 차종'])[['ECLO']].sum().reset_index().iloc[:,1:]\n","df2 = train_ft1.groupby(['피해운전자 차종'])[['ECLO']].min().reset_index().iloc[:,1:]\n","df3 = train_ft1.groupby(['피해운전자 차종'])[['ECLO']].max().reset_index().iloc[:,1:]\n","df4 = train_ft1.groupby(['피해운전자 차종'])[['ECLO']].median().reset_index().iloc[:,1:]\n","df5 = train_ft1.groupby(['피해운전자 차종'])[['ECLO']].std().reset_index().iloc[:,1:]\n","\n","\n","df_acc = pd.concat([df, df4,df0, df1, df2, df3, df5], axis=1)\n","df_acc.columns = ['가해운전자 차종','median','mean','count','sum','min','max','std']\n","df_acc['max_mean'] = df_acc['max'] * df_acc['mean']\n","df_acc['max_median'] = df_acc['max'] * df_acc['median']\n","df_acc['max_std'] = df_acc['max'] * df_acc['std']\n","df_acc['mean_median'] = df_acc['mean'] * df_acc['median']\n","df_acc['max_count'] = df_acc['max'] * (df_acc['count'])\n","df_acc['max_count_medianmean'] = df_acc['max'] * df_acc['count'] * (df_acc['mean'] + df_acc['median'])/2\n","df_acc['max_count_log'] = df_acc['max'] * np.log(df_acc['count'])\n","df_acc['max_count_log_mean'] = df_acc['max'] * np.log(df_acc['count']) *np.log(df_acc['mean'])\n","df_acc['count_log_median'] = np.log(df_acc['count']) * df_acc['median']\n","df_acc['max_count_log_median'] = df_acc['max'] * np.log(df_acc['count']) *df_acc['median']\n","\n","\n","# max count_log의 조합을 기준으로 정렬해서 라벨 인코딩 (비슷한 범주가 라벨링된다는 가정하에 범주를 평균할 수 있으므로)\n","df_acc = df_acc.sort_values(by='max_count_log', ascending=False)\n","# display(df_acc)\n","\n","df_cols = df_acc['가해운전자 차종'].tolist()"],"metadata":{"id":"TIygAqyaoSUZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_cols"],"metadata":{"id":"qkfTL7FOoSUr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["label_mapping = {label: index for index, label in enumerate(df_cols)}\n","train_ft1['피해운전자 차종_sorted'] = train_ft1['피해운전자 차종'].map(label_mapping)"],"metadata":{"id":"gQmF09QUoSUs"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for col in train_ft1[['피해운전자 차종_sorted', '피해운전자 차종']]:\n","    sns.scatterplot(x=train_ft1[col], y=train_ft1['ECLO'])\n","    break"],"metadata":{"id":"RbE06f5joSUs"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["- 연령"],"metadata":{"id":"FNkAmbBhojf1"}},{"cell_type":"code","source":["import re\n","\n","train_ft1['가해운전자 연령'] = train_ft1['가해운전자 연령'].apply(lambda x: re.sub(r'\\D', '', str(x)))\n","train_ft1['가해운전자 연령_sorted'] = pd.to_numeric(train_ft1['가해운전자 연령'], errors='coerce')\n","\n","train_ft1['피해운전자 연령'] = train_ft1['피해운전자 연령'].apply(lambda x: re.sub(r'\\D', '', str(x)))\n","train_ft1['피해운전자 연령_sorted'] = pd.to_numeric(train_ft1['피해운전자 연령'], errors='coerce')\n"],"metadata":{"id":"eyAjLVy3ohjv"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["- 성별"],"metadata":{"id":"YRgAvNxdpDy8"}},{"cell_type":"code","source":["gender_mapping = {'남': 0, '기타불명': 1, '여': 2}\n","\n","train_ft1['가해운전자 성별_sorted'] = train_ft1['가해운전자 성별'].map(gender_mapping)\n","train_ft1['피해운전자 성별_sorted'] = train_ft1['피해운전자 성별'].map(gender_mapping)\n","\n","train_ft1['가해운전자 성별_sorted'] = pd.to_numeric(train_ft1['가해운전자 성별_sorted'], errors='coerce')\n","train_ft1['피해운전자 성별_sorted'] = pd.to_numeric(train_ft1['피해운전자 성별_sorted'], errors='coerce')"],"metadata":{"id":"vjg17Iq6pF5X"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["feature_1 = ['사고유형 - 세부분류_sorted', '법규위반_sorted',\n","             '가해운전자 차종_sorted', '피해운전자 차종_sorted',\n","             '가해운전자 연령_sorted', '피해운전자 연령_sorted',\n","             '가해운전자 성별_sorted', '피해운전자 성별_sorted']"],"metadata":{"id":"V4fV7v-QqCGz"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["- 시간대"],"metadata":{"id":"_Dy3QiFcsrmY"}},{"cell_type":"code","source":["def categorize_time_period(hour):\n","    if 6 <= hour < 9:  # 아침 출퇴근 시간\n","        return 0\n","    elif 9 <= hour < 12:  # 아침\n","        return 1\n","    elif 12 <= hour < 14:  # 점심\n","        return 2\n","    elif 14 <= hour < 18:  # 오후\n","        return 3\n","    elif 18 <= hour < 21:  # 저녁\n","        return 4\n","    elif 21 <= hour < 24:  # 밤\n","        return 5\n","    else:  # 새벽\n","        return 6\n","\n","train_ft1['시간대'] = train_ft1['시간'].apply(categorize_time_period)\n","\n","train_df['시간대'] = train_df['시간'].apply(categorize_time_period)\n","test_df['시간대'] = test_df['시간'].apply(categorize_time_period)"],"metadata":{"id":"XLS2HJBQsrAr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["abs(train_ft1.corr()['ECLO']).sort_values(ascending=False)"],"metadata":{"id":"jnI4C9-WqhUX"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["feature1_merge_df = train_ft1.groupby(['구','요일','시간대','사고유형','기상상태','도로형태2'])[feature_1].mean().reset_index()\n","feature1_merge_df"],"metadata":{"id":"NXKxWLA6q5_I"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_df = pd.merge(train_df,feature1_merge_df, on = ['구','요일','시간대','사고유형','기상상태','도로형태2'], how='left' )\n","test_df = pd.merge(test_df,feature1_merge_df, on = ['구','요일','시간대','사고유형','기상상태','도로형태2'], how='left' )"],"metadata":{"id":"tQrkP_qxuqVr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_df.columns"],"metadata":{"id":"DFTPR24rvl2Q"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from tqdm import tqdm\n","\n","for col in tqdm(train_df.columns[-7:]) :\n","    plt.figure(figsize= (4,3))\n","    sns.scatterplot(x=train_df[col], y=train_df.ECLO)\n","    plt.title(f'{col}별 ECLO')\n","    plt.xticks(rotation=45)\n","    plt.show()"],"metadata":{"id":"kLxV7-TovgQL"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Feature2 전국 데이터"],"metadata":{"id":"0mWO9spmJ19Q"}},{"cell_type":"markdown","source":["# Feature 3 : cctv/ 주차장/ 보호구역 등"],"metadata":{"id":"CwR3mc2BNXQQ"}},{"cell_type":"code","source":["df = train_df[['도시','구','동']]\n","\n","df1 = pd.get_dummies(train_df['요일'], prefix = '요일')\n","df2 = pd.get_dummies(train_df['연'], prefix = '연')\n","df3 = pd.get_dummies(train_df['월'], prefix = '월')\n","# df4 = pd.get_dummies(train_df['일'], prefix = '일')\n","# df5 = pd.get_dummies(train_df['시간'], prefix = '시간')\n","\n","\n","df6 = pd.get_dummies(train_df['기상상태'], prefix = '기상상태')\n","df7 = pd.get_dummies(train_df['노면상태'], prefix = '노면상태')\n","df8 = pd.get_dummies(train_df['도로형태1'], prefix = '도로형태1')\n","df9 = pd.get_dummies(train_df['도로형태2'], prefix = '도로형태2')\n","df10 = pd.get_dummies(train_df['사고유형'], prefix = '사고유형')\n","\n","train_time_merge= pd.concat([df, df1, df2, df3, df6,df7,df8, df9, df10], axis=1) #23개 열"],"metadata":{"id":"eJ702OtUuDXj"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_time_merge_df = train_time_merge.groupby(['도시','구','동']).sum().reset_index()\n","\n","train_df = train_df.merge(train_time_merge_df, on = ['도시','구','동'], how='left')\n","test_df = test_df.merge(train_time_merge_df, on = ['도시','구','동'], how='left')"],"metadata":{"id":"gDtaIEhguUkP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_df['노면상태'].value_counts()"],"metadata":{"id":"ueBggOuuqLOT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test_df['노면상태'].value_counts()"],"metadata":{"id":"bwMXwZ7Uw1q6"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## 보안등"],"metadata":{"id":"j3Dbcs0LwG80"}},{"cell_type":"code","source":["location_pattern = r'(\\S+) (\\S+) (\\S+) (\\S+)'\n","\n","DG_seculight[['도시', '구', '동','번지']] = DG_seculight['소재지지번주소'].str.extract(location_pattern)\n","DG_seculight = DG_seculight.drop(columns=['소재지지번주소'])"],"metadata":{"id":"zJaF2A4UwIKV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df1 = DG_seculight.groupby(['도시','구','동'])[['설치개수']].sum().reset_index()\n","df1.columns = ['도시','구','동','보안등_설치개수']\n","\n","df2 = pd.get_dummies(DG_seculight['설치형태'], prefix='보안등')\n","df2 = pd.concat([DG_seculight[['도시','구','동']], df2], axis=1)\n","df2 = df2.groupby(['도시','구','동']).sum().reset_index().drop(columns =['도시','구','동'])\n","\n","seculight_merge = pd.concat([df1, df2], axis=1)\n","\n","train_df = pd.merge(train_df,seculight_merge, on = ['도시','구','동'], how='left')\n","test_df = pd.merge(test_df,seculight_merge, on = ['도시','구','동'], how='left')"],"metadata":{"id":"h57EF2JnwJY6"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## cctv"],"metadata":{"id":"Y2rvCjKWxsZG"}},{"cell_type":"code","source":["location_pattern = r'(\\S+) (\\S+) (\\S+) (\\S+)'\n","\n","DG_cctv[['도시', '구', '동','번지']] = DG_cctv['소재지지번주소'].str.extract(location_pattern)\n","DG_cctv = DG_cctv.drop(columns=['소재지지번주소'])"],"metadata":{"id":"-fUfchOMxq6w"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df = DG_cctv[['도시','구','동']]\n","df['cctv_설치개수'] = 1\n","\n","df1 = pd.get_dummies(DG_cctv['보호구역구분'], prefix = '보호구역구분')\n","df2 = pd.get_dummies(DG_cctv['단속구분'], prefix = '단속구분')\n","df3 = pd.get_dummies(DG_cctv['도로종류'], prefix = '도로종류')\n","df4 = pd.get_dummies(DG_cctv['제한속도'], prefix = '제한속도')\n","\n","cctv_merge= pd.concat([df, df1, df2, df3, df4], axis=1) #23개 열\n","\n","cctv_merge_df = cctv_merge.groupby(['도시','구','동']).sum().reset_index()\n","\n","train_df = train_df.merge(cctv_merge_df, on = ['도시','구','동'], how='left')\n","test_df = test_df.merge(cctv_merge_df, on = ['도시','구','동'], how='left')"],"metadata":{"id":"MFQCzrXbxv8R"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## 어린이 보호"],"metadata":{"id":"rmxPLHrqzA57"}},{"cell_type":"code","source":["location_pattern = r'(\\S+) (\\S+) (\\S+) (\\S+)'\n","\n","DG_children_area[['도시', '구', '동','번지']] = DG_children_area['소재지지번주소'].str.extract(location_pattern)\n","DG_children_area = DG_children_area.drop(columns=['소재지지번주소'])"],"metadata":{"id":"kULBhg-7zCBP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["location_pattern = r'(\\S+)~(\\S+)'\n","\n","DG_children_area[['보호구역도로폭_min', '보호구역도로폭_max']] = DG_children_area['보호구역도로폭'].str.extract(location_pattern)\n","DG_children_area = DG_children_area.drop(columns=['보호구역도로폭'])"],"metadata":{"id":"izKVvYdWzFo8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["DG_children_area['보호구역도로폭_min'] = DG_children_area['보호구역도로폭_min'].astype(float)\n","DG_children_area['보호구역도로폭_max'] = DG_children_area['보호구역도로폭_max'].astype(float)"],"metadata":{"id":"DdRZ7i9-23NG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# 범주형 - 동별 onehot 인코딩 합계로 cctv처리\n","\n","df = DG_children_area[['도시','구','동']]\n","\n","df1 = pd.get_dummies(DG_children_area['시설종류'], prefix = '시설종류')\n","\n","children_area_merge= pd.concat([df, df1], axis=1)\n","children_area_merge #23개 열\n","\n","children_area_merge_df = children_area_merge.groupby(['도시','구','동']).sum().reset_index()\n","\n","train_df = train_df.merge(children_area_merge_df, on = ['도시','구','동'], how='left')\n","test_df = test_df.merge(children_area_merge_df, on = ['도시','구','동'], how='left')"],"metadata":{"id":"wlcevKUrzLqA"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df2 = DG_children_area.groupby(['도시','구','동'])[['CCTV설치대수']].mean().reset_index()\n","df3 = DG_children_area.groupby(['도시','구','동'])[['보호구역도로폭_min']].max().reset_index()\n","df4 = DG_children_area.groupby(['도시','구','동'])[['보호구역도로폭_max']].max().reset_index()"],"metadata":{"id":"P1FGrHEt_Xew"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_df = train_df.merge(df2, on = ['도시','구','동'], how='left')\n","test_df = test_df.merge(df2, on = ['도시','구','동'], how='left')\n","\n","train_df = train_df.merge(df3, on = ['도시','구','동'], how='left')\n","test_df = test_df.merge(df3, on = ['도시','구','동'], how='left')\n","\n","train_df = train_df.merge(df4, on = ['도시','구','동'], how='left')\n","test_df = test_df.merge(df4, on = ['도시','구','동'], how='left')"],"metadata":{"id":"dKhLPl2s_jbY"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## 주차장"],"metadata":{"id":"5rkDwcYU6rOb"}},{"cell_type":"code","source":["location_pattern = r'(\\S+) (\\S+) (\\S+) (\\S+)'\n","\n","DG_parking[['도시', '구', '동','번지']] = DG_parking['소재지지번주소'].str.extract(location_pattern)\n","DG_parking = DG_parking.drop(columns=['소재지지번주소'])"],"metadata":{"id":"sW5tPtzv6xBo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df = DG_parking[['도시','구','동']]\n","\n","df1 = pd.get_dummies(DG_parking['주차장구분'], prefix = '주차장구분')\n","df2 = pd.get_dummies(DG_parking['주차장유형'], prefix = '주차장유형')\n","df3 = pd.get_dummies(DG_parking['급지구분'], prefix = '급지구분')\n","df4 = pd.get_dummies(DG_parking['부제시행구분'], prefix = '부제시행구분')\n","df5 = pd.get_dummies(DG_parking['운영요일'], prefix = '운영요일')\n","df6 = pd.get_dummies(DG_parking['요금정보'], prefix = '요금정보')\n","df7 = pd.get_dummies(DG_parking['결제방법'], prefix = '결제방법')\n","\n","\n","parking_merge= pd.concat([df, df1, df2, df3, df4, df5, df6, df7], axis=1)\n","\n","parking_merge_df = parking_merge.groupby(['도시','구','동']).sum().reset_index()\n","\n","train_df = train_df.merge(parking_merge_df, on = ['도시','구','동'], how='left')\n","test_df = test_df.merge(parking_merge_df, on = ['도시','구','동'], how='left')\n"],"metadata":{"id":"Iz2wyqK06z1D"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["parking_num_cols = ['도시','구','동','주차구획수', '평일운영시작시각', '평일운영종료시각', '토요일운영시작시각', '토요일운영종료시각',\n","       '공휴일운영시작시각', '공휴일운영종료시각','주차기본시간', '주차기본요금', '추가단위시간',\n","       '추가단위요금', '1일주차권요금적용시간', '1일주차권요금', '월정기권요금' ]\n","\n","df = DG_parking[parking_num_cols]\n","\n","from datetime import datetime\n","\n","def time_to_int(time_str):\n","#     time_str = time\n","    time_obj = datetime.strptime(time_str, \"%H:%M\")\n","    # 시간을 분 단위로 변환하고 24로 나누어 표현\n","    hours_decimal = (time_obj.hour * 60 + time_obj.minute) / 60.0\n","    return hours_decimal\n","\n","df['평일운영시작시각'] = df['평일운영시작시각'].apply(time_to_int)\n","df['평일운영종료시각'] = df['평일운영종료시각'].apply(time_to_int)\n","df['토요일운영시작시각'] = df['토요일운영시작시각'].apply(time_to_int)\n","df['토요일운영종료시각'] = df['토요일운영종료시각'].apply(time_to_int)\n","df['공휴일운영시작시각'] = df['공휴일운영시작시각'].apply(time_to_int)\n","df['공휴일운영종료시각'] = df['공휴일운영종료시각'].apply(time_to_int)\n","\n","parking_num_merge_df = df.groupby(['도시','구','동']).mean().reset_index()\n","\n","train_df = train_df.merge(parking_num_merge_df, on = ['도시','구','동'], how='left')\n","test_df = test_df.merge(parking_num_merge_df, on = ['도시','구','동'], how='left')\n"],"metadata":{"id":"4_NQt88H9XMt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# from tqdm import tqdm\n","\n","# for col in tqdm(train_df.columns[1:]) :\n","#     plt.figure(figsize= (4,3))\n","#     sns.scatterplot(x=train_df[col], y=train_df.ECLO)\n","#     plt.title(f'{col}별 ECLO')\n","#     plt.xticks(rotation=45)\n","#     plt.show()"],"metadata":{"id":"gXZsHctP666n"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["feature_2 = [\n"," 'ID',\n"," '요일',\n","\n"," '기상상태',\n"," '노면상태',\n"," '사고유형',\n","\n"," '연',\n"," '월',\n"," '시간',\n","\n"," '구',\n"," '동',\n"," '도로형태1',\n"," '도로형태2',\n","\n"," '기상상태_기타',\n"," '기상상태_눈',\n"," '기상상태_안개',\n"," '기상상태_흐림',\n","\n"," '노면상태_기타',\n"," '노면상태_서리/결빙',\n"," '노면상태_적설',\n"," '노면상태_침수',\n","\n"," '도로형태1_기타',\n"," '도로형태1_미분류',\n"," '도로형태1_주차장',\n","\n"," '도로형태2_고가도로위',\n"," '도로형태2_교량',\n"," '도로형태2_미분류',\n"," '도로형태2_주차장',\n"," '도로형태2_지하차도(도로)내',\n"," '도로형태2_터널',\n","\n"," '보안등_건축물',\n"," '보안등_전용주',\n"," '보안등_한전주',\n"," 'cctv_설치개수',\n","\n"," '보호구역구분_1.0',\n"," '보호구역구분_2.0',\n","\n"," '단속구분_1',\n"," '단속구분_4',\n"," '단속구분_99',\n","\n"," '도로종류_고속국도',\n"," '도로종류_구도',\n"," '도로종류_시도',\n"," '도로종류_일반국도',\n"," '도로종류_지방도',\n","\n"," '제한속도_0',\n"," '제한속도_30',\n"," '제한속도_40',\n"," '제한속도_60',\n"," '제한속도_70',\n"," '제한속도_80',\n"," '제한속도_100',\n","\n"," '시설종류_어린이집',\n"," '시설종류_초등학교',\n"," '시설종류_특수학교',\n"," '시설종류_학원',\n","\n"," 'CCTV설치대수',\n"," '보호구역도로폭_min',\n"," '보호구역도로폭_max',\n","\n"," '주차장구분_민영',\n"," '주차장유형_노외',\n","\n"," '급지구분_1',\n"," '급지구분_3',\n","\n"," '운영요일_평일',\n"," '운영요일_평일+토요일',\n","\n"," '요금정보_무료',\n"," '요금정보_유료',\n"," '요금정보_혼합',\n","\n"," '결제방법_무료',\n"," '결제방법_신용카드',\n"," '결제방법_카드',\n"," '결제방법_현금',\n"," '결제방법_현금,카드',\n","\n"," '주차구획수',\n"," '공휴일운영시작시각',\n"," '주차기본시간',\n"," '주차기본요금',\n","\n","]"],"metadata":{"id":"OtUlN99FFHiU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test_df[feature_2]"],"metadata":{"id":"AO6idMjYFlrK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_df.shape, test_df.shape"],"metadata":{"id":"UEVlvzQBhHFp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# test_x = test_df[feature_2+feature_1].drop(columns=['ID']).copy()\n","test_x = test_df[feature_1].copy()\n","\n","train_x = train_df[test_x.columns].copy()\n","\n","train_y = train_df['ECLO'].copy()\n","\n","test_x.shape, train_x.shape, train_y.shape"],"metadata":{"id":"AuG6NEt6hf38"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"et6lxsdkPgFD"},"source":["# Encoding"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yKzb4McaPpq-"},"outputs":[],"source":["train_df.info()"]},{"cell_type":"code","source":["train_x.info()"],"metadata":{"id":"s3D-KTmNhvFL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.preprocessing import LabelEncoder\n","# from category_encoders.target_encoder import TargetEncoder\n","\n","categorical_features = list(train_x.dtypes[train_x.dtypes == \"object\"].index)\n","# 추출된 문자열 변수 확인\n","display(categorical_features)"],"metadata":{"id":"mQQiM1dQhQw_"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pqvcio7KLZRW"},"outputs":[],"source":["for col in categorical_features:\n","    enc = LabelEncoder()\n","    train_x[col]=enc.fit_transform(train_x[col])\n","    test_x[col]=enc.transform(test_x[col])\n","\n","train_x.head()"]},{"cell_type":"code","source":["train_x = train_x.fillna(0)\n","test_x = test_x.fillna(0)"],"metadata":{"id":"VkH2DFnMiKzn"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"VtQtVNtIP90Q"},"source":["# 학습 및 검증"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6atkV1OjF9iT"},"outputs":[],"source":["target = np.log1p(train_y)\n","target"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bzOKOa0EF9iT"},"outputs":[],"source":["def rmsle(y_valid, pred):\n","    msle = mean_squared_log_error(y_valid, pred)\n","    return np.sqrt(msle)\n","\n","rmsle_score = make_scorer(rmsle, greater_is_better=False)"]},{"cell_type":"markdown","source":["# Pycaret"],"metadata":{"id":"dRra7oKkQSpk"}},{"cell_type":"code","source":["# !pip install pycaret"],"metadata":{"id":"an3OsjkIXxZV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# # check installed version (must be >3.0)\n","# import pycaret\n","# pycaret.__version__"],"metadata":{"id":"yZOgNjQLYmkT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# data = pd.concat([train_x,target],axis=1)\n","# data"],"metadata":{"id":"hv7JtIvZZBTs"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# !pip install --upgrade scipy\n","# !pip install --upgrade pycaret\n"],"metadata":{"id":"bninuJJJZ1_B"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# from pycaret.regression import *"],"metadata":{"id":"1LraCYAWZtox"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# s = setup(data, target = 'ECLO')"],"metadata":{"id":"XehUSlmPYsKR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["best = compare_models()\n","\n","#gbr, lr, ridge, br, lgbm, huber / ->"],"metadata":{"id":"q4Lzuct-aL4x"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Stacking regressor"],"metadata":{"id":"pTfceQfdPw3A"}},{"cell_type":"code","source":["cv = KFold(n_splits=5, shuffle=True, random_state=SEED)\n","scores = cross_val_score(model, train_x, target, cv=cv, scoring=rmsle_score, n_jobs=-1)"],"metadata":{"id":"UqgJFLkoeri6"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.ensemble import StackingRegressor\n","\n","estimators = [\n","    (\"rf\", RandomForestRegressor(random_state=SEED)),\n","    (\"lgbm\",LGBMRegressor(random_state=SEED)),\n","    (\"xgboost\",XGBRegressor(random_state=SEED)),\n","    (\"cat\",CatBoostRegressor(random_state=SEED,iterations=200, verbose = 0))\n","]\n","\n","params = {\n","    \"estimators\" : estimators,\n","#     \"final_estimator\" : LinearRegression(**best_params),\n","    \"final_estimator\" : LinearRegression(),\n","    \"cv\" : cv,\n","    \"n_jobs\":-1\n","}\n","\n","model_ensemble= StackingRegressor(**params)\n","\n","model_ensemble.fit(X_train, y_train)\n","X_pred = model_ensemble.predict(X_valid)\n","X_rmse = np.sqrt(mean_squared_error(y_valid, X_pred))\n","rmse_scores.append(X_rmse)\n","\n","pred = model_ensemble.predict(X_valid)"],"metadata":{"id":"RjmP0OcndBRV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"d-amVWUIPr8o"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## DL"],"metadata":{"id":"z2agDFl0ibk0"}},{"cell_type":"code","source":["import tensorflow as tf\n","\n","def rmsle(y_true, y_pred):\n","    y_true = tf.cast(y_true, tf.float32)\n","    y_pred = tf.cast(y_pred, tf.float32)\n","\n","    squared_error = tf.square(tf.math.log1p(y_pred) - tf.math.log1p(y_true))\n","\n","    return tf.sqrt(tf.reduce_mean(squared_error))\n","\n","def loss_fn(y_true, y_pred):\n","    return rmsle(y_true, y_pred)\n","\n","def metric_fn(y_true, y_pred):\n","    return rmsle(y_true, y_pred)"],"metadata":{"id":"G3Zvg-yuilXG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["callbacks_list = [\n","    tf.keras.callbacks.EarlyStopping(monitor='val_loss', patience=30, verbose=2, mode='min',restore_best_weights=True),\n","    tf.keras.callbacks.ReduceLROnPlateau(monitor='val_loss', factor=0.8, patience=3, min_lr=0.00001),\n","    tf.keras.callbacks.TerminateOnNaN()\n","]\n","\n","# print(train_x.shape, train_y.shape)\n","# print(train_x.isnull().sum().sum(), train_y.isnull().sum().sum())"],"metadata":{"id":"sxsHNp_jipJx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["np.random.seed(SEED)\n","tf.random.set_seed(SEED)"],"metadata":{"id":"d4hHLVGFiqqT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def create_model():\n","\n","    input_layer = tf.keras.Input(shape=(len(train_x.columns), ))\n","    x = tf.keras.layers.BatchNormalization(epsilon=0.00001)(input_layer)\n","    x = tf.keras.layers.Dense(16, activation='relu')(x)\n","    #x = tf.keras.layers.BatchNormalization(epsilon=0.00001)(x)\n","    x = tf.keras.layers.Dense(32, activation='relu')(x)\n","    #x = tf.keras.layers.BatchNormalization(epsilon=0.00001)(x)\n","    output_layer = tf.keras.layers.Dense(1)(x)\n","\n","    model = tf.keras.Model(inputs=input_layer, outputs=output_layer)\n","\n","    model.compile(optimizer=tf.keras.optimizers.Adam(0.001),\n","                  loss=loss_fn,\n","                  metrics=[metric_fn]\n","                  )\n","\n","    return model"],"metadata":{"id":"p59r9r2CitxQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model = create_model()\n","history = model.fit(train_x.astype('float32'),target.astype('float32'),\n","                    epochs=100,\n","                    callbacks=callbacks_list,\n","                    validation_split=0.1)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"b9AfmKX2iv8f","outputId":"5ceef5b6-6a8e-4c79-f8fe-30e7884cef8e","executionInfo":{"status":"ok","timestamp":1701117902713,"user_tz":-540,"elapsed":1406,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/100\n","Batch 0: Invalid loss, terminating training\n","1114/1114 [==============================] - 1s 334us/step - loss: nan - metric_fn: nan - val_loss: nan - val_metric_fn: nan - lr: 0.0010\n"]}]},{"cell_type":"code","source":["import matplotlib.pyplot as plt\n","\n","plt.plot(history.history['loss'], 'b-', label='loss')\n","plt.plot(history.history['val_loss'], 'r--', label='val_loss')\n","plt.xlabel('Epoch')\n","plt.legend()\n","plt.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":447},"id":"qeHMN8KilMHa","outputId":"ee1564ba-dd60-411e-d589-8ffaa1285519","executionInfo":{"status":"ok","timestamp":1701117903228,"user_tz":-540,"elapsed":528,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAjAAAAGuCAYAAACOdTzBAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/bCgiHAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAnCklEQVR4nO3dbXBU133H8d+uxK4ksOS2FARe2ThhwEUSkrCIHuwCYzqM1YkjA7HCGJkJrZGRPUJj0ZYhtpWxQsC49fRFQ8SDZ5jBwR0zlRM8HQImuKCgdOLB1iIUbDkGeVijFJHqYfUsob19QdiyaCWQdvVwpO9nZl/s2XPv/d+zy+rHvefetVmWZQkAAMAg9vEuAAAAYLgIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxokc7wJGg8/nU0NDg+677z7ZbLbxLgcAANwDy7LU1tamuXPnym4f+hjLpAwwDQ0NSkhIGO8yAADACHg8HrlcriH7TMoAc99990m6OQCxsbHjXA0AALgXXq9XCQkJ/r/jQ5mUAebWaaPY2FgCDAAAhrmX6R9M4gUAAMYhwAAAAOMQYAAAgHEm5RwYAAAG09/fr76+vvEuY8pyOBx3vUT6XhBgAABTgmVZ+p//+R+1tLSMdylTmt1u18MPPyyHwxHSeggwAIAp4VZ4mTVrlmJiYrjR6Ti4daPZP/zhD3rwwQdDeg8IMACASa+/v98fXv7iL/5ivMuZ0v7yL/9SDQ0NunHjhqZNmzbi9TCJFwAw6d2a8xITEzPOleDWqaP+/v6Q1kOAAQBMGZw2Gn/heg8IMAAAwDgEGAAAYBwCDAAAE9iqVatUWVk53mVMOAQYAAAmsN7eXvX29o53GRMOl1EDAKYky5I6O8dn2zExEvOJQ0OAAQBMSZ2d0owZ47Pt9nZp+vThL/fhhx/qBz/4gdra2tTf369169bp9ddfV0REhCRp69at+uUvf6no6Gg99NBDev/999Xb26u///u/V3V1tZxOpzIzM7Vnz54w79HYI8AAAGCAmpoabdy4UR988IEeffRRdXZ2Kj8/X6+99pp27typ//qv/9KXX36p2tpa2e12WZYlSTp8+LDuv/9+1dbWSpK/3XQEGADAlBQTc/NIyHhte7j+5V/+Rf/wD/+gRx999E/riFF5ebkeeeQRvfrqq/L5fOrv7/cHlFv3W/H5fLpx44Z/PZPlXjhM4gUATEk2283TOOPxGEmGuHDhgh5//PGAttmzZ2vu3Ln68ssv9cQTT2jhwoVKS0vTu+++K5/PJ0lav369Ojo6lJmZqWPHjoVj6CYEAgwAAAa4Nc/lTpZlKSIiQjabTW+99ZZ+8Ytf6L333tPq1atlWZaioqJ06NAh7du3Tz/+8Y9VVFQ0xpWPDgIMAAAGWLJkiX79618HtF27dk2NjY2aP3++v+0b3/iGfv7zn+vzzz/XJ5984m9PSUnRyZMndejQIV2/fn3M6h4tBBgAAAxQXFyst956S+fOnZMkdXZ26oUXXtCLL74op9Mpr9fr/4HEhoYGNTc3Kz4+Xi0tLf55MZcuXZLdbtf9998/XrsRNkziBQBgAnM4HHI4HEpMTNThw4f10ksvqaWlRT6fTxs2bNArr7wiSfrggw/0gx/8QLGxsbLZbPrXf/1XuVwuvfHGGyovL1dsbKwcDofee+89TZs2bZz3KnQ2a7JcT3Ubr9eruLg4tba2KjY2drzLAQCMs+7ubtXX1+vhhx9WVFTUeJczpQ31Xgzn7zenkAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACYZN5991393d/9Xdj7TiQEGAAAJpne3l719vaGve9Ewm8hAQCmto6OwV+LiJBuv939UH3tdik6+u59p08fXn0IiiMwAICpbcaMwR9r1wb2nTVr8L45OYF9580L3m8YiouLtXfv3oC2f/zHf9SePXv01ltvKSkpSYsXL1ZiYqLKy8tHsPMDXbt2Tc8++6wefvhhzZ8/X0899ZQuXbrkf/3DDz/UkiVLlJaWpvT0dNXU1EiSfvaznyk5OVlpaWlaunSpGhsbw1LPYDgCAwDABJWbm6tdu3Zp8+bN/rb3339flZWV+uyzz/TJJ5/I6XTqj3/8o1JSUrRy5UotWLAgpG1+5zvf0VNPPaXDhw/LZrPp3Xff1apVq3Tx4kU5nU4VFRXpo48+0gMPPCBJsixL3d3deu2113T+/HnFxsbKsizZbLaQ6rgbAgwAYGprbx/8tYiIwOdDHVWw33FS46uvRlzSLcuXL1d+fr5aW1sVFxcnt9utOXPm6IEHHvAHCEmaOXOmsrOz5Xa7QwowH330kbq7u/Xqq6/625599lm99957+vd//3d9//vfl2VZ6uvr879us9nk8/lks9nU39/vbxttnEICAExt06cP/rh9/svd+t4+/2WovsMQERGhv/3bv9Uvf/lLSdIvfvELPfPMM5Kkjz/+WOvXr1dqaqoSExN16tQpdXZ2jngYJOnChQt6/PHHB7Q//vjj/lNFP/nJT/Tkk0/qn/7pn3T9+nVJUkxMjMrKypSRkaGdO3eqra0tpDruBQEGAIAJbO3atfrggw8kSUePHtV3v/tdXbx4Ud/+9rf11FNPqbKyUr/73e+0cuXKkLcVcecRpz+xLMv/2qpVq+R2uxUfH6/U1FTV1dVJkvLz83Xu3Dm1t7dryZIloz4HhgADAMAEtnLlSv33f/+3fv/732vGjBl64IEHdOzYMX3ve9/TunXrFBsbK0m6ePFiyNtasmSJzp49O6C9qqpKaWlp/udRUVEqKSlRYWGh/u3f/s3fHhsbq507d2r58uU6dOhQyPUMhQADAMAE5nA49Nhjj6mkpMR/+mjOnDn63e9+pxs3bki6eVrn2rVrIW8rOztbM2bMUFlZmSzLkiS98847+uyzz/TMM8/Isiy1tLRIkvr7+3Xx4kU98MAD6u3tVcefLhvv6enR73//+4A5OqOBSbwAAExw69at03e/+13/JdXf+9739PHHHys1NVWS9Dd/8zcqLCz0T6J1OBxyOBz3tO47+37wwQcqKSnRN7/5Tdntdi1evFgnT57UtGnT1NraqqVLl/pPJz322GN6+eWXVV9fryeffFJRUVGyLEu5ublat25dGEdgIJt1K2JNIl6vV3FxcWptbfUfWgMATF3d3d2qr6/Xww8/rKg7J+ZiTA31Xgzn73fYTiEdOHBAycnJSklJUU5Ojq5evTpo37a2NuXn5yspKUmJiYkBh6ru9Pnnn8vpdOr1118PV6kAAEwJf/zjH5WWlqbU1NSgj9/85jfjXeKIheUU0okTJ7R//36dPXtWcXFxOnLkiNasWaPf/va3QfsXFBQoOTlZP/vZz9Tb26u8vDyVl5frxRdfHNC3uLhYTzzxRMA15wAA4O5mzpyp6urq8S5jVITlCMy+fftUVlamuLg4SVJeXp4iIiLkdrsH9G1qalJVVZW2bdsm6ea5tzfffFP79+8f0LeiokKzZ89WRkZGOMoEAExxk3DWhHHC9R6EJcCcOnVKy5YtC2hbvny5Tp48OaDv6dOnlZmZGXCt+YIFC9TY2BhwzXhnZ6dKS0v1xhtvhKNEAMAUNm3aNEkK+UZvCN2tX74e7J4z9yrkU0jt7e2KjIzU9DvuLpiQkKALFy4M6N/Q0KCEhIQB7S6XS/X19Zo1a5YkaefOnVq/fr3mzp171xp6enrU09Pjf+71eoe7GwCASSwiIkL333+//z/KMTExY3K7ewTy+Xy6fv26YmJiFBkZWgQJOcC0tLQEndEdFRUVNOneS/9Lly6poqLins/b7dq1i0m+AIAhxcfHS9Ko3yEWQ7Pb7XrwwQdDDpAhBxin06nu7u4B7V1dXYq+83ch/tS/ubl5yP7FxcXasWPHPV/qtn37dpWUlPife73eoEd5AABTl81m05w5czRr1iwuDBlHDodD9jt/+HIEQg4wM2fOVFdXl9rb2zVjxgx/u8fjkcvlGtDf5XLp448/HtB+q//x48fV2dmptWvX3nMNTqdTTqdzZDsAAJhSIiIiQp5/gfEXcgSy2WzKyMhQZWVlQPuZM2eUnZ09oH9WVpaqqqr8dwuUpLq6OjkcDv88mK+//jrgOvW9e/fq7bffVnp6OhOwAABAeK5C2rJli0pLS/2TZ48cOaKOjg6tWLFiQN958+Zp6dKl2r17tySpr69P27ZtU1FRkSSpsLBQX3zxhdxut/+xefNmPf/88zp37pxiYmLCUTIAADBYWG5kt3r1ank8HmVlZclutys+Pl5Hjx6V3W5XX1+f/0Z1tyZQHTx4UIWFhUpMTJTP51Nubq62bt066PqnTZvGbHEAAODHbyEBAIAJYVx+CwkAAGCsEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcQgwAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcQgwAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYJW4A5cOCAkpOTlZKSopycHF29enXQvm1tbcrPz1dSUpISExNVVlYmy7L8rx87dkwrV67U4sWLlZSUpM2bN6uzszNcpQIAAMOFJcCcOHFC+/fv19mzZ3X+/Hlt3LhRa9asGbR/QUGBFi1apNraWlVXV+vTTz9VeXm5//UZM2bo0KFDqqmpkdvtVltbm0pLS8NRKgAAmARs1u2HPkZozZo12rRpk3Jycvxt2dnZ+ulPf6rU1NSAvk1NTUpNTVV9fb0iIiIkSV988YXy8vLkdruDrt/tdmvDhg2qqam5p3q8Xq/i4uLU2tqq2NjYEe0TAAAYW8P5+x2WIzCnTp3SsmXLAtqWL1+ukydPDuh7+vRpZWZm+sOLJC1YsECNjY1qbGwMuv6mpiZFRUUNuv2enh55vd6ABwAAmLxCDjDt7e2KjIzU9OnTA9oTEhJ0+fLlAf0bGhqUkJAwoN3lcqm+vj7oNvbu3asNGzYMWsOuXbsUFxfnfwRbPwAAmDxCDjAtLS1Bj45ERUUFnXg73P4nTpyQ2+3Wpk2bBq1h+/btam1t9T88Hs8w9wIAAJgkMtQVOJ1OdXd3D2jv6upSdHR00P7Nzc331N/j8aigoEAVFRVyOp1D1jDU6wAAYHIJ+QjMzJkz1dXVpfb29oB2j8cjl8s1oL/L5dKVK1cGtN/Zv6OjQ08//bR27Nih9PT0UMsEAACTSMgBxmazKSMjQ5WVlQHtZ86cUXZ29oD+WVlZqqqqUn9/v7+trq5ODofDH2D6+/u1bt065eTk6Lnnngu1RAAAMMmE5SqkLVu2qLS01H/1z5EjR9TR0aEVK1YM6Dtv3jwtXbpUu3fvliT19fVp27ZtKioq8vcpLi5WdHS0fvSjH4WjPAAAMMmEPAdGklavXi2Px6OsrCzZ7XbFx8fr6NGjstvt6uvrU15ensrLyxUfHy9JOnjwoAoLC5WYmCifz6fc3Fxt3bpVktTc3Kw9e/Zo4cKFSktL82/DZrPp+PHjmj17djhKBgAABgvLjewmGm5kBwCAecb8RnYAAABjiQADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcQgwAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcQgwAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGCcsAWYAwcOKDk5WSkpKcrJydHVq1cH7dvW1qb8/HwlJSUpMTFRZWVlsixrxOsDAABTS1gCzIkTJ7R//36dPXtW58+f18aNG7VmzZpB+xcUFGjRokWqra1VdXW1Pv30U5WXl494fQAAYGoJS4DZt2+fysrKFBcXJ0nKy8tTRESE3G73gL5NTU2qqqrStm3bJEkOh0Nvvvmm9u/fP6L1AQCAqScsAebUqVNatmxZQNvy5ct18uTJAX1Pnz6tzMxMRURE+NsWLFigxsZGNTY2Dnt9ktTT0yOv1xvwAAAAk1fIAaa9vV2RkZGaPn16QHtCQoIuX748oH9DQ4MSEhIGtLtcLtXX1w97fZK0a9cuxcXF+R/B1g8AACaPkANMS0uLoqKiBrRHRUWps7Nz2P2Huz5J2r59u1pbW/0Pj8czgj0BAACmiAx1BU6nU93d3QPau7q6FB0dHbR/c3PzoP2Hu75b63Q6nSOoHgAAmCjkIzAzZ85UV1eX2tvbA9o9Ho9cLteA/i6XS1euXBnQfqv/cNcHAACmnpADjM1mU0ZGhiorKwPaz5w5o+zs7AH9s7KyVFVVpf7+fn9bXV2dHA6HXC7XsNcHAACmnrBchbRlyxaVlpb6r/45cuSIOjo6tGLFigF9582bp6VLl2r37t2SpL6+Pm3btk1FRUUjWh8AAJh6Qp4DI0mrV6+Wx+NRVlaW7Ha74uPjdfToUdntdvX19SkvL0/l5eWKj4+XJB08eFCFhYVKTEyUz+dTbm6utm7dek/rAwAAsFl33sN/EvB6vYqLi1Nra6tiY2PHuxwAAHAPhvP3m0MaAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcQgwAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcQgwAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjhCXAHDhwQMnJyUpJSVFOTo6uXr06ZP+2tjbl5+crKSlJiYmJKisrk2VZ/tePHTumlStXavHixUpKStLmzZvV2dkZjlIBAMAkEHKAOXHihPbv36+zZ8/q/Pnz2rhxo9asWTPkMgUFBVq0aJFqa2tVXV2tTz/9VOXl5f7XZ8yYoUOHDqmmpkZut1ttbW0qLS0NtVQAADBJ2KzbD32MwJo1a7Rp0ybl5OT427Kzs/XTn/5UqampA/o3NTUpNTVV9fX1ioiIkCR98cUXysvLk9vtDroNt9utDRs2qKam5p5q8nq9iouLU2trq2JjY4e9TwAAYOwN5+93yEdgTp06pWXLlgW0LV++XCdPngza//Tp08rMzPSHF0lasGCBGhsb1djYGHSZpqYmRUVFDVpDT0+PvF5vwAMAAExeIQWY9vZ2RUZGavr06QHtCQkJunz5ctBlGhoalJCQMKDd5XKpvr4+6DJ79+7Vhg0bBq1j165diouL8z+CrR8AAEwewwowtbW1Sk1N9T8qKiqCHhmJiooadNJtS0vLsJY5ceKE3G63Nm3aNGhd27dvV2trq//h8XiGsVcAAMA0kcPpnJSUFDBP5fr16yopKRnQr6urS9HR0UHX4XQ61dzcfE/LeDweFRQUqKKiQk6nc9C6nE7nkK8DAIDJJaRTSDNnzlRXV5fa29sD2j0ej1wuV9BlXC6Xrly5MqD9zmU6Ojr09NNPa8eOHUpPTw+lTAAAMMmEFGBsNpsyMjJUWVkZ0H7mzBllZ2cHXSYrK0tVVVXq7+/3t9XV1cnhcPgDTH9/v9atW6ecnBw999xzoZQIAAAmoZCvQtqyZYtKS0v9V/4cOXJEHR0dWrFiRdD+8+bN09KlS7V7925JUl9fn7Zt26aioiJ/n+LiYkVHR+tHP/pRqOUBAIBJaFhzYIJZvXq1PB6PsrKyZLfbFR8fr6NHj8puv5mN+vr6lJeXp/LycsXHx0uSDh48qMLCQiUmJsrn8yk3N1dbt26VJDU3N2vPnj1auHCh0tLS/Nux2Ww6fvy4Zs+eHWrJAADAcCHfyG4i4kZ2AACYZ0xvZAcAADDWCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcQgwAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcQgwAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYJS4A5cOCAkpOTlZKSopycHF29enXI/m1tbcrPz1dSUpISExNVVlYmy7KC9v3888/ldDr1+uuvh6NUAAAwCYQcYE6cOKH9+/fr7NmzOn/+vDZu3Kg1a9YMuUxBQYEWLVqk2tpaVVdX69NPP1V5eXnQvsXFxXriiSfU19cXaqkAAGCSCDnA7Nu3T2VlZYqLi5Mk5eXlKSIiQm63O2j/pqYmVVVVadu2bZIkh8OhN998U/v37x/Qt6KiQrNnz1ZGRkaoZQIAgEkk5ABz6tQpLVu2LKBt+fLlOnnyZND+p0+fVmZmpiIiIvxtCxYsUGNjoxobG/1tnZ2dKi0t1RtvvHHXGnp6euT1egMeAABg8gopwLS3tysyMlLTp08PaE9ISNDly5eDLtPQ0KCEhIQB7S6XS/X19f7nO3fu1Pr16zV37ty71rFr1y7FxcX5H8HWDwAAJo/I4XSura1Vfn6+//nLL7+sqKioAf2ioqLU2dkZdB0tLS13XebSpUuqqKhQdXX1PdW1fft2lZSU+J97vV5CDAAAk9iwAkxSUlLA3Jbr168HBIdburq6FB0dHXQdTqdTzc3NQy5TXFysHTt2BA06g63T6XTeU18AAGC+kE4hzZw5U11dXWpvbw9o93g8crlcQZdxuVy6cuXKgPZbyxw/flydnZ1au3ZtKKUBAIBJLKQAY7PZlJGRocrKyoD2M2fOKDs7O+gyWVlZqqqqUn9/v7+trq5ODofDPw/m66+/Vmpqqv+xd+9evf3220pPTx/01BQAAJg6Qr4KacuWLSotLfVf+XPkyBF1dHRoxYoVQfvPmzdPS5cu1e7duyVJfX192rZtm4qKiiRJhYWF+uKLL+R2u/2PzZs36/nnn9e5c+cUExMTaskAAMBww5oDE8zq1avl8XiUlZUlu92u+Ph4HT16VHb7zWzU19envLw8lZeXKz4+XpJ08OBBFRYWKjExUT6fT7m5udq6deug25g2bZpsNluopQIAgEnCZg12D3+Deb1excXFqbW1VbGxseNdDgAAuAfD+fvNjzkCAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcQgwAADAOAQYAABgHAIMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGAcAgwAADAOAQYAABiHAAMAAIxDgAEAAMYhwAAAAOMQYAAAgHEIMAAAwDgEGAAAYBwCDAAAMA4BBgAAGIcAAwAAjEOAAQAAxiHAAAAA4xBgAACAcSLHu4DRYFmWJMnr9Y5zJQAA4F7d+rt96+/4UCZlgGlra5MkJSQkjHMlAABguNra2hQXFzdkH5t1LzHHMD6fTw0NDbrvvvtks9nGu5xx5/V6lZCQII/Ho9jY2PEuZ9JinMcG4zw2GOexw1j/P8uy1NbWprlz58puH3qWy6Q8AmO32+Vyuca7jAknNjZ2yv/jGAuM89hgnMcG4zx2GOub7nbk5RYm8QIAAOMQYAAAgHEIMFOA0+nUD3/4QzmdzvEuZVJjnMcG4zw2GOexw1iPzKScxAsAACY3jsAAAADjEGAAAIBxCDAAAMA4BBiDHThwQMnJyUpJSVFOTo6uXr06ZP+2tjbl5+crKSlJiYmJKisrG/R2zZ9//rmcTqdef/310SjdOOEe62PHjmnlypVavHixkpKStHnzZnV2do72bkxYwxnfe/kcD/f9mkrCOdZ8jgcX7s/0LXw338aCkY4fP26lp6dbLS0tlmVZ1nvvvWd961vfGnKZdevWWT/+8Y8ty7Ksnp4eKzc319qzZ0/QvqtWrbKefPJJ65VXXglv4QYajbE+c+aM9fXXX1uWZVl9fX3Ws88+a23dunWU9mBiG+743m1sR/J+TRXhHms+x8GFe5xvx3fz/yPAGGr16tXWsWPHAtqysrKs6urqoP3/93//10pISLBu3Ljhb6urq7NSUlIG9P2P//gP67nnnrN++MMf8o/EGt2xvqW6utpKTk4OR7nGGc743svYDvf9mkrCPdZ3msqf49uN1jjz3RyIU0iGOnXqlJYtWxbQtnz5cp08eTJo/9OnTyszM1MRERH+tgULFqixsVGNjY3+ts7OTpWWluqNN94YncINNFpjfbumpiZFRUWFr2iDDGd872Vsh/t+TSXhHus7TeXP8e1GY5z5bh6IAGOg9vZ2RUZGavr06QHtCQkJunz5ctBlGhoagv46t8vlUn19vf/5zp07tX79es2dOze8RRtqNMf6dnv37tWGDRtCL9gwwx3fu43tSN6vqSLcYx3MVP0c3260xpnv5oEm5Y85Tja1tbXKz8/3P3/55ZeD/i8nKipq0Al0LS0td13m0qVLqqioUHV1dZgqN89YjfXtTpw4IbfbrXfeeSeEys003LG6W//hrm8qCfdY32kqf45vNxrjzHdzcAQYAyQlJcntdvufX79+XSUlJQP6dXV1KTo6Oug6nE6nmpubh1ymuLhYO3bsmNKHgMdqrG/xeDwqKChQRUXFlLyNuNPpVHd394D2wcb3bmM73PVNJeEe69tN9c/x7UZjnPluDo5TSAaaOXOmurq61N7eHtDu8XjkcrmCLuNyuXTlypUB7beWOX78uDo7O7V27dpRqdlUozHWt3R0dOjpp5/Wjh07lJ6eHt7CDTHc8b3b2I7k/Zoqwj3Wt/A5DhTucea7eXAEGAPZbDZlZGSosrIyoP3MmTPKzs4OukxWVpaqqqrU39/vb6urq5PD4fCfa/3666+Vmprqf+zdu1dvv/220tPTp+zh99EYa0nq7+/XunXrlJOTo+eee270dmCCG+743m1sR/J+TRXhHmuJz3Ew4R5nvpuHMN6XQWFk3n//fevRRx+1WltbLcu6eZ+B5ORkq7+/f9BlvvOd7/jvNdDb22vl5uZab7755qD9uVTvptEY65deesl65plnLJ/PN7rFG2C443u3sR3J+zVVhHus+RwHF+5xvhPfzTcxB8ZQq1evlsfjUVZWlux2u+Lj43X06FHZ7TcPqvX19SkvL0/l5eWKj4+XJB08eFCFhYVKTEyUz+dTbm6utm7dOug2pk2bJpvNNib7M5GFe6ybm5u1Z88eLVy4UGlpaf7t2Gw2HT9+XLNnzx77nRxHQ43vSD7Hd3u/prJwjjWf48GF+zN9J76bb7JZ1iD3KwYAAJig+C8JAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAY6agoEAPPvhgwG3Ri4qKRn27V69e1Te+8Y1R3w6AscOdeAGMmd7eXpWWlur5558f0+329fWpt7d3TLcJYHRxBAYAABiHAANgQnj00Uf185//XJmZmUpOTtaSJUv0m9/8JqDPhx9+qPT0dC1cuFDz58/Xq6++GvArvj6fT//8z/+s+fPnKykpSX/1V3+lP/zhD5KkGzduqLCwUI888ogWLVqkp59+Wk1NTWO6jwDChwADYEJoa2vTnj179Ktf/UoXLlxQWVmZ1q5dq+7ubklSTU2NNm7cqH379qmurk41NTW6ePGiXnvtNf86SkpKdOHCBdXU1Ki2tlafffaZ5syZI0m6du2aHnroIX322We6ePGiZs+erZ07d47LvgIIHT/mCGDMfP/739dHH32kP//zP/e3vfTSS9q0aZPmzZunw4cP67HHHvO/tmrVKr3wwgtau3atNmzYoLS0NL388sv+169du6ZHHnlEV69e1fXr15Wdna0vv/xS0dHRAdv96quvlJiYqPb2dv+v+FZVVamkpES//e1vR3mvAYwGJvECGFNDTeJNTU0NeJ6cnKz6+npJ0oULFwZcsTR79mzNnTtXX375perq6pSWljYgvNzyZ3/2Z/7wIkmzZs3S9evXQ9gTAOOJU0gAJoy+vr6A552dnf5AEhEREXQZy7L8r924ceOet2Wz2eTz+UZYKYDxRoABMGG43e6A55988okWLVokSVqyZIl+/etfB7x+7do1NTY2av78+frWt76lTz75RF6vd6zKBTCOCDAAJoyysjJ/AHnnnXfU1dWlFStWSJKKi4v11ltv6dy5c5JuHp154YUX9OKLL8rpdOqhhx7SmjVr9Pzzz6urq2u8dgHAGGEODIAxExkZqbKyMv3kJz/xt7lcLv3nf/6nJKmoqEh//dd/rY6ODs2ZM0fHjh3zz1tJTEzU4cOH9dJLL6mlpUU+n08bNmzQK6+84l/Xnj17VFZWppSUFMXExKinp0e/+tWvNG3aNDmdzoBaHA7HgDYA5uAqJAATwrx58/TVV1+NdxkADMEpJAATQlRU1HiXAMAgHIEBAADG4QgMAAAwDgEGAAAYhwADAACMQ4ABAADGIcAAAADjEGAAAIBxCDAAAMA4BBgAAGCc/wMehFXDZHUy7QAAAABJRU5ErkJggg==\n"},"metadata":{}}]},{"cell_type":"code","source":["dl_predict =  model.predict(test_x.astype('float32'))\n","dl_predict = np.expm1(dl_predict)\n","\n","submission['ECLO'] = dl_predict\n","submission"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":442},"id":"XHSLKEmtlSC6","outputId":"9d71fc80-f247-4204-b8dc-5d6c810e5553","executionInfo":{"status":"ok","timestamp":1701117903946,"user_tz":-540,"elapsed":801,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["343/343 [==============================] - 1s 1ms/step\n"]},{"output_type":"execute_result","data":{"text/plain":["                   ID  ECLO\n","0      ACCIDENT_39609   NaN\n","1      ACCIDENT_39610   NaN\n","2      ACCIDENT_39611   NaN\n","3      ACCIDENT_39612   NaN\n","4      ACCIDENT_39613   NaN\n","...               ...   ...\n","10958  ACCIDENT_50567   NaN\n","10959  ACCIDENT_50568   NaN\n","10960  ACCIDENT_50569   NaN\n","10961  ACCIDENT_50570   NaN\n","10962  ACCIDENT_50571   NaN\n","\n","[10963 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-3e366d58-a0dd-445c-9c70-7221dda154a0\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>ECLO</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ACCIDENT_39609</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ACCIDENT_39610</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ACCIDENT_39611</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ACCIDENT_39612</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ACCIDENT_39613</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>10958</th>\n","      <td>ACCIDENT_50567</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>10959</th>\n","      <td>ACCIDENT_50568</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>10960</th>\n","      <td>ACCIDENT_50569</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>10961</th>\n","      <td>ACCIDENT_50570</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>10962</th>\n","      <td>ACCIDENT_50571</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>10963 rows × 2 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3e366d58-a0dd-445c-9c70-7221dda154a0')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-3e366d58-a0dd-445c-9c70-7221dda154a0 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-3e366d58-a0dd-445c-9c70-7221dda154a0');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-db775f25-d338-4156-87fb-844a159680c6\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-db775f25-d338-4156-87fb-844a159680c6')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-db775f25-d338-4156-87fb-844a159680c6 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":219}]},{"cell_type":"code","source":["submission.to_csv('feature_exp_v10_1127_dl.csv', index=False)\n","submission.to_csv(f'{DATA_PATH}feature_exp_v10_1127_dl.csv', index=False)"],"metadata":{"id":"NxLSeHYom6ge"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"8LIEkvl3Qnkk"},"source":["## XGB"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZcMJRvX_JO9Y"},"outputs":[],"source":["def xgb_objective(trial):\n","    params = {\n","        'objective': 'reg:squaredlogerror',\n","        'eval_metric': 'rmsle',\n","        'n_estimators': trial.suggest_int('n_estimators', 10, 300),\n","        'max_depth': trial.suggest_int('max_depth', 3, 50),\n","        'learning_rate': trial.suggest_float('learning_rate', 0.01, 0.1),\n","        'gamma': trial.suggest_float('gamma', 0, 1),\n","        'min_child_weight': trial.suggest_int('min_child_weight', 1, 10),\n","        'subsample': trial.suggest_float('subsample', 0.1, 1),\n","        'colsample_bytree': trial.suggest_float('colsample_bytree', 0.1, 1),\n","        'reg_alpha': trial.suggest_float('reg_alpha', 0, 10),\n","        'reg_lambda': trial.suggest_float('reg_lambda', 0, 10),\n","    }\n","\n","    cv = KFold(n_splits=5, shuffle=True, random_state=SEED)\n","    model = XGBRegressor(**params, random_state=SEED)\n","    scores = cross_val_score(model, train_x, target, cv=cv, scoring=rmsle_score, n_jobs=-1)\n","\n","    return scores.mean()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0_t47KSyQGl0","outputId":"16e51078-2782-47c8-b00a-f14c771b4bf6","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701118253317,"user_tz":-540,"elapsed":349384,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"stream","name":"stderr","text":["[I 2023-11-27 20:45:03,582] A new study created in memory with name: no-name-d288aebe-eb14-4524-a8c1-48e5a285cb43\n","[I 2023-11-27 20:45:06,455] Trial 0 finished with value: -0.17197136371373004 and parameters: {'n_estimators': 118, 'max_depth': 48, 'learning_rate': 0.07587945476302646, 'gamma': 0.5986584841970366, 'min_child_weight': 2, 'subsample': 0.2403950683025824, 'colsample_bytree': 0.15227525095137953, 'reg_alpha': 8.661761457749352, 'reg_lambda': 6.011150117432088}. Best is trial 0 with value: -0.17197136371373004.\n","[I 2023-11-27 20:45:08,900] Trial 1 finished with value: -0.17139572770271785 and parameters: {'n_estimators': 216, 'max_depth': 3, 'learning_rate': 0.0972918866945795, 'gamma': 0.8324426408004217, 'min_child_weight': 3, 'subsample': 0.26364247048639056, 'colsample_bytree': 0.2650640588680905, 'reg_alpha': 3.0424224295953772, 'reg_lambda': 5.247564316322379}. Best is trial 1 with value: -0.17139572770271785.\n","[I 2023-11-27 20:45:10,636] Trial 2 finished with value: -0.17064523416663863 and parameters: {'n_estimators': 135, 'max_depth': 16, 'learning_rate': 0.06506676052501416, 'gamma': 0.13949386065204183, 'min_child_weight': 3, 'subsample': 0.4297256589643226, 'colsample_bytree': 0.5104629857953323, 'reg_alpha': 7.851759613930136, 'reg_lambda': 1.9967378215835974}. Best is trial 2 with value: -0.17064523416663863.\n","[I 2023-11-27 20:45:12,509] Trial 3 finished with value: -0.1982142485599923 and parameters: {'n_estimators': 159, 'max_depth': 31, 'learning_rate': 0.014180537144799797, 'gamma': 0.6075448519014384, 'min_child_weight': 2, 'subsample': 0.1585464336867516, 'colsample_bytree': 0.9539969835279999, 'reg_alpha': 9.656320330745594, 'reg_lambda': 8.08397348116461}. Best is trial 2 with value: -0.17064523416663863.\n","[I 2023-11-27 20:45:13,834] Trial 4 finished with value: -0.1714580860490098 and parameters: {'n_estimators': 98, 'max_depth': 7, 'learning_rate': 0.07158097238609412, 'gamma': 0.4401524937396013, 'min_child_weight': 2, 'subsample': 0.5456592191001431, 'colsample_bytree': 0.13094966900369656, 'reg_alpha': 9.093204020787821, 'reg_lambda': 2.587799816000169}. Best is trial 2 with value: -0.17064523416663863.\n","[I 2023-11-27 20:45:16,909] Trial 5 finished with value: -0.1707795708531595 and parameters: {'n_estimators': 202, 'max_depth': 17, 'learning_rate': 0.05680612190600298, 'gamma': 0.5467102793432796, 'min_child_weight': 2, 'subsample': 0.9726261649881027, 'colsample_bytree': 0.7976195410250031, 'reg_alpha': 9.394989415641891, 'reg_lambda': 8.948273504276488}. Best is trial 2 with value: -0.17064523416663863.\n","[I 2023-11-27 20:45:19,960] Trial 6 finished with value: -0.17513343503432993 and parameters: {'n_estimators': 183, 'max_depth': 47, 'learning_rate': 0.017964325184672756, 'gamma': 0.1959828624191452, 'min_child_weight': 1, 'subsample': 0.39279729768693794, 'colsample_bytree': 0.4498095607205338, 'reg_alpha': 2.713490317738959, 'reg_lambda': 8.287375091519294}. Best is trial 2 with value: -0.17064523416663863.\n","[I 2023-11-27 20:45:21,414] Trial 7 finished with value: -0.1710974638584402 and parameters: {'n_estimators': 113, 'max_depth': 16, 'learning_rate': 0.058842647484242366, 'gamma': 0.14092422497476265, 'min_child_weight': 9, 'subsample': 0.16709557931179375, 'colsample_bytree': 0.9881982429404655, 'reg_alpha': 7.722447692966574, 'reg_lambda': 1.987156815341724}. Best is trial 2 with value: -0.17064523416663863.\n","[I 2023-11-27 20:45:21,831] Trial 8 finished with value: -0.3588198107219269 and parameters: {'n_estimators': 11, 'max_depth': 42, 'learning_rate': 0.07361716094628554, 'gamma': 0.7290071680409873, 'min_child_weight': 8, 'subsample': 0.16664018656068133, 'colsample_bytree': 0.4226191556898453, 'reg_alpha': 1.1586905952512971, 'reg_lambda': 8.631034258755935}. Best is trial 2 with value: -0.17064523416663863.\n","[I 2023-11-27 20:45:24,070] Trial 9 finished with value: -0.17785458552258207 and parameters: {'n_estimators': 191, 'max_depth': 18, 'learning_rate': 0.015720251525742128, 'gamma': 0.3109823217156622, 'min_child_weight': 4, 'subsample': 0.7566455605042577, 'colsample_bytree': 0.6738017242196918, 'reg_alpha': 8.872127425763265, 'reg_lambda': 4.722149251619493}. Best is trial 2 with value: -0.17064523416663863.\n","[I 2023-11-27 20:45:27,635] Trial 10 finished with value: -0.17032477843340219 and parameters: {'n_estimators': 285, 'max_depth': 29, 'learning_rate': 0.03769247903052361, 'gamma': 0.017961875614819434, 'min_child_weight': 6, 'subsample': 0.4711191495574919, 'colsample_bytree': 0.592541048007954, 'reg_alpha': 6.379717552110607, 'reg_lambda': 0.3990753571948482}. Best is trial 10 with value: -0.17032477843340219.\n","[I 2023-11-27 20:45:32,509] Trial 11 finished with value: -0.170346218790757 and parameters: {'n_estimators': 299, 'max_depth': 31, 'learning_rate': 0.03550799211259941, 'gamma': 0.02428316349722985, 'min_child_weight': 6, 'subsample': 0.4653855668017216, 'colsample_bytree': 0.5857880838178029, 'reg_alpha': 6.5412572107146225, 'reg_lambda': 0.0467528154143001}. Best is trial 10 with value: -0.17032477843340219.\n","[I 2023-11-27 20:45:37,093] Trial 12 finished with value: -0.17024080708612582 and parameters: {'n_estimators': 291, 'max_depth': 32, 'learning_rate': 0.03587618245579228, 'gamma': 0.012696383139845563, 'min_child_weight': 6, 'subsample': 0.5997063894945226, 'colsample_bytree': 0.6251919724957664, 'reg_alpha': 5.559890252184361, 'reg_lambda': 0.031072164879014888}. Best is trial 12 with value: -0.17024080708612582.\n","[I 2023-11-27 20:45:42,185] Trial 13 finished with value: -0.1702030857371396 and parameters: {'n_estimators': 299, 'max_depth': 39, 'learning_rate': 0.038800410795573094, 'gamma': 0.0018793753195176736, 'min_child_weight': 6, 'subsample': 0.6572510896636834, 'colsample_bytree': 0.6916668840010749, 'reg_alpha': 5.455810321699501, 'reg_lambda': 0.18292033678474007}. Best is trial 13 with value: -0.1702030857371396.\n","[I 2023-11-27 20:45:45,584] Trial 14 finished with value: -0.17053869040883643 and parameters: {'n_estimators': 250, 'max_depth': 39, 'learning_rate': 0.04161929357960566, 'gamma': 0.31014242514836743, 'min_child_weight': 7, 'subsample': 0.6861051379380695, 'colsample_bytree': 0.7468933529987746, 'reg_alpha': 4.346430314264509, 'reg_lambda': 0.25154038074295626}. Best is trial 13 with value: -0.1702030857371396.\n","[I 2023-11-27 20:45:50,552] Trial 15 finished with value: -0.17024359046111043 and parameters: {'n_estimators': 255, 'max_depth': 37, 'learning_rate': 0.0287980581898247, 'gamma': 0.010989189243771125, 'min_child_weight': 5, 'subsample': 0.6628272043957321, 'colsample_bytree': 0.825479684553651, 'reg_alpha': 4.5305035217245075, 'reg_lambda': 1.3609211058406523}. Best is trial 13 with value: -0.1702030857371396.\n","[I 2023-11-27 20:45:53,367] Trial 16 finished with value: -0.17103233285022917 and parameters: {'n_estimators': 248, 'max_depth': 23, 'learning_rate': 0.04698562192925765, 'gamma': 0.9796464996812291, 'min_child_weight': 8, 'subsample': 0.7965006982214111, 'colsample_bytree': 0.6914307738948051, 'reg_alpha': 5.596158930967834, 'reg_lambda': 3.196945778052324}. Best is trial 13 with value: -0.1702030857371396.\n","[I 2023-11-27 20:45:54,456] Trial 17 finished with value: -0.20793011851699833 and parameters: {'n_estimators': 72, 'max_depth': 38, 'learning_rate': 0.02779303758749304, 'gamma': 0.24623697615145693, 'min_child_weight': 5, 'subsample': 0.5860855181022345, 'colsample_bytree': 0.8736693629425878, 'reg_alpha': 5.73689467505592, 'reg_lambda': 1.1148496835926722}. Best is trial 13 with value: -0.1702030857371396.\n","[I 2023-11-27 20:45:57,666] Trial 18 finished with value: -0.17060884223186787 and parameters: {'n_estimators': 280, 'max_depth': 25, 'learning_rate': 0.04921439343560283, 'gamma': 0.4165530279020525, 'min_child_weight': 7, 'subsample': 0.8441805798692538, 'colsample_bytree': 0.6875962023752984, 'reg_alpha': 4.165883798656481, 'reg_lambda': 3.426056745058139}. Best is trial 13 with value: -0.1702030857371396.\n","[I 2023-11-27 20:46:01,222] Trial 19 finished with value: -0.17058452793475978 and parameters: {'n_estimators': 231, 'max_depth': 34, 'learning_rate': 0.02731733582555558, 'gamma': 0.08868026657441344, 'min_child_weight': 10, 'subsample': 0.6280872167008199, 'colsample_bytree': 0.6239988353057848, 'reg_alpha': 6.538839629254712, 'reg_lambda': 0.9067864893684866}. Best is trial 13 with value: -0.1702030857371396.\n","[I 2023-11-27 20:46:05,472] Trial 20 finished with value: -0.17033724690051458 and parameters: {'n_estimators': 265, 'max_depth': 45, 'learning_rate': 0.04333251931396608, 'gamma': 0.1047244806627795, 'min_child_weight': 4, 'subsample': 0.5710233581786309, 'colsample_bytree': 0.7551711480023047, 'reg_alpha': 5.197202893289965, 'reg_lambda': 1.4021692033024316}. Best is trial 13 with value: -0.1702030857371396.\n","[I 2023-11-27 20:46:10,750] Trial 21 finished with value: -0.17016074631650993 and parameters: {'n_estimators': 297, 'max_depth': 36, 'learning_rate': 0.028416400112792457, 'gamma': 0.029635671671193013, 'min_child_weight': 5, 'subsample': 0.695385842157353, 'colsample_bytree': 0.879342959004601, 'reg_alpha': 4.4142428834497185, 'reg_lambda': 0.08738493991485445}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:14,423] Trial 22 finished with value: -0.17030919240925116 and parameters: {'n_estimators': 296, 'max_depth': 42, 'learning_rate': 0.03560239830632187, 'gamma': 0.21139480672036173, 'min_child_weight': 7, 'subsample': 0.73161477288043, 'colsample_bytree': 0.9258100602108998, 'reg_alpha': 3.364962546697752, 'reg_lambda': 0.10100857587985627}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:19,762] Trial 23 finished with value: -0.17035270252731466 and parameters: {'n_estimators': 269, 'max_depth': 34, 'learning_rate': 0.022371438655514164, 'gamma': 0.018312198090511433, 'min_child_weight': 5, 'subsample': 0.6791749461119483, 'colsample_bytree': 0.8824493650528101, 'reg_alpha': 5.030911215349642, 'reg_lambda': 0.9332796207542}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:22,762] Trial 24 finished with value: -0.1703282331639468 and parameters: {'n_estimators': 232, 'max_depth': 50, 'learning_rate': 0.03235742545549553, 'gamma': 0.09920873588958204, 'min_child_weight': 6, 'subsample': 0.5283454218098278, 'colsample_bytree': 0.846580937271233, 'reg_alpha': 3.867367996025979, 'reg_lambda': 2.029048885096772}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:26,405] Trial 25 finished with value: -0.17058287727916294 and parameters: {'n_estimators': 300, 'max_depth': 22, 'learning_rate': 0.021107883260779593, 'gamma': 0.19441037214050264, 'min_child_weight': 4, 'subsample': 0.6231436128073836, 'colsample_bytree': 0.7509227763863187, 'reg_alpha': 6.026252626096365, 'reg_lambda': 0.021839644590753493}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:29,298] Trial 26 finished with value: -0.18133504793205552 and parameters: {'n_estimators': 229, 'max_depth': 35, 'learning_rate': 0.011980390326680197, 'gamma': 0.08303011580878594, 'min_child_weight': 8, 'subsample': 0.8531460712080623, 'colsample_bytree': 0.9284163016094523, 'reg_alpha': 4.9718900582794845, 'reg_lambda': 1.0656071597454397}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:34,323] Trial 27 finished with value: -0.17055678981953973 and parameters: {'n_estimators': 274, 'max_depth': 28, 'learning_rate': 0.03990894178065751, 'gamma': 0.2695574072727871, 'min_child_weight': 6, 'subsample': 0.7299262289985572, 'colsample_bytree': 0.8085016739949729, 'reg_alpha': 7.237351230392468, 'reg_lambda': 0.7445715235468161}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:37,702] Trial 28 finished with value: -0.17209870787709478 and parameters: {'n_estimators': 165, 'max_depth': 42, 'learning_rate': 0.02296615855546182, 'gamma': 0.16852858053732736, 'min_child_weight': 7, 'subsample': 0.6204365831211933, 'colsample_bytree': 0.9950189793852244, 'reg_alpha': 2.1799659399932745, 'reg_lambda': 1.6401083435773884}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:41,075] Trial 29 finished with value: -0.1702272669231133 and parameters: {'n_estimators': 248, 'max_depth': 45, 'learning_rate': 0.04879164292316299, 'gamma': 0.08662681363956923, 'min_child_weight': 5, 'subsample': 0.5310518134894946, 'colsample_bytree': 0.6467692388346324, 'reg_alpha': 3.5746636620207335, 'reg_lambda': 2.8431715544776197}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:44,154] Trial 30 finished with value: -0.17023765659844386 and parameters: {'n_estimators': 243, 'max_depth': 45, 'learning_rate': 0.049531969823517014, 'gamma': 0.08539310037594126, 'min_child_weight': 3, 'subsample': 0.5122673585011683, 'colsample_bytree': 0.8743736914473124, 'reg_alpha': 3.7195034331262784, 'reg_lambda': 2.6104435789462084}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:49,044] Trial 31 finished with value: -0.1701939616090062 and parameters: {'n_estimators': 250, 'max_depth': 45, 'learning_rate': 0.05187984377790819, 'gamma': 0.07088900815714486, 'min_child_weight': 3, 'subsample': 0.3661900372658876, 'colsample_bytree': 0.8827585550261893, 'reg_alpha': 3.294698207272665, 'reg_lambda': 2.850128705988758}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:51,666] Trial 32 finished with value: -0.17033128658900293 and parameters: {'n_estimators': 214, 'max_depth': 48, 'learning_rate': 0.05307017343077615, 'gamma': 0.15935742256046684, 'min_child_weight': 4, 'subsample': 0.38401180182262334, 'colsample_bytree': 0.754664458274845, 'reg_alpha': 2.8430665275550404, 'reg_lambda': 2.860986890989108}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:54,915] Trial 33 finished with value: -0.17035460577056585 and parameters: {'n_estimators': 265, 'max_depth': 41, 'learning_rate': 0.04512310502377641, 'gamma': 0.06914686782312696, 'min_child_weight': 3, 'subsample': 0.30600788033796017, 'colsample_bytree': 0.9005407672536196, 'reg_alpha': 4.62399319110824, 'reg_lambda': 3.7802535813149003}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:46:57,570] Trial 34 finished with value: -0.17033777446675605 and parameters: {'n_estimators': 215, 'max_depth': 45, 'learning_rate': 0.059844938246982754, 'gamma': 0.13617826356501087, 'min_child_weight': 5, 'subsample': 0.4825366028564957, 'colsample_bytree': 0.5227006576779945, 'reg_alpha': 3.2894228485193664, 'reg_lambda': 4.190873975479562}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:47:02,264] Trial 35 finished with value: -0.17025502493289774 and parameters: {'n_estimators': 277, 'max_depth': 39, 'learning_rate': 0.06526924237077802, 'gamma': 0.05909327747161118, 'min_child_weight': 1, 'subsample': 0.3411661096005451, 'colsample_bytree': 0.9421956962956741, 'reg_alpha': 3.6903248259250208, 'reg_lambda': 6.3382165520184}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:47:04,606] Trial 36 finished with value: -0.17025849582463262 and parameters: {'n_estimators': 135, 'max_depth': 50, 'learning_rate': 0.0522658756021067, 'gamma': 0.13276875775191418, 'min_child_weight': 3, 'subsample': 0.5461500611497522, 'colsample_bytree': 0.8099865756057937, 'reg_alpha': 2.0847448009705793, 'reg_lambda': 1.9797234109587865}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:47:07,046] Trial 37 finished with value: -0.1703875675189351 and parameters: {'n_estimators': 175, 'max_depth': 11, 'learning_rate': 0.0432206154757457, 'gamma': 0.007399290571103903, 'min_child_weight': 4, 'subsample': 0.24379277394144655, 'colsample_bytree': 0.6995907677946753, 'reg_alpha': 4.000326691864714, 'reg_lambda': 2.4447427353270483}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:47:09,549] Trial 38 finished with value: -0.1705267512213568 and parameters: {'n_estimators': 200, 'max_depth': 46, 'learning_rate': 0.08476289885808641, 'gamma': 0.22841808431893026, 'min_child_weight': 5, 'subsample': 0.42066779663618675, 'colsample_bytree': 0.8506241952864246, 'reg_alpha': 4.497795767292278, 'reg_lambda': 1.6496101282787847}. Best is trial 21 with value: -0.17016074631650993.\n","[I 2023-11-27 20:47:13,133] Trial 39 finished with value: -0.17009461910612594 and parameters: {'n_estimators': 258, 'max_depth': 36, 'learning_rate': 0.05540247202548387, 'gamma': 0.12089813754946133, 'min_child_weight': 2, 'subsample': 0.5047156606038523, 'colsample_bytree': 0.9580007261470083, 'reg_alpha': 0.3572183931395041, 'reg_lambda': 0.62423092389716}. Best is trial 39 with value: -0.17009461910612594.\n","[I 2023-11-27 20:47:19,702] Trial 40 finished with value: -0.1700743109129395 and parameters: {'n_estimators': 264, 'max_depth': 36, 'learning_rate': 0.05395808072339067, 'gamma': 0.1713817892770962, 'min_child_weight': 2, 'subsample': 0.442121672369843, 'colsample_bytree': 0.9717270464749997, 'reg_alpha': 0.48085313852272193, 'reg_lambda': 0.6000142904055152}. Best is trial 40 with value: -0.1700743109129395.\n","[I 2023-11-27 20:47:24,237] Trial 41 finished with value: -0.17008613476650342 and parameters: {'n_estimators': 261, 'max_depth': 37, 'learning_rate': 0.05992046250671579, 'gamma': 0.1782059714051074, 'min_child_weight': 2, 'subsample': 0.43186223102557253, 'colsample_bytree': 0.9981549469204791, 'reg_alpha': 0.14800630642531232, 'reg_lambda': 0.5559952159424886}. Best is trial 40 with value: -0.1700743109129395.\n","[I 2023-11-27 20:47:27,842] Trial 42 finished with value: -0.1700960769852166 and parameters: {'n_estimators': 260, 'max_depth': 36, 'learning_rate': 0.062414160672073754, 'gamma': 0.16802115541218396, 'min_child_weight': 2, 'subsample': 0.44287776551779046, 'colsample_bytree': 0.9751448818474612, 'reg_alpha': 0.19167324080252895, 'reg_lambda': 0.9512360624114358}. Best is trial 40 with value: -0.1700743109129395.\n","[I 2023-11-27 20:47:31,417] Trial 43 finished with value: -0.17007632633002018 and parameters: {'n_estimators': 231, 'max_depth': 35, 'learning_rate': 0.06324584515661985, 'gamma': 0.1655909928408132, 'min_child_weight': 1, 'subsample': 0.4287926340257896, 'colsample_bytree': 0.99726755057363, 'reg_alpha': 0.3708715858000551, 'reg_lambda': 0.6476075551403402}. Best is trial 40 with value: -0.1700743109129395.\n","[I 2023-11-27 20:47:35,697] Trial 44 finished with value: -0.17013990118109312 and parameters: {'n_estimators': 226, 'max_depth': 32, 'learning_rate': 0.06283202142013497, 'gamma': 0.27358558770049535, 'min_child_weight': 1, 'subsample': 0.4306693151660555, 'colsample_bytree': 0.997440318951927, 'reg_alpha': 0.03282313508344237, 'reg_lambda': 0.5314098872080211}. Best is trial 40 with value: -0.1700743109129395.\n","[I 2023-11-27 20:47:38,553] Trial 45 finished with value: -0.1700594447739911 and parameters: {'n_estimators': 206, 'max_depth': 30, 'learning_rate': 0.05680693927161811, 'gamma': 0.1828194570785902, 'min_child_weight': 2, 'subsample': 0.4342670370521386, 'colsample_bytree': 0.9498954478962048, 'reg_alpha': 0.058237514149949876, 'reg_lambda': 0.642576568253548}. Best is trial 45 with value: -0.1700594447739911.\n","[I 2023-11-27 20:47:41,131] Trial 46 finished with value: -0.1704008229846839 and parameters: {'n_estimators': 206, 'max_depth': 29, 'learning_rate': 0.05592979437000299, 'gamma': 0.36824355648772644, 'min_child_weight': 2, 'subsample': 0.31069095069260044, 'colsample_bytree': 0.9486725739140481, 'reg_alpha': 0.708002670848669, 'reg_lambda': 0.4442992118723661}. Best is trial 45 with value: -0.1700594447739911.\n","[I 2023-11-27 20:47:43,646] Trial 47 finished with value: -0.17014391354778988 and parameters: {'n_estimators': 190, 'max_depth': 26, 'learning_rate': 0.05630881539178086, 'gamma': 0.20382529827685275, 'min_child_weight': 1, 'subsample': 0.49024866129709715, 'colsample_bytree': 0.9374426954732153, 'reg_alpha': 0.7625432369203013, 'reg_lambda': 0.7918523680035661}. Best is trial 45 with value: -0.1700594447739911.\n","[I 2023-11-27 20:47:45,827] Trial 48 finished with value: -0.1703858586330509 and parameters: {'n_estimators': 138, 'max_depth': 31, 'learning_rate': 0.0675932531908105, 'gamma': 0.3014838692892699, 'min_child_weight': 2, 'subsample': 0.4157068035503414, 'colsample_bytree': 0.9740598764156279, 'reg_alpha': 1.3306582551675796, 'reg_lambda': 1.4441580318232021}. Best is trial 45 with value: -0.1700594447739911.\n","[I 2023-11-27 20:47:50,155] Trial 49 finished with value: -0.17027223244659231 and parameters: {'n_estimators': 236, 'max_depth': 33, 'learning_rate': 0.060325091033392, 'gamma': 0.34472905147284805, 'min_child_weight': 1, 'subsample': 0.45155072252908546, 'colsample_bytree': 0.9953972229180194, 'reg_alpha': 0.47839953130465024, 'reg_lambda': 0.5554932915709746}. Best is trial 45 with value: -0.1700594447739911.\n","[I 2023-11-27 20:47:51,270] Trial 50 finished with value: -0.17077219963407547 and parameters: {'n_estimators': 68, 'max_depth': 30, 'learning_rate': 0.06870214266453042, 'gamma': 0.23659087219674474, 'min_child_weight': 2, 'subsample': 0.38522724132953845, 'colsample_bytree': 0.9597466703422798, 'reg_alpha': 1.1715907305870397, 'reg_lambda': 2.097663042338023}. Best is trial 45 with value: -0.1700594447739911.\n","[I 2023-11-27 20:47:54,563] Trial 51 finished with value: -0.1700903257498078 and parameters: {'n_estimators': 260, 'max_depth': 37, 'learning_rate': 0.062201115581198466, 'gamma': 0.18490893141603088, 'min_child_weight': 2, 'subsample': 0.45506252229276006, 'colsample_bytree': 0.9140684970553312, 'reg_alpha': 0.11168825552058204, 'reg_lambda': 1.1189038192538951}. Best is trial 45 with value: -0.1700594447739911.\n","[I 2023-11-27 20:47:58,143] Trial 52 finished with value: -0.17004887032491653 and parameters: {'n_estimators': 286, 'max_depth': 40, 'learning_rate': 0.05817835503653145, 'gamma': 0.17959385912544268, 'min_child_weight': 2, 'subsample': 0.48893821123249237, 'colsample_bytree': 0.9156666255566892, 'reg_alpha': 0.17505361294106192, 'reg_lambda': 1.3021479578641277}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:02,599] Trial 53 finished with value: -0.17007913382574985 and parameters: {'n_estimators': 283, 'max_depth': 40, 'learning_rate': 0.05765584478970545, 'gamma': 0.20031345021975283, 'min_child_weight': 1, 'subsample': 0.4602995457796283, 'colsample_bytree': 0.9122146479085601, 'reg_alpha': 0.05688977309618472, 'reg_lambda': 1.1946627472425968}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:06,576] Trial 54 finished with value: -0.17021547250616614 and parameters: {'n_estimators': 273, 'max_depth': 40, 'learning_rate': 0.0579322030121162, 'gamma': 0.2507317315394559, 'min_child_weight': 1, 'subsample': 0.40750543311737636, 'colsample_bytree': 0.9032395436915842, 'reg_alpha': 0.8180238795046296, 'reg_lambda': 1.445892441376368}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:10,006] Trial 55 finished with value: -0.17017489772918215 and parameters: {'n_estimators': 285, 'max_depth': 43, 'learning_rate': 0.072090043228719, 'gamma': 0.17302647596861112, 'min_child_weight': 1, 'subsample': 0.4710362618622125, 'colsample_bytree': 0.9270230471801398, 'reg_alpha': 1.4812119135376822, 'reg_lambda': 0.4577616088143788}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:13,432] Trial 56 finished with value: -0.17009613318791272 and parameters: {'n_estimators': 284, 'max_depth': 38, 'learning_rate': 0.057970211915648336, 'gamma': 0.21185599765849847, 'min_child_weight': 3, 'subsample': 0.5664266596209582, 'colsample_bytree': 0.8355641886956984, 'reg_alpha': 0.4872742165308447, 'reg_lambda': 1.1739398939985963}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:18,082] Trial 57 finished with value: -0.17020903643549187 and parameters: {'n_estimators': 239, 'max_depth': 34, 'learning_rate': 0.05447129045363165, 'gamma': 0.1339505561594973, 'min_child_weight': 1, 'subsample': 0.35700260981538345, 'colsample_bytree': 0.9684850598893543, 'reg_alpha': 0.06441031554943366, 'reg_lambda': 1.8260022147727222}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:21,085] Trial 58 finished with value: -0.1702494854896761 and parameters: {'n_estimators': 218, 'max_depth': 40, 'learning_rate': 0.06876772655122888, 'gamma': 0.2928692849216222, 'min_child_weight': 3, 'subsample': 0.49673549731521655, 'colsample_bytree': 0.9051631056634126, 'reg_alpha': 0.8563093140627467, 'reg_lambda': 2.302418800200188}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:24,454] Trial 59 finished with value: -0.1703019955623229 and parameters: {'n_estimators': 287, 'max_depth': 3, 'learning_rate': 0.07615970973087365, 'gamma': 0.23004481337475177, 'min_child_weight': 2, 'subsample': 0.39855940186430816, 'colsample_bytree': 0.8537180080755098, 'reg_alpha': 1.6845142921958751, 'reg_lambda': 1.310395147641748}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:25,117] Trial 60 finished with value: -0.24477368520318707 and parameters: {'n_estimators': 30, 'max_depth': 43, 'learning_rate': 0.05110779798329151, 'gamma': 0.15287621807441268, 'min_child_weight': 2, 'subsample': 0.43707500394268056, 'colsample_bytree': 0.7827028141493382, 'reg_alpha': 1.09534136191315, 'reg_lambda': 1.6754751747224481}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:28,342] Trial 61 finished with value: -0.17008333761440345 and parameters: {'n_estimators': 258, 'max_depth': 37, 'learning_rate': 0.06193122379481621, 'gamma': 0.18478027886089385, 'min_child_weight': 1, 'subsample': 0.4433167286660723, 'colsample_bytree': 0.9126933562305634, 'reg_alpha': 0.01342673199203722, 'reg_lambda': 1.0476538462840628}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:32,808] Trial 62 finished with value: -0.17017099589168885 and parameters: {'n_estimators': 270, 'max_depth': 38, 'learning_rate': 0.06010689134709374, 'gamma': 0.2626154631529888, 'min_child_weight': 1, 'subsample': 0.46856648179681665, 'colsample_bytree': 0.9578858321331927, 'reg_alpha': 0.3806415946373287, 'reg_lambda': 0.7497548735359816}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:36,533] Trial 63 finished with value: -0.17007210965985403 and parameters: {'n_estimators': 254, 'max_depth': 33, 'learning_rate': 0.06492361579962644, 'gamma': 0.18835412067664592, 'min_child_weight': 1, 'subsample': 0.5243511466691191, 'colsample_bytree': 0.9193629601859911, 'reg_alpha': 0.041080162633654715, 'reg_lambda': 0.3218689220060287}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:39,926] Trial 64 finished with value: -0.17009505104072786 and parameters: {'n_estimators': 248, 'max_depth': 33, 'learning_rate': 0.05373761842668691, 'gamma': 0.11490292698573219, 'min_child_weight': 1, 'subsample': 0.5460781537418697, 'colsample_bytree': 0.9154722416814909, 'reg_alpha': 0.5553384583776506, 'reg_lambda': 0.31205526895086916}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:42,700] Trial 65 finished with value: -0.17016601358605213 and parameters: {'n_estimators': 222, 'max_depth': 23, 'learning_rate': 0.06390326310446048, 'gamma': 0.20091861227401078, 'min_child_weight': 1, 'subsample': 0.49757456276049117, 'colsample_bytree': 0.8703478016033821, 'reg_alpha': 0.9546879796667959, 'reg_lambda': 1.0257076994854288}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:46,903] Trial 66 finished with value: -0.17021669923543276 and parameters: {'n_estimators': 278, 'max_depth': 28, 'learning_rate': 0.06605494319911237, 'gamma': 0.3333639126357576, 'min_child_weight': 1, 'subsample': 0.5782512102530571, 'colsample_bytree': 0.8176434501915093, 'reg_alpha': 0.5500393160049075, 'reg_lambda': 0.0594709631567511}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:50,572] Trial 67 finished with value: -0.170182336555807 and parameters: {'n_estimators': 240, 'max_depth': 35, 'learning_rate': 0.049785255468053125, 'gamma': 0.22652095344328493, 'min_child_weight': 2, 'subsample': 0.521294625680522, 'colsample_bytree': 0.9369909313956439, 'reg_alpha': 0.9789002035978907, 'reg_lambda': 1.3390789151316858}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:53,240] Trial 68 finished with value: -0.17015491171687983 and parameters: {'n_estimators': 204, 'max_depth': 32, 'learning_rate': 0.05686985121053446, 'gamma': 0.2756981425604115, 'min_child_weight': 1, 'subsample': 0.4767839986035096, 'colsample_bytree': 0.8898775909456859, 'reg_alpha': 0.03565557314806078, 'reg_lambda': 0.25747764937380524}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:48:58,822] Trial 69 finished with value: -0.1711742974660044 and parameters: {'n_estimators': 288, 'max_depth': 41, 'learning_rate': 0.047142875873958184, 'gamma': 0.052009126833778674, 'min_child_weight': 1, 'subsample': 0.5335605042191331, 'colsample_bytree': 0.8567757752498932, 'reg_alpha': 0.3546663534882482, 'reg_lambda': 0.7254563834853454}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:03,924] Trial 70 finished with value: -0.17010335571707574 and parameters: {'n_estimators': 256, 'max_depth': 35, 'learning_rate': 0.06378455777623712, 'gamma': 0.11171338801650012, 'min_child_weight': 2, 'subsample': 0.4565365503778175, 'colsample_bytree': 0.972362426147403, 'reg_alpha': 0.6779452406425635, 'reg_lambda': 1.5508678609337598}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:07,971] Trial 71 finished with value: -0.17007886017082402 and parameters: {'n_estimators': 267, 'max_depth': 37, 'learning_rate': 0.06034440589143708, 'gamma': 0.17656625089954334, 'min_child_weight': 2, 'subsample': 0.4130285428444726, 'colsample_bytree': 0.9958962713012196, 'reg_alpha': 0.28151531723758694, 'reg_lambda': 0.3306499914533051}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:12,023] Trial 72 finished with value: -0.17009970942416838 and parameters: {'n_estimators': 270, 'max_depth': 30, 'learning_rate': 0.054184546407979886, 'gamma': 0.1586970936878846, 'min_child_weight': 2, 'subsample': 0.40424123185320243, 'colsample_bytree': 0.923191817343723, 'reg_alpha': 0.3835739870636978, 'reg_lambda': 0.3348408477150865}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:16,384] Trial 73 finished with value: -0.17020776533240775 and parameters: {'n_estimators': 295, 'max_depth': 39, 'learning_rate': 0.06129280511564187, 'gamma': 0.19751726032157116, 'min_child_weight': 3, 'subsample': 0.37315760461960384, 'colsample_bytree': 0.9463842422717316, 'reg_alpha': 1.2814385316735044, 'reg_lambda': 0.9684990572067328}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:20,343] Trial 74 finished with value: -0.1701007157002912 and parameters: {'n_estimators': 251, 'max_depth': 33, 'learning_rate': 0.05886692767925489, 'gamma': 0.14255734307513349, 'min_child_weight': 1, 'subsample': 0.4133406064540018, 'colsample_bytree': 0.8949365397216059, 'reg_alpha': 0.7529004625068094, 'reg_lambda': 1.8361201378524594}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:23,419] Trial 75 finished with value: -0.1701037639975093 and parameters: {'n_estimators': 244, 'max_depth': 37, 'learning_rate': 0.057477218981857016, 'gamma': 0.24924256923655747, 'min_child_weight': 2, 'subsample': 0.5001265712816488, 'colsample_bytree': 0.99867922602788, 'reg_alpha': 0.004518030166947649, 'reg_lambda': 1.1259935726402373}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:28,088] Trial 76 finished with value: -0.17061804052649024 and parameters: {'n_estimators': 280, 'max_depth': 40, 'learning_rate': 0.06534073086180116, 'gamma': 0.04712005490581628, 'min_child_weight': 1, 'subsample': 0.3385125515675006, 'colsample_bytree': 0.8340244997598844, 'reg_alpha': 1.0546110075701614, 'reg_lambda': 0.03629817661678558}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:33,293] Trial 77 finished with value: -0.1701527474057282 and parameters: {'n_estimators': 235, 'max_depth': 43, 'learning_rate': 0.05348336415136832, 'gamma': 0.10462808525639916, 'min_child_weight': 2, 'subsample': 0.44501624282238333, 'colsample_bytree': 0.9648114265578902, 'reg_alpha': 0.2872177075181976, 'reg_lambda': 0.8130274337899772}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:36,558] Trial 78 finished with value: -0.17015531235825776 and parameters: {'n_estimators': 263, 'max_depth': 35, 'learning_rate': 0.0620502917230749, 'gamma': 0.17780647743474753, 'min_child_weight': 9, 'subsample': 0.5175978503800358, 'colsample_bytree': 0.9183668888416787, 'reg_alpha': 1.5537017066137857, 'reg_lambda': 0.3834967339709292}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:40,064] Trial 79 finished with value: -0.17013651748660186 and parameters: {'n_estimators': 293, 'max_depth': 27, 'learning_rate': 0.05082977264375019, 'gamma': 0.22418192139804313, 'min_child_weight': 3, 'subsample': 0.5579595148332124, 'colsample_bytree': 0.8680656671669298, 'reg_alpha': 0.5844903851695842, 'reg_lambda': 1.2490476149235512}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:43,651] Trial 80 finished with value: -0.17009807345855088 and parameters: {'n_estimators': 267, 'max_depth': 41, 'learning_rate': 0.05584882695549633, 'gamma': 0.1402997621951505, 'min_child_weight': 1, 'subsample': 0.48051398481233115, 'colsample_bytree': 0.9775565222859567, 'reg_alpha': 0.2525605746563091, 'reg_lambda': 0.6955617470534287}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:48,513] Trial 81 finished with value: -0.17007918632708657 and parameters: {'n_estimators': 254, 'max_depth': 38, 'learning_rate': 0.06159509437834339, 'gamma': 0.18245870516985718, 'min_child_weight': 2, 'subsample': 0.431347057021722, 'colsample_bytree': 0.9949926947339852, 'reg_alpha': 0.20159357005961767, 'reg_lambda': 0.5071083142087576}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:51,385] Trial 82 finished with value: -0.17016246558682907 and parameters: {'n_estimators': 229, 'max_depth': 38, 'learning_rate': 0.05977338013930427, 'gamma': 0.19670022792093245, 'min_child_weight': 2, 'subsample': 0.3833015170687192, 'colsample_bytree': 0.9423831180063743, 'reg_alpha': 0.632424552792368, 'reg_lambda': 0.26682225808901544}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:54,669] Trial 83 finished with value: -0.17007315236583814 and parameters: {'n_estimators': 253, 'max_depth': 36, 'learning_rate': 0.06486616004559861, 'gamma': 0.15612918962229144, 'min_child_weight': 2, 'subsample': 0.43206582312651026, 'colsample_bytree': 0.9798964880792804, 'reg_alpha': 0.2941300728616332, 'reg_lambda': 0.9089150878628526}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:49:58,135] Trial 84 finished with value: -0.17010916812268154 and parameters: {'n_estimators': 276, 'max_depth': 31, 'learning_rate': 0.066110992526122, 'gamma': 0.11449662247357785, 'min_child_weight': 3, 'subsample': 0.42330987654192465, 'colsample_bytree': 0.9790526946161642, 'reg_alpha': 1.0162396367297204, 'reg_lambda': 0.6294746991107648}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:03,482] Trial 85 finished with value: -0.17045106228810228 and parameters: {'n_estimators': 211, 'max_depth': 34, 'learning_rate': 0.06409288029202286, 'gamma': 0.08998704732834767, 'min_child_weight': 2, 'subsample': 0.46082781297306735, 'colsample_bytree': 0.9550664170485724, 'reg_alpha': 0.26632642161942105, 'reg_lambda': 0.8187759814641283}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:06,623] Trial 86 finished with value: -0.17013335051925033 and parameters: {'n_estimators': 251, 'max_depth': 36, 'learning_rate': 0.06972947674285737, 'gamma': 0.1590505164356212, 'min_child_weight': 2, 'subsample': 0.3906146178431845, 'colsample_bytree': 0.9841272159651879, 'reg_alpha': 0.8491375128769002, 'reg_lambda': 0.29671510880403584}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:09,107] Trial 87 finished with value: -0.1702618803996468 and parameters: {'n_estimators': 194, 'max_depth': 33, 'learning_rate': 0.05877142189077063, 'gamma': 0.25052634065094137, 'min_child_weight': 3, 'subsample': 0.4230394760212733, 'colsample_bytree': 0.9388805816659992, 'reg_alpha': 1.26292325173282, 'reg_lambda': 0.03870813736649292}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:12,048] Trial 88 finished with value: -0.1701180507201364 and parameters: {'n_estimators': 226, 'max_depth': 39, 'learning_rate': 0.06692486968034463, 'gamma': 0.12699600508673065, 'min_child_weight': 3, 'subsample': 0.3518047655454617, 'colsample_bytree': 0.8896268040265162, 'reg_alpha': 0.4946921800175218, 'reg_lambda': 0.5140323493853339}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:16,055] Trial 89 finished with value: -0.1700983505854459 and parameters: {'n_estimators': 245, 'max_depth': 30, 'learning_rate': 0.0525454620079302, 'gamma': 0.21342163843107, 'min_child_weight': 2, 'subsample': 0.4853189805592526, 'colsample_bytree': 0.9855238238608195, 'reg_alpha': 0.2837222549691335, 'reg_lambda': 1.4060908037872815}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:19,498] Trial 90 finished with value: -0.17023279685427847 and parameters: {'n_estimators': 148, 'max_depth': 42, 'learning_rate': 0.05546936079620361, 'gamma': 0.06544915974652182, 'min_child_weight': 1, 'subsample': 0.5108656820653121, 'colsample_bytree': 0.9571843852596066, 'reg_alpha': 0.6764856813037289, 'reg_lambda': 0.8668135555467776}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:22,737] Trial 91 finished with value: -0.17008461465869126 and parameters: {'n_estimators': 255, 'max_depth': 36, 'learning_rate': 0.061995163865621435, 'gamma': 0.1854503445705388, 'min_child_weight': 1, 'subsample': 0.4535993078300382, 'colsample_bytree': 0.9129697395228498, 'reg_alpha': 0.159294492289625, 'reg_lambda': 1.0450937789040138}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:26,206] Trial 92 finished with value: -0.17009884533411118 and parameters: {'n_estimators': 266, 'max_depth': 37, 'learning_rate': 0.06379775196829847, 'gamma': 0.16268549318742942, 'min_child_weight': 1, 'subsample': 0.4355919271965602, 'colsample_bytree': 0.9357290575834147, 'reg_alpha': 0.0711855317355631, 'reg_lambda': 1.2015839012253862}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:30,486] Trial 93 finished with value: -0.1701134334083188 and parameters: {'n_estimators': 280, 'max_depth': 35, 'learning_rate': 0.06055908499708167, 'gamma': 0.18580206507007313, 'min_child_weight': 2, 'subsample': 0.39083044183684346, 'colsample_bytree': 0.9973553931552211, 'reg_alpha': 0.03878522901868092, 'reg_lambda': 0.5617032906962697}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:34,686] Trial 94 finished with value: -0.1700874939529751 and parameters: {'n_estimators': 254, 'max_depth': 39, 'learning_rate': 0.057494949078033916, 'gamma': 0.14448854112094095, 'min_child_weight': 2, 'subsample': 0.40618328135064463, 'colsample_bytree': 0.8904168897128328, 'reg_alpha': 0.4311367889673626, 'reg_lambda': 1.5985468782762287}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:37,597] Trial 95 finished with value: -0.17018371501475887 and parameters: {'n_estimators': 236, 'max_depth': 32, 'learning_rate': 0.06526422874380905, 'gamma': 0.21321349049689534, 'min_child_weight': 1, 'subsample': 0.4713959382185901, 'colsample_bytree': 0.9088611355688582, 'reg_alpha': 0.8096894148033036, 'reg_lambda': 0.9365300177506342}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:40,003] Trial 96 finished with value: -0.17013944908270617 and parameters: {'n_estimators': 176, 'max_depth': 38, 'learning_rate': 0.060757738888985696, 'gamma': 0.2392579055857805, 'min_child_weight': 4, 'subsample': 0.44426666479803933, 'colsample_bytree': 0.9588360115781819, 'reg_alpha': 0.30332738157995204, 'reg_lambda': 0.23936501788190395}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:42,586] Trial 97 finished with value: -0.17042951563571213 and parameters: {'n_estimators': 121, 'max_depth': 40, 'learning_rate': 0.05842950171235764, 'gamma': 0.28754066235703424, 'min_child_weight': 1, 'subsample': 0.3696242692296554, 'colsample_bytree': 0.9784413424024266, 'reg_alpha': 1.0975291854369882, 'reg_lambda': 1.2271549617527042}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:49,408] Trial 98 finished with value: -0.170926153030837 and parameters: {'n_estimators': 260, 'max_depth': 34, 'learning_rate': 0.06779910233384732, 'gamma': 0.09898667978969486, 'min_child_weight': 2, 'subsample': 0.5325726015664576, 'colsample_bytree': 0.999791723843307, 'reg_alpha': 0.0006565020879645694, 'reg_lambda': 0.4805249541995899}. Best is trial 52 with value: -0.17004887032491653.\n","[I 2023-11-27 20:50:52,806] Trial 99 finished with value: -0.17009256154091984 and parameters: {'n_estimators': 271, 'max_depth': 20, 'learning_rate': 0.06262793513006919, 'gamma': 0.16743129045441058, 'min_child_weight': 2, 'subsample': 0.49008910965685304, 'colsample_bytree': 0.9305754955600851, 'reg_alpha': 0.5486029779891642, 'reg_lambda': 2.115074362319993}. Best is trial 52 with value: -0.17004887032491653.\n"]}],"source":["sampler = optuna.samplers.TPESampler(seed=SEED)\n","study = optuna.create_study(direction='maximize', sampler=sampler)\n","study.optimize(xgb_objective, n_trials=100)"]},{"cell_type":"code","source":["# 결과 시각화\n","optuna.visualization.plot_optimization_history(study)\n","plt.show()"],"metadata":{"id":"IHL2Ube4gFia"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"jvfiliL5F9iV"},"source":["- -0.1704821289593484 -> -0.17046108602566407"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HpbzZ3MCF9iV","outputId":"0cdbeb17-a7f6-4d4d-e1bb-eb020e3ea7e7","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701118253318,"user_tz":-540,"elapsed":25,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'n_estimators': 286,\n"," 'max_depth': 40,\n"," 'learning_rate': 0.05817835503653145,\n"," 'gamma': 0.17959385912544268,\n"," 'min_child_weight': 2,\n"," 'subsample': 0.48893821123249237,\n"," 'colsample_bytree': 0.9156666255566892,\n"," 'reg_alpha': 0.17505361294106192,\n"," 'reg_lambda': 1.3021479578641277}"]},"metadata":{},"execution_count":224}],"source":["xgb_params = study.best_params\n","xgb_params"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XW3zS6NIQGhu","outputId":"45d0d828-3611-4c5e-c59e-ecaea2cca8b4","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701118257359,"user_tz":-540,"elapsed":4062,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([4.866451 , 4.3987417, 4.2865725, ..., 4.085699 , 3.571238 ,\n","       4.8007784], dtype=float32)"]},"metadata":{},"execution_count":225}],"source":["xgb_model = XGBRegressor(**xgb_params, random_state=SEED)\n","xgb_model.fit(train_x, target)\n","xgb_pred = xgb_model.predict(test_x)\n","xgb_pred = np.expm1(xgb_pred) # log 역 변환\n","xgb_pred"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fd6cfXtVF9iW","outputId":"8eabe84c-15af-44e8-c5c5-744cf1a9a6c7","colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1701118257360,"user_tz":-540,"elapsed":33,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                   ID      ECLO\n","0      ACCIDENT_39609  4.866451\n","1      ACCIDENT_39610  4.398742\n","2      ACCIDENT_39611  4.286572\n","3      ACCIDENT_39612  5.084240\n","4      ACCIDENT_39613  3.872896\n","...               ...       ...\n","10958  ACCIDENT_50567  4.866451\n","10959  ACCIDENT_50568  4.085699\n","10960  ACCIDENT_50569  4.085699\n","10961  ACCIDENT_50570  3.571238\n","10962  ACCIDENT_50571  4.800778\n","\n","[10963 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-f9355891-29d4-4d29-8e60-20478063ae89\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>ECLO</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ACCIDENT_39609</td>\n","      <td>4.866451</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ACCIDENT_39610</td>\n","      <td>4.398742</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ACCIDENT_39611</td>\n","      <td>4.286572</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ACCIDENT_39612</td>\n","      <td>5.084240</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ACCIDENT_39613</td>\n","      <td>3.872896</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>10958</th>\n","      <td>ACCIDENT_50567</td>\n","      <td>4.866451</td>\n","    </tr>\n","    <tr>\n","      <th>10959</th>\n","      <td>ACCIDENT_50568</td>\n","      <td>4.085699</td>\n","    </tr>\n","    <tr>\n","      <th>10960</th>\n","      <td>ACCIDENT_50569</td>\n","      <td>4.085699</td>\n","    </tr>\n","    <tr>\n","      <th>10961</th>\n","      <td>ACCIDENT_50570</td>\n","      <td>3.571238</td>\n","    </tr>\n","    <tr>\n","      <th>10962</th>\n","      <td>ACCIDENT_50571</td>\n","      <td>4.800778</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>10963 rows × 2 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f9355891-29d4-4d29-8e60-20478063ae89')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-f9355891-29d4-4d29-8e60-20478063ae89 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-f9355891-29d4-4d29-8e60-20478063ae89');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-df5b6aef-f62e-4b7c-ada9-7f081f9601cf\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-df5b6aef-f62e-4b7c-ada9-7f081f9601cf')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-df5b6aef-f62e-4b7c-ada9-7f081f9601cf button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":226}],"source":["xgb_sub = submission.copy()\n","xgb_sub['ECLO'] = xgb_pred\n","xgb_sub"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3C5rda6PF9iW"},"outputs":[],"source":["xgb_sub.to_csv(f\"{DATA_PATH}feature_exp_v10_1127_xgb.csv\", index=False)\n","xgb_sub.to_csv(\"feature_exp_v10_1127_xgb.csv\", index=False)"]},{"cell_type":"markdown","metadata":{"id":"AwS8FzSWF9iW"},"source":["## LGBM"]},{"cell_type":"code","source":["# from sklearn.preprocessing import StandardScaler\n","\n","# train_lgbm = train_x.copy()\n","# test_lgbm = test_x.copy()\n","\n","# # Assuming X is your feature matrix\n","# scaler = StandardScaler()\n","# train_lgbm = scaler.fit_transform(train_lgbm)\n","# test_lgbm = scaler.fit_transform(test_lgbm)\n"],"metadata":{"id":"uD4JYjqRrjoF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import re\n","train_x = train_x.rename(columns = lambda x:re.sub('[^가-힣A-Za-z0-9_]+', '', x))\n","test_x = test_x.rename(columns = lambda x:re.sub('[^가-힣A-Za-z0-9_]+', '', x))"],"metadata":{"id":"cF0AZ2Al24lc"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nVQpeIsnR1Od"},"outputs":[],"source":["def lgbm_objective(trial):\n","    params = {\n","        \"verbosity\": 1,\n","        'objective': 'regression',\n","        # 'boosting_type': 'gbdt',\n","        'eval_metric': 'rmsle',\n","        'n_estimators': trial.suggest_int('n_estimators', 10, 300),\n","        'num_leaves': trial.suggest_int('num_leaves', 2, 256),\n","        'max_depth': -1,\n","        'max_depth': trial.suggest_int('max_depth', 3, 50),\n","        'learning_rate': trial.suggest_float('learning_rate', 0.001, 0.1),\n","        'feature_fraction': trial.suggest_float('feature_fraction', 0.1, 1),\n","        'bagging_fraction': trial.suggest_float('bagging_fraction', 0.1, 1),\n","        'lambda_l1': trial.suggest_float('lambda_l1', 0, 10),\n","        'lambda_l2': trial.suggest_float('lambda_l2', 0, 10),\n","        'min_child_samples': trial.suggest_int('min_child_samples', 5, 100),\n","    }\n","\n","    cv = KFold(n_splits=5, shuffle=True, random_state=SEED)\n","    model = LGBMRegressor(**params, random_state=SEED)\n","    scores = cross_val_score(model, train_x, target, cv=cv, scoring=rmsle_score, n_jobs=-1)\n","\n","    return scores.mean()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7uAv6GnPR1M3","outputId":"eea8544f-7890-4c03-bb45-26b9ab10a64b","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701118465235,"user_tz":-540,"elapsed":207902,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"stream","name":"stderr","text":["[I 2023-11-27 20:50:57,125] A new study created in memory with name: no-name-af25fe86-7d8c-4264-8bdc-ba6e9dbb416c\n","[I 2023-11-27 20:51:02,119] Trial 0 finished with value: -0.17275281160831585 and parameters: {'n_estimators': 118, 'num_leaves': 244, 'max_depth': 38, 'learning_rate': 0.06026718993550663, 'feature_fraction': 0.24041677639819287, 'bagging_fraction': 0.2403950683025824, 'lambda_l1': 0.5808361216819946, 'lambda_l2': 8.661761457749352, 'min_child_samples': 62}. Best is trial 0 with value: -0.17275281160831585.\n","[I 2023-11-27 20:51:03,505] Trial 1 finished with value: -0.1708104102946329 and parameters: {'n_estimators': 216, 'num_leaves': 7, 'max_depth': 49, 'learning_rate': 0.08341182143924175, 'feature_fraction': 0.29110519961044856, 'bagging_fraction': 0.26364247048639056, 'lambda_l1': 1.8340450985343382, 'lambda_l2': 3.0424224295953772, 'min_child_samples': 55}. Best is trial 1 with value: -0.1708104102946329.\n","[I 2023-11-27 20:51:05,582] Trial 2 finished with value: -0.17115844655410095 and parameters: {'n_estimators': 135, 'num_leaves': 76, 'max_depth': 32, 'learning_rate': 0.01480989220455214, 'feature_fraction': 0.3629301836816964, 'bagging_fraction': 0.4297256589643226, 'lambda_l1': 4.56069984217036, 'lambda_l2': 7.851759613930136, 'min_child_samples': 24}. Best is trial 1 with value: -0.1708104102946329.\n","[I 2023-11-27 20:51:06,745] Trial 3 finished with value: -0.1708407777387721 and parameters: {'n_estimators': 159, 'num_leaves': 153, 'max_depth': 5, 'learning_rate': 0.0611469403382424, 'feature_fraction': 0.2534717113185624, 'bagging_fraction': 0.1585464336867516, 'lambda_l1': 9.488855372533333, 'lambda_l2': 9.656320330745594, 'min_child_samples': 82}. Best is trial 1 with value: -0.1708104102946329.\n","[I 2023-11-27 20:51:07,614] Trial 4 finished with value: -0.17093760558928284 and parameters: {'n_estimators': 98, 'num_leaves': 26, 'max_depth': 35, 'learning_rate': 0.04457509688022053, 'feature_fraction': 0.20983441136030095, 'bagging_fraction': 0.5456592191001431, 'lambda_l1': 0.34388521115218396, 'lambda_l2': 9.093204020787821, 'min_child_samples': 29}. Best is trial 1 with value: -0.1708104102946329.\n","[I 2023-11-27 20:51:09,944] Trial 5 finished with value: -0.17120099993054388 and parameters: {'n_estimators': 202, 'num_leaves': 81, 'max_depth': 27, 'learning_rate': 0.05512431765498469, 'feature_fraction': 0.26636900997297436, 'bagging_fraction': 0.9726261649881027, 'lambda_l1': 7.7513282336111455, 'lambda_l2': 9.394989415641891, 'min_child_samples': 90}. Best is trial 1 with value: -0.1708104102946329.\n","[I 2023-11-27 20:51:11,364] Trial 6 finished with value: -0.1715596584009997 and parameters: {'n_estimators': 183, 'num_leaves': 237, 'max_depth': 7, 'learning_rate': 0.020402303379495376, 'feature_fraction': 0.14070456001948428, 'bagging_fraction': 0.39279729768693794, 'lambda_l1': 3.8867728968948203, 'lambda_l2': 2.713490317738959, 'min_child_samples': 84}. Best is trial 1 with value: -0.1708104102946329.\n","[I 2023-11-27 20:51:13,406] Trial 7 finished with value: -0.1709607594197557 and parameters: {'n_estimators': 113, 'num_leaves': 73, 'max_depth': 29, 'learning_rate': 0.014951498272501501, 'feature_fraction': 0.8219772826786357, 'bagging_fraction': 0.16709557931179375, 'lambda_l1': 9.868869366005173, 'lambda_l2': 7.722447692966574, 'min_child_samples': 24}. Best is trial 1 with value: -0.1708104102946329.\n","[I 2023-11-27 20:51:13,941] Trial 8 finished with value: -0.17146184839876627 and parameters: {'n_estimators': 11, 'num_leaves': 209, 'max_depth': 36, 'learning_rate': 0.07317170963605775, 'feature_fraction': 0.7941433120173511, 'bagging_fraction': 0.16664018656068133, 'lambda_l1': 3.5846572854427263, 'lambda_l2': 1.1586905952512971, 'min_child_samples': 87}. Best is trial 1 with value: -0.1708104102946329.\n","[I 2023-11-27 20:51:16,288] Trial 9 finished with value: -0.17076468268268402 and parameters: {'n_estimators': 191, 'num_leaves': 86, 'max_depth': 6, 'learning_rate': 0.03178724984985056, 'feature_fraction': 0.3926649898240724, 'bagging_fraction': 0.7566455605042577, 'lambda_l1': 6.3755747135521315, 'lambda_l2': 8.872127425763265, 'min_child_samples': 50}. Best is trial 9 with value: -0.17076468268268402.\n","[I 2023-11-27 20:51:22,354] Trial 10 finished with value: -0.17171139028332205 and parameters: {'n_estimators': 288, 'num_leaves': 144, 'max_depth': 15, 'learning_rate': 0.035338238249255555, 'feature_fraction': 0.5315700785733828, 'bagging_fraction': 0.8017677672868958, 'lambda_l1': 6.54376522770753, 'lambda_l2': 6.18718032094214, 'min_child_samples': 40}. Best is trial 9 with value: -0.17076468268268402.\n","[I 2023-11-27 20:51:23,684] Trial 11 finished with value: -0.17095276731832915 and parameters: {'n_estimators': 255, 'num_leaves': 9, 'max_depth': 48, 'learning_rate': 0.09226703644116513, 'feature_fraction': 0.4556818673337887, 'bagging_fraction': 0.7570763678720782, 'lambda_l1': 2.4006658313865348, 'lambda_l2': 4.271123056333317, 'min_child_samples': 60}. Best is trial 9 with value: -0.17076468268268402.\n","[I 2023-11-27 20:51:26,005] Trial 12 finished with value: -0.17188634127818894 and parameters: {'n_estimators': 218, 'num_leaves': 42, 'max_depth': 17, 'learning_rate': 0.09986724172476433, 'feature_fraction': 0.4211978360543629, 'bagging_fraction': 0.6874130802024829, 'lambda_l1': 6.276429452559496, 'lambda_l2': 4.855203283611596, 'min_child_samples': 50}. Best is trial 9 with value: -0.17076468268268402.\n","[I 2023-11-27 20:51:30,556] Trial 13 finished with value: -0.17233077838569066 and parameters: {'n_estimators': 242, 'num_leaves': 89, 'max_depth': 50, 'learning_rate': 0.001677905494034293, 'feature_fraction': 0.6034663385009728, 'bagging_fraction': 0.32524188591369657, 'lambda_l1': 2.4155493298033957, 'lambda_l2': 6.311557130101908, 'min_child_samples': 70}. Best is trial 9 with value: -0.17076468268268402.\n","[I 2023-11-27 20:51:32,199] Trial 14 finished with value: -0.1712174335161968 and parameters: {'n_estimators': 55, 'num_leaves': 127, 'max_depth': 43, 'learning_rate': 0.07621086358472544, 'feature_fraction': 0.3553324039065185, 'bagging_fraction': 0.5237419510447737, 'lambda_l1': 5.587985830433144, 'lambda_l2': 3.5165968012445696, 'min_child_samples': 42}. Best is trial 9 with value: -0.17076468268268402.\n","[I 2023-11-27 20:51:35,201] Trial 15 finished with value: -0.17126905336527906 and parameters: {'n_estimators': 294, 'num_leaves': 51, 'max_depth': 20, 'learning_rate': 0.03802379286841686, 'feature_fraction': 0.1278132768542804, 'bagging_fraction': 0.6593577111377803, 'lambda_l1': 7.478927848927065, 'lambda_l2': 0.10065752312506149, 'min_child_samples': 67}. Best is trial 9 with value: -0.17076468268268402.\n","[I 2023-11-27 20:51:35,963] Trial 16 finished with value: -0.17074870869337164 and parameters: {'n_estimators': 166, 'num_leaves': 3, 'max_depth': 11, 'learning_rate': 0.08377120866291332, 'feature_fraction': 0.6062615713228072, 'bagging_fraction': 0.29136732663727677, 'lambda_l1': 5.100374359707484, 'lambda_l2': 5.87456765869775, 'min_child_samples': 6}. Best is trial 16 with value: -0.17074870869337164.\n","[I 2023-11-27 20:51:39,110] Trial 17 finished with value: -0.17229924717939216 and parameters: {'n_estimators': 168, 'num_leaves': 113, 'max_depth': 11, 'learning_rate': 0.06903786207668486, 'feature_fraction': 0.6570583939197836, 'bagging_fraction': 0.44216445374749963, 'lambda_l1': 5.067762568716669, 'lambda_l2': 6.4540440857590475, 'min_child_samples': 7}. Best is trial 16 with value: -0.17074870869337164.\n","[I 2023-11-27 20:51:41,138] Trial 18 finished with value: -0.1713312732447601 and parameters: {'n_estimators': 73, 'num_leaves': 179, 'max_depth': 22, 'learning_rate': 0.04746528050859601, 'feature_fraction': 0.6955140978210537, 'bagging_fraction': 0.6323659038961531, 'lambda_l1': 5.639746990214329, 'lambda_l2': 7.849402157108609, 'min_child_samples': 7}. Best is trial 16 with value: -0.17074870869337164.\n","[I 2023-11-27 20:51:42,117] Trial 19 finished with value: -0.17070096025207993 and parameters: {'n_estimators': 146, 'num_leaves': 109, 'max_depth': 3, 'learning_rate': 0.0859829080287011, 'feature_fraction': 0.9334545562592238, 'bagging_fraction': 0.8687795526816569, 'lambda_l1': 4.591887962885501, 'lambda_l2': 9.961512607612653, 'min_child_samples': 13}. Best is trial 19 with value: -0.17070096025207993.\n","[I 2023-11-27 20:51:43,077] Trial 20 finished with value: -0.17070012864698417 and parameters: {'n_estimators': 139, 'num_leaves': 195, 'max_depth': 3, 'learning_rate': 0.08752860306257126, 'feature_fraction': 0.9985315937632884, 'bagging_fraction': 0.9131580117017281, 'lambda_l1': 4.379590895993407, 'lambda_l2': 9.813130867582933, 'min_child_samples': 16}. Best is trial 20 with value: -0.17070012864698417.\n","[I 2023-11-27 20:51:44,035] Trial 21 finished with value: -0.17072048171656437 and parameters: {'n_estimators': 139, 'num_leaves': 181, 'max_depth': 3, 'learning_rate': 0.08587865889324764, 'feature_fraction': 0.9890955626016495, 'bagging_fraction': 0.9896557096398341, 'lambda_l1': 4.0585365273478, 'lambda_l2': 9.808052114288513, 'min_child_samples': 15}. Best is trial 20 with value: -0.17070012864698417.\n","[I 2023-11-27 20:51:48,747] Trial 22 finished with value: -0.17311781814811042 and parameters: {'n_estimators': 140, 'num_leaves': 184, 'max_depth': 10, 'learning_rate': 0.09901166215240564, 'feature_fraction': 0.9943012380420684, 'bagging_fraction': 0.9944401442613616, 'lambda_l1': 4.369728171027705, 'lambda_l2': 9.974698284809733, 'min_child_samples': 17}. Best is trial 20 with value: -0.17070012864698417.\n","[I 2023-11-27 20:51:49,745] Trial 23 finished with value: -0.17073925649836097 and parameters: {'n_estimators': 89, 'num_leaves': 179, 'max_depth': 4, 'learning_rate': 0.08788096936315032, 'feature_fraction': 0.9783339492401255, 'bagging_fraction': 0.8868286880476979, 'lambda_l1': 3.473403793046974, 'lambda_l2': 8.53080539076767, 'min_child_samples': 16}. Best is trial 20 with value: -0.17070012864698417.\n","[I 2023-11-27 20:51:50,642] Trial 24 finished with value: -0.17068357182100197 and parameters: {'n_estimators': 134, 'num_leaves': 213, 'max_depth': 3, 'learning_rate': 0.07590481584507693, 'feature_fraction': 0.9121554195760743, 'bagging_fraction': 0.9093026234362931, 'lambda_l1': 3.3942309781616578, 'lambda_l2': 9.968564121572934, 'min_child_samples': 34}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:51:52,233] Trial 25 finished with value: -0.17188529259148105 and parameters: {'n_estimators': 59, 'num_leaves': 222, 'max_depth': 14, 'learning_rate': 0.07660454427819469, 'feature_fraction': 0.9000415277786432, 'bagging_fraction': 0.8885117530818181, 'lambda_l1': 3.22916302043637, 'lambda_l2': 9.892495356414255, 'min_child_samples': 35}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:51:54,436] Trial 26 finished with value: -0.171922404744483 and parameters: {'n_estimators': 119, 'num_leaves': 209, 'max_depth': 9, 'learning_rate': 0.06462117151128387, 'feature_fraction': 0.909746279712807, 'bagging_fraction': 0.8685980168738896, 'lambda_l1': 2.9166642509274605, 'lambda_l2': 8.543158847046353, 'min_child_samples': 31}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:51:54,927] Trial 27 finished with value: -0.1709058100247442 and parameters: {'n_estimators': 32, 'num_leaves': 159, 'max_depth': 3, 'learning_rate': 0.07812425039605894, 'feature_fraction': 0.7738590451155009, 'bagging_fraction': 0.9242930896974336, 'lambda_l1': 4.612244899260029, 'lambda_l2': 7.217617136299327, 'min_child_samples': 21}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:51:57,141] Trial 28 finished with value: -0.17250407796766803 and parameters: {'n_estimators': 93, 'num_leaves': 110, 'max_depth': 22, 'learning_rate': 0.09279469772401702, 'feature_fraction': 0.8719102298576928, 'bagging_fraction': 0.8234169509227532, 'lambda_l1': 4.129109212612816, 'lambda_l2': 9.229418621577532, 'min_child_samples': 41}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:02,071] Trial 29 finished with value: -0.17410832843753585 and parameters: {'n_estimators': 122, 'num_leaves': 252, 'max_depth': 14, 'learning_rate': 0.06771957880865141, 'feature_fraction': 0.9276149056717466, 'bagging_fraction': 0.9306004540295832, 'lambda_l1': 1.5243824305270692, 'lambda_l2': 8.518718205835885, 'min_child_samples': 12}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:05,140] Trial 30 finished with value: -0.17196209741880067 and parameters: {'n_estimators': 148, 'num_leaves': 200, 'max_depth': 8, 'learning_rate': 0.05581409600161688, 'feature_fraction': 0.8391787033749836, 'bagging_fraction': 0.8382377311845013, 'lambda_l1': 1.0529668648548425, 'lambda_l2': 9.108594070170122, 'min_child_samples': 30}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:06,083] Trial 31 finished with value: -0.17069623492094485 and parameters: {'n_estimators': 130, 'num_leaves': 238, 'max_depth': 3, 'learning_rate': 0.08208657734435408, 'feature_fraction': 0.9592688067504131, 'bagging_fraction': 0.9984552275494029, 'lambda_l1': 3.998503937546308, 'lambda_l2': 9.824310905932322, 'min_child_samples': 15}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:06,907] Trial 32 finished with value: -0.17070281990717578 and parameters: {'n_estimators': 111, 'num_leaves': 236, 'max_depth': 3, 'learning_rate': 0.08072359901505052, 'feature_fraction': 0.9390548406863927, 'bagging_fraction': 0.939812691325166, 'lambda_l1': 2.880218318154831, 'lambda_l2': 9.864102640521105, 'min_child_samples': 20}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:09,504] Trial 33 finished with value: -0.17197321420105563 and parameters: {'n_estimators': 174, 'num_leaves': 255, 'max_depth': 7, 'learning_rate': 0.07109483520031246, 'feature_fraction': 0.8708551567203968, 'bagging_fraction': 0.9032334046961723, 'lambda_l1': 3.733909241098232, 'lambda_l2': 8.330608913668305, 'min_child_samples': 13}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:13,263] Trial 34 finished with value: -0.17305995929156492 and parameters: {'n_estimators': 153, 'num_leaves': 224, 'max_depth': 12, 'learning_rate': 0.08144741058851683, 'feature_fraction': 0.9480942310368117, 'bagging_fraction': 0.9927608188269235, 'lambda_l1': 4.576732578066347, 'lambda_l2': 9.197309261063634, 'min_child_samples': 26}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:15,235] Trial 35 finished with value: -0.17157338130108107 and parameters: {'n_estimators': 131, 'num_leaves': 160, 'max_depth': 6, 'learning_rate': 0.08977769760257827, 'feature_fraction': 0.9910951175650922, 'bagging_fraction': 0.854585969784962, 'lambda_l1': 2.1275181468438364, 'lambda_l2': 9.395773863591845, 'min_child_samples': 34}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:21,258] Trial 36 finished with value: -0.17306860946789165 and parameters: {'n_estimators': 207, 'num_leaves': 195, 'max_depth': 17, 'learning_rate': 0.0632517895800384, 'feature_fraction': 0.7549380083658668, 'bagging_fraction': 0.9527473071435093, 'lambda_l1': 3.0826487497342043, 'lambda_l2': 8.163558069156124, 'min_child_samples': 100}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:22,622] Trial 37 finished with value: -0.17141553337130494 and parameters: {'n_estimators': 106, 'num_leaves': 224, 'max_depth': 6, 'learning_rate': 0.08483420959742377, 'feature_fraction': 0.8819119646506998, 'bagging_fraction': 0.9275995122663871, 'lambda_l1': 0.0406923241891306, 'lambda_l2': 8.870394474572258, 'min_child_samples': 11}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:24,346] Trial 38 finished with value: -0.1715336448368203 and parameters: {'n_estimators': 86, 'num_leaves': 236, 'max_depth': 9, 'learning_rate': 0.07404057370053149, 'feature_fraction': 0.8372417442255901, 'bagging_fraction': 0.7855984033579342, 'lambda_l1': 3.8232001862899927, 'lambda_l2': 9.978957036939763, 'min_child_samples': 22}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:28,382] Trial 39 finished with value: -0.1734556232859212 and parameters: {'n_estimators': 156, 'num_leaves': 145, 'max_depth': 31, 'learning_rate': 0.09349155303970005, 'feature_fraction': 0.9434265892020064, 'bagging_fraction': 0.8536249620097331, 'lambda_l1': 4.680464365455185, 'lambda_l2': 9.507858019848921, 'min_child_samples': 26}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:29,790] Trial 40 finished with value: -0.1709765603475068 and parameters: {'n_estimators': 127, 'num_leaves': 103, 'max_depth': 5, 'learning_rate': 0.07874601544082734, 'feature_fraction': 0.8995545869308214, 'bagging_fraction': 0.9625665332916579, 'lambda_l1': 2.66701958705271, 'lambda_l2': 7.336623763224564, 'min_child_samples': 37}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:31,323] Trial 41 finished with value: -0.17075795499682245 and parameters: {'n_estimators': 113, 'num_leaves': 235, 'max_depth': 4, 'learning_rate': 0.08360980788319874, 'feature_fraction': 0.9625668646300808, 'bagging_fraction': 0.9337431463407502, 'lambda_l1': 3.1197921526340178, 'lambda_l2': 9.550917028543136, 'min_child_samples': 19}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:32,474] Trial 42 finished with value: -0.17070796756253062 and parameters: {'n_estimators': 102, 'num_leaves': 213, 'max_depth': 3, 'learning_rate': 0.08071519297835256, 'feature_fraction': 0.9293308397877043, 'bagging_fraction': 0.8977253112047219, 'lambda_l1': 1.8122273207896162, 'lambda_l2': 8.886329059348215, 'min_child_samples': 10}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:36,494] Trial 43 finished with value: -0.17272505277612482 and parameters: {'n_estimators': 191, 'num_leaves': 192, 'max_depth': 8, 'learning_rate': 0.07308962132994172, 'feature_fraction': 0.9541288706410114, 'bagging_fraction': 0.9619794493460183, 'lambda_l1': 3.3457979751469855, 'lambda_l2': 9.564106999431221, 'min_child_samples': 20}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:37,437] Trial 44 finished with value: -0.1706896693124909 and parameters: {'n_estimators': 138, 'num_leaves': 246, 'max_depth': 3, 'learning_rate': 0.08909476320240495, 'feature_fraction': 0.8183589857940053, 'bagging_fraction': 0.9998895561459238, 'lambda_l1': 4.001892068837518, 'lambda_l2': 8.900712163562728, 'min_child_samples': 25}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:40,003] Trial 45 finished with value: -0.17223974703336492 and parameters: {'n_estimators': 177, 'num_leaves': 246, 'max_depth': 7, 'learning_rate': 0.0888454976556403, 'feature_fraction': 0.8192623298281185, 'bagging_fraction': 0.8161562431341801, 'lambda_l1': 4.22932943481851, 'lambda_l2': 8.901264986097965, 'min_child_samples': 27}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:43,631] Trial 46 finished with value: -0.1735492236547814 and parameters: {'n_estimators': 142, 'num_leaves': 168, 'max_depth': 12, 'learning_rate': 0.09546884434168706, 'feature_fraction': 0.8560035197832216, 'bagging_fraction': 0.9895627964441595, 'lambda_l1': 3.8289667500176034, 'lambda_l2': 9.341532411439172, 'min_child_samples': 5}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:50,026] Trial 47 finished with value: -0.17383761274044643 and parameters: {'n_estimators': 159, 'num_leaves': 223, 'max_depth': 40, 'learning_rate': 0.08942764883716836, 'feature_fraction': 0.9952899831018345, 'bagging_fraction': 0.8922299271638463, 'lambda_l1': 3.601806147519986, 'lambda_l2': 7.950519406336013, 'min_child_samples': 45}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:51,619] Trial 48 finished with value: -0.171308082152057 and parameters: {'n_estimators': 128, 'num_leaves': 123, 'max_depth': 6, 'learning_rate': 0.09499311771451414, 'feature_fraction': 0.8996302846436526, 'bagging_fraction': 0.7664074249109218, 'lambda_l1': 4.999141814273973, 'lambda_l2': 8.754101871436927, 'min_child_samples': 57}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:53,356] Trial 49 finished with value: -0.17123024585670724 and parameters: {'n_estimators': 183, 'num_leaves': 66, 'max_depth': 5, 'learning_rate': 0.08675434622298281, 'feature_fraction': 0.8078417046820772, 'bagging_fraction': 0.8499780607238706, 'lambda_l1': 4.177255504189024, 'lambda_l2': 9.483630312796404, 'min_child_samples': 30}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:55,145] Trial 50 finished with value: -0.17217371550597083 and parameters: {'n_estimators': 70, 'num_leaves': 136, 'max_depth': 17, 'learning_rate': 0.0767155180921891, 'feature_fraction': 0.7512702950578435, 'bagging_fraction': 0.7168366976768368, 'lambda_l1': 2.5869572518291024, 'lambda_l2': 9.990615294442026, 'min_child_samples': 23}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:55,993] Trial 51 finished with value: -0.17069973017657505 and parameters: {'n_estimators': 114, 'num_leaves': 242, 'max_depth': 3, 'learning_rate': 0.08177836117312501, 'feature_fraction': 0.928738446236153, 'bagging_fraction': 0.9537062541419183, 'lambda_l1': 3.423706901481407, 'lambda_l2': 9.08244929485622, 'min_child_samples': 17}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:52:57,513] Trial 52 finished with value: -0.17104162918795876 and parameters: {'n_estimators': 146, 'num_leaves': 244, 'max_depth': 5, 'learning_rate': 0.08071119236404027, 'feature_fraction': 0.8572441867666116, 'bagging_fraction': 0.9644446176857684, 'lambda_l1': 3.4539825452228383, 'lambda_l2': 9.06800542218093, 'min_child_samples': 16}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:53:00,586] Trial 53 finished with value: -0.1726099025823968 and parameters: {'n_estimators': 134, 'num_leaves': 209, 'max_depth': 9, 'learning_rate': 0.08419316199937915, 'feature_fraction': 0.9257057337948859, 'bagging_fraction': 0.9974964750024002, 'lambda_l1': 3.9384706776997476, 'lambda_l2': 8.170903096753907, 'min_child_samples': 9}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:53:02,221] Trial 54 finished with value: -0.1707597906059471 and parameters: {'n_estimators': 166, 'num_leaves': 231, 'max_depth': 3, 'learning_rate': 0.09052543965548128, 'feature_fraction': 0.9666286876267466, 'bagging_fraction': 0.9118298115988372, 'lambda_l1': 4.84891791569863, 'lambda_l2': 9.601695247307317, 'min_child_samples': 14}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:53:04,348] Trial 55 finished with value: -0.17131070229955364 and parameters: {'n_estimators': 99, 'num_leaves': 245, 'max_depth': 7, 'learning_rate': 0.08642998576959146, 'feature_fraction': 0.8919048603981135, 'bagging_fraction': 0.8021887141702676, 'lambda_l1': 4.443853015287909, 'lambda_l2': 8.660623198685519, 'min_child_samples': 24}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:53:07,308] Trial 56 finished with value: -0.17252581665420047 and parameters: {'n_estimators': 118, 'num_leaves': 256, 'max_depth': 26, 'learning_rate': 0.09836843606137197, 'feature_fraction': 0.799261245967509, 'bagging_fraction': 0.8702674992963306, 'lambda_l1': 5.67077769852129, 'lambda_l2': 9.293359660820553, 'min_child_samples': 18}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:53:10,171] Trial 57 finished with value: -0.17242160475292498 and parameters: {'n_estimators': 136, 'num_leaves': 216, 'max_depth': 11, 'learning_rate': 0.07101244233251024, 'feature_fraction': 0.9972145552978277, 'bagging_fraction': 0.9529518516008761, 'lambda_l1': 3.395038148820223, 'lambda_l2': 9.03762083554651, 'min_child_samples': 75}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:53:12,030] Trial 58 finished with value: -0.17177820508662486 and parameters: {'n_estimators': 79, 'num_leaves': 96, 'max_depth': 47, 'learning_rate': 0.07554407980302272, 'feature_fraction': 0.9179535432298593, 'bagging_fraction': 0.9145256427535237, 'lambda_l1': 4.314652980667872, 'lambda_l2': 9.654635307738182, 'min_child_samples': 45}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:53:13,690] Trial 59 finished with value: -0.17116431124669057 and parameters: {'n_estimators': 155, 'num_leaves': 201, 'max_depth': 5, 'learning_rate': 0.09134860193579276, 'feature_fraction': 0.958840373003026, 'bagging_fraction': 0.8772915976622409, 'lambda_l1': 5.223211441382221, 'lambda_l2': 8.389093054419012, 'min_child_samples': 34}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:53:20,918] Trial 60 finished with value: -0.17485316605827989 and parameters: {'n_estimators': 192, 'num_leaves': 244, 'max_depth': 13, 'learning_rate': 0.09581280686933134, 'feature_fraction': 0.8512989333775807, 'bagging_fraction': 0.9980863774509947, 'lambda_l1': 2.7961953173773777, 'lambda_l2': 7.552697301051595, 'min_child_samples': 9}. Best is trial 24 with value: -0.17068357182100197.\n","[I 2023-11-27 20:53:21,727] Trial 61 finished with value: -0.17066318624878368 and parameters: {'n_estimators': 108, 'num_leaves': 230, 'max_depth': 3, 'learning_rate': 0.08110458407968237, 'feature_fraction': 0.937266838637394, 'bagging_fraction': 0.9385224183533587, 'lambda_l1': 2.999095686791767, 'lambda_l2': 9.929328904517392, 'min_child_samples': 19}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:22,797] Trial 62 finished with value: -0.17076595462034636 and parameters: {'n_estimators': 122, 'num_leaves': 229, 'max_depth': 4, 'learning_rate': 0.08329276068940025, 'feature_fraction': 0.8892089814001762, 'bagging_fraction': 0.9538824896370134, 'lambda_l1': 3.7609245938703793, 'lambda_l2': 9.955435974300297, 'min_child_samples': 14}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:23,643] Trial 63 finished with value: -0.1707143076308721 and parameters: {'n_estimators': 108, 'num_leaves': 218, 'max_depth': 3, 'learning_rate': 0.0787007016733163, 'feature_fraction': 0.9670081679808852, 'bagging_fraction': 0.9179804447428997, 'lambda_l1': 3.1777794378420854, 'lambda_l2': 9.709332402965009, 'min_child_samples': 18}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:26,090] Trial 64 finished with value: -0.17225304015171705 and parameters: {'n_estimators': 143, 'num_leaves': 203, 'max_depth': 8, 'learning_rate': 0.08758347178214029, 'feature_fraction': 0.9309727906369046, 'bagging_fraction': 0.832375088111844, 'lambda_l1': 4.04122061448688, 'lambda_l2': 9.208814430735686, 'min_child_samples': 27}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:29,746] Trial 65 finished with value: -0.17366955968995174 and parameters: {'n_estimators': 164, 'num_leaves': 242, 'max_depth': 10, 'learning_rate': 0.09179190491609103, 'feature_fraction': 0.8731221198278578, 'bagging_fraction': 0.9743081736798272, 'lambda_l1': 2.96560479010344, 'lambda_l2': 8.68536237828268, 'min_child_samples': 21}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:31,719] Trial 66 finished with value: -0.17103276064589812 and parameters: {'n_estimators': 129, 'num_leaves': 229, 'max_depth': 5, 'learning_rate': 0.08258753552260702, 'feature_fraction': 0.9136215692745558, 'bagging_fraction': 0.8736012785713707, 'lambda_l1': 2.461904858572103, 'lambda_l2': 9.649534094600693, 'min_child_samples': 16}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:33,969] Trial 67 finished with value: -0.17129848382785776 and parameters: {'n_estimators': 92, 'num_leaves': 208, 'max_depth': 7, 'learning_rate': 0.07924970177504269, 'feature_fraction': 0.9774852157200592, 'bagging_fraction': 0.9439710193235418, 'lambda_l1': 3.5797479677965036, 'lambda_l2': 9.244113624379546, 'min_child_samples': 12}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:35,010] Trial 68 finished with value: -0.170702346187592 and parameters: {'n_estimators': 149, 'num_leaves': 252, 'max_depth': 3, 'learning_rate': 0.08633179179646845, 'feature_fraction': 0.8309726791104941, 'bagging_fraction': 0.9014416064918367, 'lambda_l1': 4.431807093337034, 'lambda_l2': 8.984934319576931, 'min_child_samples': 24}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:37,264] Trial 69 finished with value: -0.1720195538157361 and parameters: {'n_estimators': 116, 'num_leaves': 116, 'max_depth': 9, 'learning_rate': 0.06636314688014681, 'feature_fraction': 0.998429706585582, 'bagging_fraction': 0.9733512122448339, 'lambda_l1': 2.2655497874512536, 'lambda_l2': 9.719285852560336, 'min_child_samples': 32}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:40,048] Trial 70 finished with value: -0.17157416224776073 and parameters: {'n_estimators': 266, 'num_leaves': 191, 'max_depth': 5, 'learning_rate': 0.07351473036209494, 'feature_fraction': 0.9418236387042226, 'bagging_fraction': 0.9319853752374021, 'lambda_l1': 3.9925589683092215, 'lambda_l2': 8.527249481888367, 'min_child_samples': 7}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:41,083] Trial 71 finished with value: -0.17071162054882127 and parameters: {'n_estimators': 149, 'num_leaves': 250, 'max_depth': 3, 'learning_rate': 0.0855430989547556, 'feature_fraction': 0.8305877498185836, 'bagging_fraction': 0.9086426996114811, 'lambda_l1': 4.584373138723844, 'lambda_l2': 9.089328960539538, 'min_child_samples': 25}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:42,243] Trial 72 finished with value: -0.1708200429913328 and parameters: {'n_estimators': 140, 'num_leaves': 238, 'max_depth': 4, 'learning_rate': 0.08806466037536904, 'feature_fraction': 0.8747808958069629, 'bagging_fraction': 0.8941160216395608, 'lambda_l1': 4.3355357995373405, 'lambda_l2': 9.971338227154359, 'min_child_samples': 28}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:43,684] Trial 73 finished with value: -0.17105433804470488 and parameters: {'n_estimators': 106, 'num_leaves': 250, 'max_depth': 6, 'learning_rate': 0.0822867684126255, 'feature_fraction': 0.9660110049064506, 'bagging_fraction': 0.8499885865721993, 'lambda_l1': 4.855572785817898, 'lambda_l2': 9.365277117521662, 'min_child_samples': 38}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:44,621] Trial 74 finished with value: -0.17068894609396473 and parameters: {'n_estimators': 123, 'num_leaves': 230, 'max_depth': 3, 'learning_rate': 0.07580238434803455, 'feature_fraction': 0.911940934142661, 'bagging_fraction': 0.9747241050986496, 'lambda_l1': 3.2153464692239755, 'lambda_l2': 8.911733432290067, 'min_child_samples': 23}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:47,279] Trial 75 finished with value: -0.17161163341758864 and parameters: {'n_estimators': 123, 'num_leaves': 230, 'max_depth': 7, 'learning_rate': 0.07668780445782009, 'feature_fraction': 0.9121059173719023, 'bagging_fraction': 0.9767198692544747, 'lambda_l1': 3.1613191406022993, 'lambda_l2': 8.173124126179932, 'min_child_samples': 22}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:51,013] Trial 76 finished with value: -0.1727028913237152 and parameters: {'n_estimators': 84, 'num_leaves': 221, 'max_depth': 35, 'learning_rate': 0.07041600589334603, 'feature_fraction': 0.947447858046386, 'bagging_fraction': 0.9428056346042091, 'lambda_l1': 3.642721885306216, 'lambda_l2': 9.722635219394489, 'min_child_samples': 18}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:51,920] Trial 77 finished with value: -0.17067486618491778 and parameters: {'n_estimators': 95, 'num_leaves': 215, 'max_depth': 4, 'learning_rate': 0.0681494833139615, 'feature_fraction': 0.9017960507769449, 'bagging_fraction': 0.9982242397848555, 'lambda_l1': 2.7218381763219304, 'lambda_l2': 8.75485142029687, 'min_child_samples': 13}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:52,618] Trial 78 finished with value: -0.17070936841010964 and parameters: {'n_estimators': 60, 'num_leaves': 213, 'max_depth': 4, 'learning_rate': 0.07531407558460138, 'feature_fraction': 0.8933113948427882, 'bagging_fraction': 0.974649401513384, 'lambda_l1': 3.330077345528454, 'lambda_l2': 8.776555790317278, 'min_child_samples': 10}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:54,907] Trial 79 finished with value: -0.1721551885254923 and parameters: {'n_estimators': 100, 'num_leaves': 237, 'max_depth': 10, 'learning_rate': 0.06770930752506564, 'feature_fraction': 0.911907089505947, 'bagging_fraction': 0.9345274828590562, 'lambda_l1': 2.7900566128796207, 'lambda_l2': 9.44856229696394, 'min_child_samples': 15}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:55,951] Trial 80 finished with value: -0.17081496385079414 and parameters: {'n_estimators': 74, 'num_leaves': 188, 'max_depth': 6, 'learning_rate': 0.059746499134435804, 'feature_fraction': 0.8626456815342702, 'bagging_fraction': 0.9906430931938467, 'lambda_l1': 2.1426745099005493, 'lambda_l2': 8.432641446619519, 'min_child_samples': 32}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:56,902] Trial 81 finished with value: -0.17071857560417086 and parameters: {'n_estimators': 134, 'num_leaves': 175, 'max_depth': 3, 'learning_rate': 0.07966053623316281, 'feature_fraction': 0.9385340527691488, 'bagging_fraction': 0.9633108737707409, 'lambda_l1': 3.023453308941527, 'lambda_l2': 9.438523529240179, 'min_child_samples': 13}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:53:58,192] Trial 82 finished with value: -0.17089588648906343 and parameters: {'n_estimators': 115, 'num_leaves': 228, 'max_depth': 5, 'learning_rate': 0.07201539144748266, 'feature_fraction': 0.9813262942318192, 'bagging_fraction': 0.9988432329573254, 'lambda_l1': 2.6718783292969257, 'lambda_l2': 9.77844121228896, 'min_child_samples': 17}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:00,053] Trial 83 finished with value: -0.17148030301741543 and parameters: {'n_estimators': 95, 'num_leaves': 197, 'max_depth': 8, 'learning_rate': 0.07763388657838453, 'feature_fraction': 0.8825784437990517, 'bagging_fraction': 0.9258351315136031, 'lambda_l1': 3.834691026219474, 'lambda_l2': 8.921472950586862, 'min_child_samples': 19}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:01,631] Trial 84 finished with value: -0.17078347035935193 and parameters: {'n_estimators': 127, 'num_leaves': 207, 'max_depth': 4, 'learning_rate': 0.08224291214397823, 'feature_fraction': 0.9194508795477818, 'bagging_fraction': 0.9519548238508068, 'lambda_l1': 3.4331241129616497, 'lambda_l2': 9.22826520690666, 'min_child_samples': 7}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:03,029] Trial 85 finished with value: -0.1707195762816026 and parameters: {'n_estimators': 107, 'num_leaves': 237, 'max_depth': 4, 'learning_rate': 0.07448771904645692, 'feature_fraction': 0.9691237083077168, 'bagging_fraction': 0.8816946099325236, 'lambda_l1': 4.142122274429424, 'lambda_l2': 8.739556637970852, 'min_child_samples': 21}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:04,880] Trial 86 finished with value: -0.17113837683168046 and parameters: {'n_estimators': 160, 'num_leaves': 19, 'max_depth': 6, 'learning_rate': 0.08438818862187455, 'feature_fraction': 0.9481858520636111, 'bagging_fraction': 0.9158377039429937, 'lambda_l1': 2.436164867790663, 'lambda_l2': 9.964723562727931, 'min_child_samples': 12}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:07,792] Trial 87 finished with value: -0.17271815528671758 and parameters: {'n_estimators': 172, 'num_leaves': 217, 'max_depth': 8, 'learning_rate': 0.08920634708486501, 'feature_fraction': 0.9017481003933282, 'bagging_fraction': 0.9693798329273908, 'lambda_l1': 3.6434196309295404, 'lambda_l2': 9.442769134514569, 'min_child_samples': 29}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:08,621] Trial 88 finished with value: -0.17066649546914592 and parameters: {'n_estimators': 113, 'num_leaves': 226, 'max_depth': 3, 'learning_rate': 0.08081977047610782, 'feature_fraction': 0.8514317525898982, 'bagging_fraction': 0.8602630862328847, 'lambda_l1': 3.1616489817138698, 'lambda_l2': 9.07641507013006, 'min_child_samples': 9}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:09,255] Trial 89 finished with value: -0.1707148847275602 and parameters: {'n_estimators': 48, 'num_leaves': 225, 'max_depth': 4, 'learning_rate': 0.08012867793858892, 'feature_fraction': 0.8447022571164724, 'bagging_fraction': 0.9806411905877306, 'lambda_l1': 3.004472037303647, 'lambda_l2': 9.032723894112992, 'min_child_samples': 5}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:10,369] Trial 90 finished with value: -0.17087485014751996 and parameters: {'n_estimators': 86, 'num_leaves': 232, 'max_depth': 6, 'learning_rate': 0.07041389096192036, 'feature_fraction': 0.8086295621067577, 'bagging_fraction': 0.9378596992814939, 'lambda_l1': 3.299818978029209, 'lambda_l2': 7.79069343523183, 'min_child_samples': 9}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:11,206] Trial 91 finished with value: -0.1706769788950642 and parameters: {'n_estimators': 112, 'num_leaves': 241, 'max_depth': 3, 'learning_rate': 0.07826789873077773, 'feature_fraction': 0.9343825160957341, 'bagging_fraction': 0.8661664521517526, 'lambda_l1': 2.8098234904057393, 'lambda_l2': 9.752386727609887, 'min_child_samples': 15}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:12,029] Trial 92 finished with value: -0.1706789675518025 and parameters: {'n_estimators': 112, 'num_leaves': 241, 'max_depth': 3, 'learning_rate': 0.07778091824098718, 'feature_fraction': 0.8799003984399157, 'bagging_fraction': 0.8954578879616221, 'lambda_l1': 2.7175277958944637, 'lambda_l2': 9.599484516954545, 'min_child_samples': 23}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:12,814] Trial 93 finished with value: -0.17067988855415256 and parameters: {'n_estimators': 101, 'num_leaves': 240, 'max_depth': 3, 'learning_rate': 0.07753828576468844, 'feature_fraction': 0.8631255524960546, 'bagging_fraction': 0.8276063449878894, 'lambda_l1': 2.498756305185471, 'lambda_l2': 9.582069494149623, 'min_child_samples': 24}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:14,189] Trial 94 finished with value: -0.17122390940473953 and parameters: {'n_estimators': 96, 'num_leaves': 256, 'max_depth': 7, 'learning_rate': 0.07724342300664397, 'feature_fraction': 0.7881047588189548, 'bagging_fraction': 0.8192388201967559, 'lambda_l1': 2.6690010826751958, 'lambda_l2': 9.625557237039672, 'min_child_samples': 23}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:15,806] Trial 95 finished with value: -0.17086624860046143 and parameters: {'n_estimators': 103, 'num_leaves': 239, 'max_depth': 5, 'learning_rate': 0.07513204056527421, 'feature_fraction': 0.8582204320428235, 'bagging_fraction': 0.8601422137430047, 'lambda_l1': 1.864935819020736, 'lambda_l2': 9.287215400479365, 'min_child_samples': 26}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:21,064] Trial 96 finished with value: -0.17359969588147933 and parameters: {'n_estimators': 121, 'num_leaves': 246, 'max_depth': 19, 'learning_rate': 0.07375271914437757, 'feature_fraction': 0.8205655851679587, 'bagging_fraction': 0.8358588397188539, 'lambda_l1': 2.782399108844085, 'lambda_l2': 9.805920698957266, 'min_child_samples': 20}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:22,080] Trial 97 finished with value: -0.17076268713161918 and parameters: {'n_estimators': 112, 'num_leaves': 220, 'max_depth': 4, 'learning_rate': 0.0725425000079227, 'feature_fraction': 0.8869347412132977, 'bagging_fraction': 0.8905566490974531, 'lambda_l1': 2.3478356723234386, 'lambda_l2': 8.615799811480922, 'min_child_samples': 15}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:24,194] Trial 98 finished with value: -0.17221656484649303 and parameters: {'n_estimators': 67, 'num_leaves': 250, 'max_depth': 26, 'learning_rate': 0.07787633830375952, 'feature_fraction': 0.8471021773712324, 'bagging_fraction': 0.7940942009921883, 'lambda_l1': 3.1946653035812225, 'lambda_l2': 8.835004979559223, 'min_child_samples': 63}. Best is trial 61 with value: -0.17066318624878368.\n","[I 2023-11-27 20:54:24,908] Trial 99 finished with value: -0.1707007059116944 and parameters: {'n_estimators': 80, 'num_leaves': 212, 'max_depth': 3, 'learning_rate': 0.06819529408177084, 'feature_fraction': 0.870609113963975, 'bagging_fraction': 0.8823867135649366, 'lambda_l1': 2.5361863652866257, 'lambda_l2': 9.526018201881344, 'min_child_samples': 23}. Best is trial 61 with value: -0.17066318624878368.\n"]}],"source":["sampler = optuna.samplers.TPESampler(seed=SEED)\n","study = optuna.create_study(direction='maximize', sampler=sampler)\n","study.optimize(lgbm_objective, n_trials=100)"]},{"cell_type":"code","source":["optuna.visualization.plot_optimization_history(study)\n","plt.show()"],"metadata":{"id":"FTiswagihB6x"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"encGGUCaF9iX"},"source":["- -0.17093993543240787 -> -0.17092023294612774\n","- lgbm2 : -0.17095695720697088.\n","- lgbm3 : -0.170918"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Rt9j6qKkF9iX","outputId":"7b8355bc-20dc-40aa-aa11-11fadb52aeca","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701118465236,"user_tz":-540,"elapsed":27,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'n_estimators': 108,\n"," 'num_leaves': 230,\n"," 'max_depth': 3,\n"," 'learning_rate': 0.08110458407968237,\n"," 'feature_fraction': 0.937266838637394,\n"," 'bagging_fraction': 0.9385224183533587,\n"," 'lambda_l1': 2.999095686791767,\n"," 'lambda_l2': 9.929328904517392,\n"," 'min_child_samples': 19}"]},"metadata":{},"execution_count":233}],"source":["lgbm_params = study.best_params\n","lgbm_params\n","\n","# {'n_estimators': 400,\n","#  'num_leaves': 228,\n","#  'max_depth': 4,\n","#  'learning_rate': 0.028664536809354962,\n","#  'feature_fraction': 0.23833065775252044,\n","#  'bagging_fraction': 0.34041608907370446,\n","#  'lambda_l1': 7.8190498778346145,\n","#  'lambda_l2': 9.740759614083519,\n","#  'min_child_samples': 26}"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"x6RmpswoF9iY","outputId":"7b5c3a76-267f-4bc0-edca-82a063813b30","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701118465754,"user_tz":-540,"elapsed":542,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["[LightGBM] [Warning] feature_fraction is set=0.937266838637394, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.937266838637394\n","[LightGBM] [Warning] lambda_l2 is set=9.929328904517392, reg_lambda=0.0 will be ignored. Current value: lambda_l2=9.929328904517392\n","[LightGBM] [Warning] lambda_l1 is set=2.999095686791767, reg_alpha=0.0 will be ignored. Current value: lambda_l1=2.999095686791767\n","[LightGBM] [Warning] bagging_fraction is set=0.9385224183533587, subsample=1.0 will be ignored. Current value: bagging_fraction=0.9385224183533587\n","[LightGBM] [Warning] feature_fraction is set=0.937266838637394, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.937266838637394\n","[LightGBM] [Warning] lambda_l2 is set=9.929328904517392, reg_lambda=0.0 will be ignored. Current value: lambda_l2=9.929328904517392\n","[LightGBM] [Warning] lambda_l1 is set=2.999095686791767, reg_alpha=0.0 will be ignored. Current value: lambda_l1=2.999095686791767\n","[LightGBM] [Warning] bagging_fraction is set=0.9385224183533587, subsample=1.0 will be ignored. Current value: bagging_fraction=0.9385224183533587\n","[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.002726 seconds.\n","You can set `force_col_wise=true` to remove the overhead.\n","[LightGBM] [Info] Total Bins 2016\n","[LightGBM] [Info] Number of data points in the train set: 39609, number of used features: 8\n","[LightGBM] [Info] Start training from score 1.633697\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n","[LightGBM] [Warning] feature_fraction is set=0.937266838637394, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.937266838637394\n","[LightGBM] [Warning] lambda_l2 is set=9.929328904517392, reg_lambda=0.0 will be ignored. Current value: lambda_l2=9.929328904517392\n","[LightGBM] [Warning] lambda_l1 is set=2.999095686791767, reg_alpha=0.0 will be ignored. Current value: lambda_l1=2.999095686791767\n","[LightGBM] [Warning] bagging_fraction is set=0.9385224183533587, subsample=1.0 will be ignored. Current value: bagging_fraction=0.9385224183533587\n"]},{"output_type":"execute_result","data":{"text/plain":["array([4.04232398, 3.54195685, 5.09191802, ..., 4.45766269, 4.51319225,\n","       4.54422973])"]},"metadata":{},"execution_count":234}],"source":["lgbm_model = LGBMRegressor(**lgbm_params, random_state=SEED)\n","lgbm_model.fit(train_x, target)\n","lgbm_pred = lgbm_model.predict(test_x)\n","lgbm_pred = np.expm1(lgbm_pred) # log 역 변환\n","lgbm_pred"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AEN-MwePF9iY","outputId":"eefa6ed8-6589-4d8e-847f-046e4cb5b021","colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1701118465755,"user_tz":-540,"elapsed":12,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                   ID      ECLO\n","0      ACCIDENT_39609  4.042324\n","1      ACCIDENT_39610  3.541957\n","2      ACCIDENT_39611  5.091918\n","3      ACCIDENT_39612  4.969166\n","4      ACCIDENT_39613  4.657457\n","...               ...       ...\n","10958  ACCIDENT_50567  4.042324\n","10959  ACCIDENT_50568  4.457663\n","10960  ACCIDENT_50569  4.457663\n","10961  ACCIDENT_50570  4.513192\n","10962  ACCIDENT_50571  4.544230\n","\n","[10963 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-84005271-caf1-457d-a693-65b6f137a0c2\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>ECLO</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ACCIDENT_39609</td>\n","      <td>4.042324</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ACCIDENT_39610</td>\n","      <td>3.541957</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ACCIDENT_39611</td>\n","      <td>5.091918</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ACCIDENT_39612</td>\n","      <td>4.969166</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ACCIDENT_39613</td>\n","      <td>4.657457</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>10958</th>\n","      <td>ACCIDENT_50567</td>\n","      <td>4.042324</td>\n","    </tr>\n","    <tr>\n","      <th>10959</th>\n","      <td>ACCIDENT_50568</td>\n","      <td>4.457663</td>\n","    </tr>\n","    <tr>\n","      <th>10960</th>\n","      <td>ACCIDENT_50569</td>\n","      <td>4.457663</td>\n","    </tr>\n","    <tr>\n","      <th>10961</th>\n","      <td>ACCIDENT_50570</td>\n","      <td>4.513192</td>\n","    </tr>\n","    <tr>\n","      <th>10962</th>\n","      <td>ACCIDENT_50571</td>\n","      <td>4.544230</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>10963 rows × 2 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-84005271-caf1-457d-a693-65b6f137a0c2')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-84005271-caf1-457d-a693-65b6f137a0c2 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-84005271-caf1-457d-a693-65b6f137a0c2');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-15e451a7-96fa-4476-9d5a-4faf862c91b7\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-15e451a7-96fa-4476-9d5a-4faf862c91b7')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-15e451a7-96fa-4476-9d5a-4faf862c91b7 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":235}],"source":["lgbm_sub = submission.copy()\n","lgbm_sub['ECLO'] = lgbm_pred\n","lgbm_sub"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"76A8qqJ_F9iZ"},"outputs":[],"source":["lgbm_sub.to_csv(f\"{DATA_PATH}feature_exp_v10_1127_lgbm.csv\", index=False)\n","lgbm_sub.to_csv(\"feature_exp_v10_1127_lgbm.csv\", index=False)"]},{"cell_type":"markdown","metadata":{"id":"M5TNU-_QF9iZ"},"source":["## CAT"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AW2_Og93F9iZ","outputId":"841771e5-2a7e-4218-f707-8ed73d5acf3c","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701118469985,"user_tz":-540,"elapsed":4239,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: catboost in /usr/local/lib/python3.10/dist-packages (1.2.2)\n","Requirement already satisfied: graphviz in /usr/local/lib/python3.10/dist-packages (from catboost) (0.20.1)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (from catboost) (3.7.1)\n","Requirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.10/dist-packages (from catboost) (1.23.5)\n","Requirement already satisfied: pandas>=0.24 in /usr/local/lib/python3.10/dist-packages (from catboost) (1.5.3)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from catboost) (1.11.3)\n","Requirement already satisfied: plotly in /usr/local/lib/python3.10/dist-packages (from catboost) (5.15.0)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from catboost) (1.16.0)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=0.24->catboost) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=0.24->catboost) (2023.3.post1)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib->catboost) (1.2.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib->catboost) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib->catboost) (4.44.3)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib->catboost) (1.4.5)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib->catboost) (23.2)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib->catboost) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib->catboost) (3.1.1)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from plotly->catboost) (8.2.3)\n"]}],"source":["!pip install catboost\n","from catboost import CatBoostRegressor"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qQ340MmUF9ia"},"outputs":[],"source":["# CatBoostRegressor\n","def cat_objective(trial):\n","    params = {\n","        'n_estimators': trial.suggest_int('n_estimators', 10, 300),\n","        'depth': trial.suggest_int('depth', 1, 16), # 최대 16\n","        'learning_rate': trial.suggest_float('learning_rate', 0.001, 0.1),\n","        'l2_leaf_reg': trial.suggest_float('l2_leaf_reg', 0, 10)\n","    }\n","\n","    cv = KFold(n_splits=5, shuffle=True, random_state=SEED)\n","    model = CatBoostRegressor(**params, random_state=SEED)\n","    scores = cross_val_score(model, train_x, target, cv=cv, scoring=rmsle_score, n_jobs=-1)\n","\n","    return scores.mean()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-LAqKR9CF9ia","outputId":"0f00081b-6755-445e-dba6-feb44386650c","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701123428349,"user_tz":-540,"elapsed":4958372,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}}},"outputs":[{"output_type":"stream","name":"stderr","text":["[I 2023-11-27 20:54:29,474] A new study created in memory with name: no-name-681da48d-290d-4853-9ab6-977f2444aea4\n","[I 2023-11-27 21:13:17,077] Trial 0 finished with value: -0.1754537251442807 and parameters: {'n_estimators': 118, 'depth': 16, 'learning_rate': 0.07346740023932911, 'l2_leaf_reg': 5.986584841970366}. Best is trial 0 with value: -0.1754537251442807.\n","[I 2023-11-27 21:13:18,179] Trial 1 finished with value: -0.1728284076321731 and parameters: {'n_estimators': 55, 'depth': 3, 'learning_rate': 0.006750277604651747, 'l2_leaf_reg': 8.661761457749352}. Best is trial 1 with value: -0.1728284076321731.\n","[I 2023-11-27 21:14:30,782] Trial 2 finished with value: -0.17221756535482627 and parameters: {'n_estimators': 184, 'depth': 12, 'learning_rate': 0.0030378649352844423, 'l2_leaf_reg': 9.699098521619943}. Best is trial 2 with value: -0.17221756535482627.\n","[I 2023-11-27 21:14:35,310] Trial 3 finished with value: -0.1708140803281925 and parameters: {'n_estimators': 252, 'depth': 4, 'learning_rate': 0.01900067175350296, 'l2_leaf_reg': 1.8340450985343382}. Best is trial 3 with value: -0.1708140803281925.\n","[I 2023-11-27 21:14:44,108] Trial 4 finished with value: -0.17096889617477298 and parameters: {'n_estimators': 98, 'depth': 9, 'learning_rate': 0.04376255684556946, 'l2_leaf_reg': 2.9122914019804194}. Best is trial 3 with value: -0.1708140803281925.\n","[I 2023-11-27 21:14:47,022] Trial 5 finished with value: -0.17086123271499282 and parameters: {'n_estimators': 188, 'depth': 3, 'learning_rate': 0.0299223202049866, 'l2_leaf_reg': 3.663618432936917}. Best is trial 3 with value: -0.1708140803281925.\n","[I 2023-11-27 21:16:38,327] Trial 6 finished with value: -0.17167565762934123 and parameters: {'n_estimators': 142, 'depth': 13, 'learning_rate': 0.020767704433677616, 'l2_leaf_reg': 5.142344384136116}. Best is trial 3 with value: -0.1708140803281925.\n","[I 2023-11-27 21:16:41,438] Trial 7 finished with value: -0.17110114656001524 and parameters: {'n_estimators': 182, 'depth': 1, 'learning_rate': 0.0611469403382424, 'l2_leaf_reg': 1.7052412368729153}. Best is trial 3 with value: -0.1708140803281925.\n","[I 2023-11-27 21:20:59,990] Trial 8 finished with value: -0.17225649261329687 and parameters: {'n_estimators': 28, 'depth': 16, 'learning_rate': 0.09659757127438139, 'l2_leaf_reg': 8.08397348116461}. Best is trial 3 with value: -0.1708140803281925.\n","[I 2023-11-27 21:21:01,504] Trial 9 finished with value: -0.17097184984154756 and parameters: {'n_estimators': 98, 'depth': 2, 'learning_rate': 0.06873906962470354, 'l2_leaf_reg': 4.4015249373960135}. Best is trial 3 with value: -0.1708140803281925.\n","[I 2023-11-27 21:21:09,066] Trial 10 finished with value: -0.1708382861155335 and parameters: {'n_estimators': 285, 'depth': 6, 'learning_rate': 0.03750414849938863, 'l2_leaf_reg': 0.17961875614819434}. Best is trial 3 with value: -0.1708140803281925.\n","[I 2023-11-27 21:21:18,832] Trial 11 finished with value: -0.17084094851874404 and parameters: {'n_estimators': 295, 'depth': 6, 'learning_rate': 0.03701113245999206, 'l2_leaf_reg': 0.12077278502227573}. Best is trial 3 with value: -0.1708140803281925.\n","[I 2023-11-27 21:21:28,279] Trial 12 finished with value: -0.17071678174953417 and parameters: {'n_estimators': 291, 'depth': 6, 'learning_rate': 0.022189005195590535, 'l2_leaf_reg': 0.09548061550696853}. Best is trial 12 with value: -0.17071678174953417.\n","[I 2023-11-27 21:21:34,822] Trial 13 finished with value: -0.17071661220109824 and parameters: {'n_estimators': 242, 'depth': 6, 'learning_rate': 0.019046299889018025, 'l2_leaf_reg': 1.8580539734272459}. Best is trial 13 with value: -0.17071661220109824.\n","[I 2023-11-27 21:21:48,002] Trial 14 finished with value: -0.1708557884595764 and parameters: {'n_estimators': 242, 'depth': 8, 'learning_rate': 0.017446493931862813, 'l2_leaf_reg': 1.4409126772159322}. Best is trial 13 with value: -0.17071661220109824.\n","[I 2023-11-27 21:22:06,481] Trial 15 finished with value: -0.17197216728393644 and parameters: {'n_estimators': 240, 'depth': 9, 'learning_rate': 0.05174964989260804, 'l2_leaf_reg': 2.744849732824809}. Best is trial 13 with value: -0.17071661220109824.\n","[I 2023-11-27 21:22:13,287] Trial 16 finished with value: -0.17070492632243897 and parameters: {'n_estimators': 220, 'depth': 5, 'learning_rate': 0.02630577383388498, 'l2_leaf_reg': 0.20270451982236115}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:22:18,044] Trial 17 finished with value: -0.17278453417844655 and parameters: {'n_estimators': 216, 'depth': 5, 'learning_rate': 0.0015040676154487558, 'l2_leaf_reg': 1.198794793726891}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:22:29,640] Trial 18 finished with value: -0.17097962371302 and parameters: {'n_estimators': 211, 'depth': 8, 'learning_rate': 0.031911258656289514, 'l2_leaf_reg': 2.3862205168403836}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:22:38,644] Trial 19 finished with value: -0.17080070782624573 and parameters: {'n_estimators': 264, 'depth': 7, 'learning_rate': 0.012558858264179715, 'l2_leaf_reg': 3.5327897335023746}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:23:14,633] Trial 20 finished with value: -0.17190284938856518 and parameters: {'n_estimators': 157, 'depth': 11, 'learning_rate': 0.026984452244660867, 'l2_leaf_reg': 0.9341361464668334}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:23:20,838] Trial 21 finished with value: -0.1708220818616834 and parameters: {'n_estimators': 272, 'depth': 5, 'learning_rate': 0.012850965167150018, 'l2_leaf_reg': 0.01434048269606776}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:23:28,150] Trial 22 finished with value: -0.170721768609581 and parameters: {'n_estimators': 225, 'depth': 6, 'learning_rate': 0.023183741564540127, 'l2_leaf_reg': 0.9310746975809066}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:24:03,562] Trial 23 finished with value: -0.17121572431802143 and parameters: {'n_estimators': 300, 'depth': 10, 'learning_rate': 0.010968878249108685, 'l2_leaf_reg': 0.781658906160464}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:24:08,559] Trial 24 finished with value: -0.17073112796349754 and parameters: {'n_estimators': 266, 'depth': 4, 'learning_rate': 0.0262506498521757, 'l2_leaf_reg': 2.099729363950554}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:24:18,092] Trial 25 finished with value: -0.1707833338800051 and parameters: {'n_estimators': 225, 'depth': 7, 'learning_rate': 0.01652238987860974, 'l2_leaf_reg': 0.03934795800153658}. Best is trial 16 with value: -0.17070492632243897.\n","[I 2023-11-27 21:24:22,954] Trial 26 finished with value: -0.17068544479723258 and parameters: {'n_estimators': 278, 'depth': 4, 'learning_rate': 0.033898822404920356, 'l2_leaf_reg': 1.56379946030265}. Best is trial 26 with value: -0.17068544479723258.\n","[I 2023-11-27 21:24:26,332] Trial 27 finished with value: -0.17125871445971128 and parameters: {'n_estimators': 199, 'depth': 1, 'learning_rate': 0.0411605836633641, 'l2_leaf_reg': 1.9325957638525324}. Best is trial 26 with value: -0.17068544479723258.\n","[I 2023-11-27 21:24:31,693] Trial 28 finished with value: -0.17072146281525238 and parameters: {'n_estimators': 243, 'depth': 4, 'learning_rate': 0.03410316006194351, 'l2_leaf_reg': 2.7518716699714036}. Best is trial 26 with value: -0.17068544479723258.\n","[I 2023-11-27 21:24:34,202] Trial 29 finished with value: -0.1707717380509938 and parameters: {'n_estimators': 167, 'depth': 3, 'learning_rate': 0.04644197035131244, 'l2_leaf_reg': 1.4336254580232888}. Best is trial 26 with value: -0.17068544479723258.\n","[I 2023-11-27 21:24:37,035] Trial 30 finished with value: -0.1707774976350396 and parameters: {'n_estimators': 126, 'depth': 5, 'learning_rate': 0.032185976788190324, 'l2_leaf_reg': 0.815130449547574}. Best is trial 26 with value: -0.17068544479723258.\n","[I 2023-11-27 21:24:48,380] Trial 31 finished with value: -0.17081093832523178 and parameters: {'n_estimators': 280, 'depth': 7, 'learning_rate': 0.022922267186010637, 'l2_leaf_reg': 0.6843368487041038}. Best is trial 26 with value: -0.17068544479723258.\n","[I 2023-11-27 21:24:54,301] Trial 32 finished with value: -0.17068467323805445 and parameters: {'n_estimators': 259, 'depth': 5, 'learning_rate': 0.02829795051790352, 'l2_leaf_reg': 1.5754712108903675}. Best is trial 32 with value: -0.17068467323805445.\n","[I 2023-11-27 21:24:59,165] Trial 33 finished with value: -0.17100402001234785 and parameters: {'n_estimators': 249, 'depth': 2, 'learning_rate': 0.025990946158109526, 'l2_leaf_reg': 2.1711274366801154}. Best is trial 32 with value: -0.17068467323805445.\n","[I 2023-11-27 21:25:03,896] Trial 34 finished with value: -0.17122365784287058 and parameters: {'n_estimators': 262, 'depth': 4, 'learning_rate': 0.007876494051484023, 'l2_leaf_reg': 1.64235843886062}. Best is trial 32 with value: -0.17068467323805445.\n","[I 2023-11-27 21:25:10,082] Trial 35 finished with value: -0.17067689842732667 and parameters: {'n_estimators': 232, 'depth': 5, 'learning_rate': 0.03766012353802437, 'l2_leaf_reg': 3.4279120207751745}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:25:13,809] Trial 36 finished with value: -0.17092741821152907 and parameters: {'n_estimators': 204, 'depth': 2, 'learning_rate': 0.03878329174818355, 'l2_leaf_reg': 3.2809724650944467}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:25:17,315] Trial 37 finished with value: -0.1707143047073551 and parameters: {'n_estimators': 227, 'depth': 3, 'learning_rate': 0.04879588966520949, 'l2_leaf_reg': 2.3075905593670876}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:25:24,005] Trial 38 finished with value: -0.17068142676088943 and parameters: {'n_estimators': 265, 'depth': 5, 'learning_rate': 0.030325797648842627, 'l2_leaf_reg': 3.1596163229207317}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:25:29,179] Trial 39 finished with value: -0.1707032805167735 and parameters: {'n_estimators': 276, 'depth': 3, 'learning_rate': 0.0421138476090326, 'l2_leaf_reg': 4.013306977365561}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:28:32,594] Trial 40 finished with value: -0.1723128161758149 and parameters: {'n_estimators': 90, 'depth': 14, 'learning_rate': 0.03275701251879628, 'l2_leaf_reg': 3.012125845750625}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:28:36,813] Trial 41 finished with value: -0.170715868747293 and parameters: {'n_estimators': 261, 'depth': 3, 'learning_rate': 0.039304488391956126, 'l2_leaf_reg': 4.139862084027018}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:28:43,998] Trial 42 finished with value: -0.17068650131022045 and parameters: {'n_estimators': 278, 'depth': 4, 'learning_rate': 0.04382978861865304, 'l2_leaf_reg': 3.8689537055329595}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:28:49,063] Trial 43 finished with value: -0.1706937503221839 and parameters: {'n_estimators': 283, 'depth': 4, 'learning_rate': 0.05317791995678759, 'l2_leaf_reg': 4.887840529590772}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:28:56,415] Trial 44 finished with value: -0.1706924810958164 and parameters: {'n_estimators': 256, 'depth': 5, 'learning_rate': 0.04375323963425847, 'l2_leaf_reg': 3.4838669047643878}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:29:00,396] Trial 45 finished with value: -0.1708181278261057 and parameters: {'n_estimators': 300, 'depth': 2, 'learning_rate': 0.03520873780767934, 'l2_leaf_reg': 3.1632796663496445}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:29:04,015] Trial 46 finished with value: -0.17078253391659706 and parameters: {'n_estimators': 187, 'depth': 4, 'learning_rate': 0.029271368273543506, 'l2_leaf_reg': 3.7744253138486914}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:29:13,567] Trial 47 finished with value: -0.17094726608771202 and parameters: {'n_estimators': 234, 'depth': 7, 'learning_rate': 0.04573268994842034, 'l2_leaf_reg': 2.7292257676304406}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:29:20,905] Trial 48 finished with value: -0.17076633984173362 and parameters: {'n_estimators': 284, 'depth': 6, 'learning_rate': 0.03664029942789441, 'l2_leaf_reg': 4.622379222651984}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:29:25,863] Trial 49 finished with value: -0.17131391373119462 and parameters: {'n_estimators': 252, 'depth': 1, 'learning_rate': 0.03043341773254965, 'l2_leaf_reg': 4.356685761987996}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:29:26,688] Trial 50 finished with value: -0.1714306079636128 and parameters: {'n_estimators': 25, 'depth': 5, 'learning_rate': 0.052515247801195326, 'l2_leaf_reg': 5.288107161961754}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:29:31,928] Trial 51 finished with value: -0.17069620141993916 and parameters: {'n_estimators': 258, 'depth': 5, 'learning_rate': 0.04625380427008656, 'l2_leaf_reg': 3.526608940001142}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:29:46,602] Trial 52 finished with value: -0.17127122493773067 and parameters: {'n_estimators': 273, 'depth': 8, 'learning_rate': 0.04085987523659646, 'l2_leaf_reg': 3.843552545702689}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:29:52,544] Trial 53 finished with value: -0.1707073159613602 and parameters: {'n_estimators': 289, 'depth': 4, 'learning_rate': 0.03572086644114531, 'l2_leaf_reg': 2.544706058654855}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:30:00,283] Trial 54 finished with value: -0.1709186932991304 and parameters: {'n_estimators': 252, 'depth': 6, 'learning_rate': 0.057981936325259796, 'l2_leaf_reg': 3.2152540894634187}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:30:05,295] Trial 55 finished with value: -0.17069111557048436 and parameters: {'n_estimators': 236, 'depth': 5, 'learning_rate': 0.04046984923647597, 'l2_leaf_reg': 3.5070388400771537}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:30:12,442] Trial 56 finished with value: -0.17087774402015304 and parameters: {'n_estimators': 231, 'depth': 2, 'learning_rate': 0.039905591065716166, 'l2_leaf_reg': 2.731928064681977}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:30:16,612] Trial 57 finished with value: -0.17074982532032 and parameters: {'n_estimators': 272, 'depth': 3, 'learning_rate': 0.030180428338074224, 'l2_leaf_reg': 1.872977349626121}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:30:22,248] Trial 58 finished with value: -0.17073407559994408 and parameters: {'n_estimators': 210, 'depth': 6, 'learning_rate': 0.03447122806319054, 'l2_leaf_reg': 2.957816103511024}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:30:30,115] Trial 59 finished with value: -0.17082036893568717 and parameters: {'n_estimators': 240, 'depth': 4, 'learning_rate': 0.01964176763718306, 'l2_leaf_reg': 2.4889328280686525}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:30:35,068] Trial 60 finished with value: -0.17069452074086028 and parameters: {'n_estimators': 198, 'depth': 5, 'learning_rate': 0.03757366060422699, 'l2_leaf_reg': 3.9690793647115377}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:30:42,330] Trial 61 finished with value: -0.17069977227432323 and parameters: {'n_estimators': 255, 'depth': 5, 'learning_rate': 0.04339945377725777, 'l2_leaf_reg': 3.464354887613939}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:30:49,857] Trial 62 finished with value: -0.17082654618408827 and parameters: {'n_estimators': 291, 'depth': 6, 'learning_rate': 0.04361861703644325, 'l2_leaf_reg': 3.5607401702186783}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:31:00,918] Trial 63 finished with value: -0.1710399929130338 and parameters: {'n_estimators': 269, 'depth': 7, 'learning_rate': 0.048538531599640805, 'l2_leaf_reg': 3.1370955612343723}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:31:04,339] Trial 64 finished with value: -0.17081639248587152 and parameters: {'n_estimators': 173, 'depth': 4, 'learning_rate': 0.028741109680475694, 'l2_leaf_reg': 4.295607217750352}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:31:05,342] Trial 65 finished with value: -0.1717619718788533 and parameters: {'n_estimators': 38, 'depth': 5, 'learning_rate': 0.024408581151028286, 'l2_leaf_reg': 2.1724940081019124}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:31:26,053] Trial 66 finished with value: -0.1713414593535288 and parameters: {'n_estimators': 243, 'depth': 9, 'learning_rate': 0.03256631417578947, 'l2_leaf_reg': 3.7982829872713584}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:31:33,770] Trial 67 finished with value: -0.17085733592390479 and parameters: {'n_estimators': 234, 'depth': 7, 'learning_rate': 0.0379220904637829, 'l2_leaf_reg': 3.3397954400537793}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:31:40,418] Trial 68 finished with value: -0.17070184728344504 and parameters: {'n_estimators': 218, 'depth': 5, 'learning_rate': 0.027203922069487144, 'l2_leaf_reg': 1.3037061421466722}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:31:44,589] Trial 69 finished with value: -0.17070827606466704 and parameters: {'n_estimators': 265, 'depth': 3, 'learning_rate': 0.04256685466374838, 'l2_leaf_reg': 2.551529790981399}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:31:59,575] Trial 70 finished with value: -0.1709621766832768 and parameters: {'n_estimators': 280, 'depth': 8, 'learning_rate': 0.021775488061186826, 'l2_leaf_reg': 1.7744372751275692}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:04,734] Trial 71 finished with value: -0.17069155128310398 and parameters: {'n_estimators': 281, 'depth': 4, 'learning_rate': 0.05365543373330657, 'l2_leaf_reg': 4.8858274264199615}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:11,888] Trial 72 finished with value: -0.1707127395932416 and parameters: {'n_estimators': 292, 'depth': 4, 'learning_rate': 0.05004619291984573, 'l2_leaf_reg': 4.601101842913806}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:17,291] Trial 73 finished with value: -0.17068961161744528 and parameters: {'n_estimators': 249, 'depth': 5, 'learning_rate': 0.04546625304999007, 'l2_leaf_reg': 4.130524128161553}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:22,908] Trial 74 finished with value: -0.17071672146652772 and parameters: {'n_estimators': 247, 'depth': 4, 'learning_rate': 0.05546748319524922, 'l2_leaf_reg': 5.369651745236851}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:30,709] Trial 75 finished with value: -0.1708215835208246 and parameters: {'n_estimators': 275, 'depth': 6, 'learning_rate': 0.04784723290068121, 'l2_leaf_reg': 4.261568029313657}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:34,932] Trial 76 finished with value: -0.17070004487096074 and parameters: {'n_estimators': 266, 'depth': 3, 'learning_rate': 0.04569864490021251, 'l2_leaf_reg': 4.130608139779319}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:44,283] Trial 77 finished with value: -0.17078937708526978 and parameters: {'n_estimators': 297, 'depth': 6, 'learning_rate': 0.04089676099035168, 'l2_leaf_reg': 4.979549364246151}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:48,059] Trial 78 finished with value: -0.17076415833808414 and parameters: {'n_estimators': 240, 'depth': 3, 'learning_rate': 0.033172989395485165, 'l2_leaf_reg': 3.707367246702197}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:49,498] Trial 79 finished with value: -0.17144550434565412 and parameters: {'n_estimators': 80, 'depth': 2, 'learning_rate': 0.03594995027569154, 'l2_leaf_reg': 2.989541630990548}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:32:56,526] Trial 80 finished with value: -0.17070416726005094 and parameters: {'n_estimators': 282, 'depth': 4, 'learning_rate': 0.051037643023346346, 'l2_leaf_reg': 1.5860182433303138}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:33:01,820] Trial 81 finished with value: -0.1706959995612812 and parameters: {'n_estimators': 256, 'depth': 5, 'learning_rate': 0.044444018367546925, 'l2_leaf_reg': 3.446745092032944}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 21:33:06,179] Trial 82 finished with value: -0.17073657441095894 and parameters: {'n_estimators': 142, 'depth': 5, 'learning_rate': 0.03977143937356494, 'l2_leaf_reg': 4.6527733485472575}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:13:29,142] Trial 83 finished with value: -0.17684262655788294 and parameters: {'n_estimators': 248, 'depth': 16, 'learning_rate': 0.043681379583432996, 'l2_leaf_reg': 4.034675962855371}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:13:37,535] Trial 84 finished with value: -0.17069963494119542 and parameters: {'n_estimators': 263, 'depth': 5, 'learning_rate': 0.04828751527156918, 'l2_leaf_reg': 3.648939181463328}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:13:41,797] Trial 85 finished with value: -0.1707319445406564 and parameters: {'n_estimators': 225, 'depth': 4, 'learning_rate': 0.03128840681767073, 'l2_leaf_reg': 2.8603142430302797}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:13:50,748] Trial 86 finished with value: -0.17078486875371407 and parameters: {'n_estimators': 257, 'depth': 6, 'learning_rate': 0.0380271977346914, 'l2_leaf_reg': 2.2115454069495564}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:13:57,920] Trial 87 finished with value: -0.1707774810597733 and parameters: {'n_estimators': 276, 'depth': 6, 'learning_rate': 0.034892491650943644, 'l2_leaf_reg': 3.926684231000559}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:15:55,121] Trial 88 finished with value: -0.17445869711813883 and parameters: {'n_estimators': 289, 'depth': 12, 'learning_rate': 0.04603926564773844, 'l2_leaf_reg': 3.3123207690246503}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:16:01,114] Trial 89 finished with value: -0.17068965742390751 and parameters: {'n_estimators': 270, 'depth': 5, 'learning_rate': 0.04136596942160062, 'l2_leaf_reg': 1.086074076820276}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:16:07,382] Trial 90 finished with value: -0.17070895008076267 and parameters: {'n_estimators': 269, 'depth': 4, 'learning_rate': 0.041334117704997675, 'l2_leaf_reg': 0.4479621619285141}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:16:13,033] Trial 91 finished with value: -0.17067904697883787 and parameters: {'n_estimators': 261, 'depth': 5, 'learning_rate': 0.03780908685681248, 'l2_leaf_reg': 1.074611747044265}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:16:21,041] Trial 92 finished with value: -0.17069685608034268 and parameters: {'n_estimators': 280, 'depth': 5, 'learning_rate': 0.03726708593326068, 'l2_leaf_reg': 1.1103788840617423}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:16:25,344] Trial 93 finished with value: -0.17073616488605106 and parameters: {'n_estimators': 236, 'depth': 4, 'learning_rate': 0.028244517873496588, 'l2_leaf_reg': 1.3512277627854927}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:16:31,690] Trial 94 finished with value: -0.1706800486744164 and parameters: {'n_estimators': 247, 'depth': 5, 'learning_rate': 0.033138901539421305, 'l2_leaf_reg': 1.0538669667504994}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:16:38,997] Trial 95 finished with value: -0.17075387775708878 and parameters: {'n_estimators': 248, 'depth': 6, 'learning_rate': 0.03348185561483228, 'l2_leaf_reg': 0.9799280490154789}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:16:48,851] Trial 96 finished with value: -0.17081913737053064 and parameters: {'n_estimators': 229, 'depth': 7, 'learning_rate': 0.030149930268745708, 'l2_leaf_reg': 1.1429426104713625}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:16:54,545] Trial 97 finished with value: -0.17068628251326518 and parameters: {'n_estimators': 245, 'depth': 5, 'learning_rate': 0.03506912725433457, 'l2_leaf_reg': 0.6530600616842417}. Best is trial 35 with value: -0.17067689842732667.\n","[I 2023-11-27 22:17:01,813] Trial 98 finished with value: -0.1706749876664384 and parameters: {'n_estimators': 262, 'depth': 5, 'learning_rate': 0.03132300188449907, 'l2_leaf_reg': 0.34757556879216256}. Best is trial 98 with value: -0.1706749876664384.\n","[I 2023-11-27 22:17:07,753] Trial 99 finished with value: -0.17069781297151815 and parameters: {'n_estimators': 259, 'depth': 5, 'learning_rate': 0.024095167782856825, 'l2_leaf_reg': 0.4207748302167421}. Best is trial 98 with value: -0.1706749876664384.\n"]}],"source":["sampler = optuna.samplers.TPESampler(seed=SEED)\n","study = optuna.create_study(direction='maximize', sampler=sampler)\n","study.optimize(cat_objective, n_trials=100)"]},{"cell_type":"markdown","metadata":{"id":"2LPFY68MF9ib"},"source":["- -0.17103880524768514 -> -0.1709317589252495"]},{"cell_type":"code","source":["optuna.visualization.plot_optimization_history(study)\n","plt.show()"],"metadata":{"id":"3d5AuRTrhlyA"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["\n","# [I 2023-11-27 15:16:25,390] Trial 10 finished with value: -0.17005730013688428 and parameters: {'n_estimators': 379, 'depth': 6, 'learning_rate': 0.03750414849938863, 'l2_leaf_reg': 0.17961875614819434}. Best is trial 10 with value: -0.17005730013688428.\n","# [I 2023-11-27 16:25:44,289] Trial 73 finished with value: -0.17002890977945556 and parameters: {'n_estimators': 389, 'depth': 5, 'learning_rate': 0.039369953620866656, 'l2_leaf_reg': 0.7915605925438313}. Best is trial 73 with value: -0.17002890977945556.\n"],"metadata":{"id":"2hgAFWC6Xh8G"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# cat_params = {'n_estimators': 389, 'depth': 5, 'learning_rate': 0.039369953620866656, 'l2_leaf_reg': 0.7915605925438313}"],"metadata":{"id":"wwE4gP2cV9Qo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["cat_params = {'n_estimators': 262, 'depth': 5, 'learning_rate': 0.03132300188449907, 'l2_leaf_reg': 0.34757556879216256}"],"metadata":{"id":"KrdPWhKwC6oR"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SFuFZ97RF9ib"},"outputs":[],"source":["\n","# cat_params = study.best_params\n","# cat_params"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l_p-8ziBF9ib","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701126599266,"user_tz":-540,"elapsed":1916,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}},"outputId":"aae83e88-9c41-492d-bc9c-ac339160d4df"},"outputs":[{"output_type":"stream","name":"stdout","text":["0:\tlearn: 0.4525051\ttotal: 8.89ms\tremaining: 2.32s\n","1:\tlearn: 0.4521576\ttotal: 14.2ms\tremaining: 1.85s\n","2:\tlearn: 0.4518101\ttotal: 18.9ms\tremaining: 1.63s\n","3:\tlearn: 0.4515109\ttotal: 23.9ms\tremaining: 1.54s\n","4:\tlearn: 0.4511986\ttotal: 28.7ms\tremaining: 1.47s\n","5:\tlearn: 0.4509121\ttotal: 33.7ms\tremaining: 1.44s\n","6:\tlearn: 0.4506405\ttotal: 37.9ms\tremaining: 1.38s\n","7:\tlearn: 0.4503960\ttotal: 43.9ms\tremaining: 1.4s\n","8:\tlearn: 0.4501612\ttotal: 50.3ms\tremaining: 1.42s\n","9:\tlearn: 0.4499136\ttotal: 55ms\tremaining: 1.39s\n","10:\tlearn: 0.4496706\ttotal: 59.6ms\tremaining: 1.36s\n","11:\tlearn: 0.4494483\ttotal: 64.3ms\tremaining: 1.34s\n","12:\tlearn: 0.4492353\ttotal: 68.7ms\tremaining: 1.32s\n","13:\tlearn: 0.4490649\ttotal: 73.5ms\tremaining: 1.3s\n","14:\tlearn: 0.4488886\ttotal: 78.1ms\tremaining: 1.29s\n","15:\tlearn: 0.4487031\ttotal: 83ms\tremaining: 1.28s\n","16:\tlearn: 0.4485230\ttotal: 87.6ms\tremaining: 1.26s\n","17:\tlearn: 0.4483467\ttotal: 94.8ms\tremaining: 1.28s\n","18:\tlearn: 0.4481748\ttotal: 104ms\tremaining: 1.33s\n","19:\tlearn: 0.4479970\ttotal: 113ms\tremaining: 1.37s\n","20:\tlearn: 0.4478558\ttotal: 122ms\tremaining: 1.4s\n","21:\tlearn: 0.4477255\ttotal: 132ms\tremaining: 1.44s\n","22:\tlearn: 0.4475801\ttotal: 142ms\tremaining: 1.48s\n","23:\tlearn: 0.4474527\ttotal: 151ms\tremaining: 1.5s\n","24:\tlearn: 0.4473229\ttotal: 160ms\tremaining: 1.52s\n","25:\tlearn: 0.4472094\ttotal: 171ms\tremaining: 1.55s\n","26:\tlearn: 0.4470918\ttotal: 181ms\tremaining: 1.58s\n","27:\tlearn: 0.4469910\ttotal: 190ms\tremaining: 1.59s\n","28:\tlearn: 0.4468932\ttotal: 206ms\tremaining: 1.66s\n","29:\tlearn: 0.4467981\ttotal: 216ms\tremaining: 1.67s\n","30:\tlearn: 0.4466909\ttotal: 223ms\tremaining: 1.66s\n","31:\tlearn: 0.4465947\ttotal: 232ms\tremaining: 1.67s\n","32:\tlearn: 0.4464987\ttotal: 241ms\tremaining: 1.67s\n","33:\tlearn: 0.4464003\ttotal: 250ms\tremaining: 1.68s\n","34:\tlearn: 0.4463220\ttotal: 259ms\tremaining: 1.68s\n","35:\tlearn: 0.4462217\ttotal: 268ms\tremaining: 1.68s\n","36:\tlearn: 0.4461407\ttotal: 279ms\tremaining: 1.7s\n","37:\tlearn: 0.4460669\ttotal: 287ms\tremaining: 1.69s\n","38:\tlearn: 0.4459876\ttotal: 293ms\tremaining: 1.68s\n","39:\tlearn: 0.4459177\ttotal: 303ms\tremaining: 1.68s\n","40:\tlearn: 0.4458484\ttotal: 311ms\tremaining: 1.68s\n","41:\tlearn: 0.4457856\ttotal: 317ms\tremaining: 1.66s\n","42:\tlearn: 0.4457158\ttotal: 321ms\tremaining: 1.64s\n","43:\tlearn: 0.4456455\ttotal: 328ms\tremaining: 1.62s\n","44:\tlearn: 0.4455787\ttotal: 332ms\tremaining: 1.6s\n","45:\tlearn: 0.4455096\ttotal: 338ms\tremaining: 1.58s\n","46:\tlearn: 0.4454516\ttotal: 343ms\tremaining: 1.57s\n","47:\tlearn: 0.4453855\ttotal: 349ms\tremaining: 1.55s\n","48:\tlearn: 0.4453328\ttotal: 354ms\tremaining: 1.54s\n","49:\tlearn: 0.4452678\ttotal: 360ms\tremaining: 1.53s\n","50:\tlearn: 0.4452117\ttotal: 375ms\tremaining: 1.55s\n","51:\tlearn: 0.4451606\ttotal: 386ms\tremaining: 1.56s\n","52:\tlearn: 0.4451188\ttotal: 398ms\tremaining: 1.57s\n","53:\tlearn: 0.4450721\ttotal: 406ms\tremaining: 1.56s\n","54:\tlearn: 0.4450389\ttotal: 418ms\tremaining: 1.57s\n","55:\tlearn: 0.4449876\ttotal: 426ms\tremaining: 1.56s\n","56:\tlearn: 0.4449394\ttotal: 437ms\tremaining: 1.57s\n","57:\tlearn: 0.4449002\ttotal: 446ms\tremaining: 1.57s\n","58:\tlearn: 0.4448538\ttotal: 454ms\tremaining: 1.56s\n","59:\tlearn: 0.4448183\ttotal: 466ms\tremaining: 1.57s\n","60:\tlearn: 0.4447819\ttotal: 473ms\tremaining: 1.56s\n","61:\tlearn: 0.4447377\ttotal: 482ms\tremaining: 1.55s\n","62:\tlearn: 0.4447015\ttotal: 491ms\tremaining: 1.55s\n","63:\tlearn: 0.4446523\ttotal: 501ms\tremaining: 1.55s\n","64:\tlearn: 0.4446116\ttotal: 511ms\tremaining: 1.55s\n","65:\tlearn: 0.4445851\ttotal: 520ms\tremaining: 1.54s\n","66:\tlearn: 0.4445465\ttotal: 528ms\tremaining: 1.54s\n","67:\tlearn: 0.4445115\ttotal: 533ms\tremaining: 1.52s\n","68:\tlearn: 0.4444747\ttotal: 541ms\tremaining: 1.51s\n","69:\tlearn: 0.4444452\ttotal: 550ms\tremaining: 1.51s\n","70:\tlearn: 0.4444151\ttotal: 559ms\tremaining: 1.5s\n","71:\tlearn: 0.4443776\ttotal: 564ms\tremaining: 1.49s\n","72:\tlearn: 0.4443485\ttotal: 570ms\tremaining: 1.48s\n","73:\tlearn: 0.4443177\ttotal: 578ms\tremaining: 1.47s\n","74:\tlearn: 0.4442955\ttotal: 586ms\tremaining: 1.46s\n","75:\tlearn: 0.4442651\ttotal: 600ms\tremaining: 1.47s\n","76:\tlearn: 0.4442311\ttotal: 608ms\tremaining: 1.46s\n","77:\tlearn: 0.4442033\ttotal: 616ms\tremaining: 1.45s\n","78:\tlearn: 0.4441668\ttotal: 628ms\tremaining: 1.45s\n","79:\tlearn: 0.4441427\ttotal: 637ms\tremaining: 1.45s\n","80:\tlearn: 0.4441157\ttotal: 646ms\tremaining: 1.44s\n","81:\tlearn: 0.4440855\ttotal: 656ms\tremaining: 1.44s\n","82:\tlearn: 0.4440590\ttotal: 663ms\tremaining: 1.43s\n","83:\tlearn: 0.4440334\ttotal: 669ms\tremaining: 1.42s\n","84:\tlearn: 0.4440128\ttotal: 675ms\tremaining: 1.4s\n","85:\tlearn: 0.4439870\ttotal: 684ms\tremaining: 1.4s\n","86:\tlearn: 0.4439635\ttotal: 691ms\tremaining: 1.39s\n","87:\tlearn: 0.4439395\ttotal: 700ms\tremaining: 1.38s\n","88:\tlearn: 0.4439209\ttotal: 710ms\tremaining: 1.38s\n","89:\tlearn: 0.4438986\ttotal: 715ms\tremaining: 1.37s\n","90:\tlearn: 0.4438652\ttotal: 724ms\tremaining: 1.36s\n","91:\tlearn: 0.4438406\ttotal: 732ms\tremaining: 1.35s\n","92:\tlearn: 0.4438151\ttotal: 737ms\tremaining: 1.34s\n","93:\tlearn: 0.4437924\ttotal: 743ms\tremaining: 1.33s\n","94:\tlearn: 0.4437743\ttotal: 748ms\tremaining: 1.31s\n","95:\tlearn: 0.4437452\ttotal: 757ms\tremaining: 1.31s\n","96:\tlearn: 0.4437257\ttotal: 767ms\tremaining: 1.3s\n","97:\tlearn: 0.4436995\ttotal: 774ms\tremaining: 1.29s\n","98:\tlearn: 0.4436762\ttotal: 782ms\tremaining: 1.29s\n","99:\tlearn: 0.4436559\ttotal: 792ms\tremaining: 1.28s\n","100:\tlearn: 0.4436349\ttotal: 803ms\tremaining: 1.28s\n","101:\tlearn: 0.4436127\ttotal: 815ms\tremaining: 1.28s\n","102:\tlearn: 0.4435946\ttotal: 824ms\tremaining: 1.27s\n","103:\tlearn: 0.4435777\ttotal: 832ms\tremaining: 1.26s\n","104:\tlearn: 0.4435536\ttotal: 843ms\tremaining: 1.26s\n","105:\tlearn: 0.4435385\ttotal: 852ms\tremaining: 1.25s\n","106:\tlearn: 0.4435222\ttotal: 863ms\tremaining: 1.25s\n","107:\tlearn: 0.4435031\ttotal: 868ms\tremaining: 1.24s\n","108:\tlearn: 0.4434853\ttotal: 876ms\tremaining: 1.23s\n","109:\tlearn: 0.4434683\ttotal: 886ms\tremaining: 1.22s\n","110:\tlearn: 0.4434489\ttotal: 896ms\tremaining: 1.22s\n","111:\tlearn: 0.4434295\ttotal: 904ms\tremaining: 1.21s\n","112:\tlearn: 0.4434135\ttotal: 912ms\tremaining: 1.2s\n","113:\tlearn: 0.4433954\ttotal: 921ms\tremaining: 1.2s\n","114:\tlearn: 0.4433753\ttotal: 932ms\tremaining: 1.19s\n","115:\tlearn: 0.4433599\ttotal: 937ms\tremaining: 1.18s\n","116:\tlearn: 0.4433486\ttotal: 943ms\tremaining: 1.17s\n","117:\tlearn: 0.4433329\ttotal: 951ms\tremaining: 1.16s\n","118:\tlearn: 0.4433132\ttotal: 958ms\tremaining: 1.15s\n","119:\tlearn: 0.4432981\ttotal: 965ms\tremaining: 1.14s\n","120:\tlearn: 0.4432808\ttotal: 975ms\tremaining: 1.14s\n","121:\tlearn: 0.4432682\ttotal: 984ms\tremaining: 1.13s\n","122:\tlearn: 0.4432518\ttotal: 989ms\tremaining: 1.12s\n","123:\tlearn: 0.4432333\ttotal: 996ms\tremaining: 1.11s\n","124:\tlearn: 0.4432201\ttotal: 1.01s\tremaining: 1.1s\n","125:\tlearn: 0.4432057\ttotal: 1.01s\tremaining: 1.09s\n","126:\tlearn: 0.4431861\ttotal: 1.02s\tremaining: 1.08s\n","127:\tlearn: 0.4431698\ttotal: 1.02s\tremaining: 1.07s\n","128:\tlearn: 0.4431537\ttotal: 1.02s\tremaining: 1.05s\n","129:\tlearn: 0.4431400\ttotal: 1.03s\tremaining: 1.04s\n","130:\tlearn: 0.4431202\ttotal: 1.03s\tremaining: 1.03s\n","131:\tlearn: 0.4431031\ttotal: 1.03s\tremaining: 1.02s\n","132:\tlearn: 0.4430879\ttotal: 1.04s\tremaining: 1.01s\n","133:\tlearn: 0.4430710\ttotal: 1.04s\tremaining: 996ms\n","134:\tlearn: 0.4430536\ttotal: 1.05s\tremaining: 985ms\n","135:\tlearn: 0.4430419\ttotal: 1.05s\tremaining: 973ms\n","136:\tlearn: 0.4430270\ttotal: 1.05s\tremaining: 963ms\n","137:\tlearn: 0.4430135\ttotal: 1.06s\tremaining: 954ms\n","138:\tlearn: 0.4429996\ttotal: 1.07s\tremaining: 944ms\n","139:\tlearn: 0.4429899\ttotal: 1.07s\tremaining: 934ms\n","140:\tlearn: 0.4429770\ttotal: 1.07s\tremaining: 923ms\n","141:\tlearn: 0.4429627\ttotal: 1.08s\tremaining: 912ms\n","142:\tlearn: 0.4429495\ttotal: 1.08s\tremaining: 901ms\n","143:\tlearn: 0.4429356\ttotal: 1.09s\tremaining: 890ms\n","144:\tlearn: 0.4429182\ttotal: 1.09s\tremaining: 880ms\n","145:\tlearn: 0.4429043\ttotal: 1.09s\tremaining: 870ms\n","146:\tlearn: 0.4428885\ttotal: 1.1s\tremaining: 859ms\n","147:\tlearn: 0.4428714\ttotal: 1.1s\tremaining: 849ms\n","148:\tlearn: 0.4428611\ttotal: 1.1s\tremaining: 839ms\n","149:\tlearn: 0.4428503\ttotal: 1.11s\tremaining: 829ms\n","150:\tlearn: 0.4428358\ttotal: 1.11s\tremaining: 819ms\n","151:\tlearn: 0.4428152\ttotal: 1.12s\tremaining: 809ms\n","152:\tlearn: 0.4427993\ttotal: 1.12s\tremaining: 799ms\n","153:\tlearn: 0.4427850\ttotal: 1.12s\tremaining: 789ms\n","154:\tlearn: 0.4427736\ttotal: 1.13s\tremaining: 779ms\n","155:\tlearn: 0.4427594\ttotal: 1.13s\tremaining: 769ms\n","156:\tlearn: 0.4427412\ttotal: 1.14s\tremaining: 760ms\n","157:\tlearn: 0.4427267\ttotal: 1.14s\tremaining: 750ms\n","158:\tlearn: 0.4427132\ttotal: 1.14s\tremaining: 741ms\n","159:\tlearn: 0.4427015\ttotal: 1.15s\tremaining: 732ms\n","160:\tlearn: 0.4426811\ttotal: 1.15s\tremaining: 722ms\n","161:\tlearn: 0.4426665\ttotal: 1.16s\tremaining: 713ms\n","162:\tlearn: 0.4426491\ttotal: 1.16s\tremaining: 704ms\n","163:\tlearn: 0.4426370\ttotal: 1.16s\tremaining: 695ms\n","164:\tlearn: 0.4426282\ttotal: 1.17s\tremaining: 686ms\n","165:\tlearn: 0.4426175\ttotal: 1.17s\tremaining: 677ms\n","166:\tlearn: 0.4426046\ttotal: 1.17s\tremaining: 668ms\n","167:\tlearn: 0.4425929\ttotal: 1.18s\tremaining: 659ms\n","168:\tlearn: 0.4425790\ttotal: 1.18s\tremaining: 651ms\n","169:\tlearn: 0.4425634\ttotal: 1.19s\tremaining: 642ms\n","170:\tlearn: 0.4425524\ttotal: 1.19s\tremaining: 633ms\n","171:\tlearn: 0.4425378\ttotal: 1.19s\tremaining: 625ms\n","172:\tlearn: 0.4425263\ttotal: 1.2s\tremaining: 616ms\n","173:\tlearn: 0.4425123\ttotal: 1.21s\tremaining: 610ms\n","174:\tlearn: 0.4424961\ttotal: 1.21s\tremaining: 601ms\n","175:\tlearn: 0.4424881\ttotal: 1.21s\tremaining: 593ms\n","176:\tlearn: 0.4424753\ttotal: 1.22s\tremaining: 584ms\n","177:\tlearn: 0.4424662\ttotal: 1.22s\tremaining: 576ms\n","178:\tlearn: 0.4424577\ttotal: 1.22s\tremaining: 568ms\n","179:\tlearn: 0.4424368\ttotal: 1.23s\tremaining: 560ms\n","180:\tlearn: 0.4424243\ttotal: 1.23s\tremaining: 551ms\n","181:\tlearn: 0.4424156\ttotal: 1.24s\tremaining: 544ms\n","182:\tlearn: 0.4424057\ttotal: 1.24s\tremaining: 536ms\n","183:\tlearn: 0.4423944\ttotal: 1.24s\tremaining: 528ms\n","184:\tlearn: 0.4423821\ttotal: 1.25s\tremaining: 520ms\n","185:\tlearn: 0.4423730\ttotal: 1.25s\tremaining: 512ms\n","186:\tlearn: 0.4423610\ttotal: 1.26s\tremaining: 504ms\n","187:\tlearn: 0.4423474\ttotal: 1.26s\tremaining: 496ms\n","188:\tlearn: 0.4423345\ttotal: 1.26s\tremaining: 488ms\n","189:\tlearn: 0.4423244\ttotal: 1.27s\tremaining: 480ms\n","190:\tlearn: 0.4423126\ttotal: 1.27s\tremaining: 473ms\n","191:\tlearn: 0.4423047\ttotal: 1.27s\tremaining: 465ms\n","192:\tlearn: 0.4422963\ttotal: 1.28s\tremaining: 458ms\n","193:\tlearn: 0.4422843\ttotal: 1.28s\tremaining: 450ms\n","194:\tlearn: 0.4422736\ttotal: 1.29s\tremaining: 443ms\n","195:\tlearn: 0.4422633\ttotal: 1.29s\tremaining: 435ms\n","196:\tlearn: 0.4422509\ttotal: 1.29s\tremaining: 427ms\n","197:\tlearn: 0.4422402\ttotal: 1.3s\tremaining: 420ms\n","198:\tlearn: 0.4422282\ttotal: 1.3s\tremaining: 413ms\n","199:\tlearn: 0.4422161\ttotal: 1.31s\tremaining: 405ms\n","200:\tlearn: 0.4422101\ttotal: 1.31s\tremaining: 398ms\n","201:\tlearn: 0.4421959\ttotal: 1.31s\tremaining: 391ms\n","202:\tlearn: 0.4421849\ttotal: 1.32s\tremaining: 384ms\n","203:\tlearn: 0.4421753\ttotal: 1.32s\tremaining: 377ms\n","204:\tlearn: 0.4421587\ttotal: 1.33s\tremaining: 369ms\n","205:\tlearn: 0.4421447\ttotal: 1.33s\tremaining: 362ms\n","206:\tlearn: 0.4421334\ttotal: 1.34s\tremaining: 355ms\n","207:\tlearn: 0.4421193\ttotal: 1.34s\tremaining: 348ms\n","208:\tlearn: 0.4421043\ttotal: 1.34s\tremaining: 341ms\n","209:\tlearn: 0.4420893\ttotal: 1.35s\tremaining: 334ms\n","210:\tlearn: 0.4420758\ttotal: 1.35s\tremaining: 327ms\n","211:\tlearn: 0.4420700\ttotal: 1.36s\tremaining: 320ms\n","212:\tlearn: 0.4420574\ttotal: 1.36s\tremaining: 313ms\n","213:\tlearn: 0.4420465\ttotal: 1.36s\tremaining: 306ms\n","214:\tlearn: 0.4420365\ttotal: 1.37s\tremaining: 299ms\n","215:\tlearn: 0.4420273\ttotal: 1.37s\tremaining: 292ms\n","216:\tlearn: 0.4420187\ttotal: 1.38s\tremaining: 285ms\n","217:\tlearn: 0.4420093\ttotal: 1.38s\tremaining: 278ms\n","218:\tlearn: 0.4419993\ttotal: 1.38s\tremaining: 272ms\n","219:\tlearn: 0.4419915\ttotal: 1.39s\tremaining: 265ms\n","220:\tlearn: 0.4419818\ttotal: 1.39s\tremaining: 258ms\n","221:\tlearn: 0.4419772\ttotal: 1.39s\tremaining: 251ms\n","222:\tlearn: 0.4419663\ttotal: 1.4s\tremaining: 245ms\n","223:\tlearn: 0.4419576\ttotal: 1.41s\tremaining: 239ms\n","224:\tlearn: 0.4419426\ttotal: 1.41s\tremaining: 232ms\n","225:\tlearn: 0.4419345\ttotal: 1.42s\tremaining: 225ms\n","226:\tlearn: 0.4419262\ttotal: 1.42s\tremaining: 219ms\n","227:\tlearn: 0.4419155\ttotal: 1.42s\tremaining: 212ms\n","228:\tlearn: 0.4419070\ttotal: 1.43s\tremaining: 205ms\n","229:\tlearn: 0.4418985\ttotal: 1.43s\tremaining: 199ms\n","230:\tlearn: 0.4418872\ttotal: 1.43s\tremaining: 193ms\n","231:\tlearn: 0.4418751\ttotal: 1.44s\tremaining: 186ms\n","232:\tlearn: 0.4418650\ttotal: 1.44s\tremaining: 179ms\n","233:\tlearn: 0.4418544\ttotal: 1.45s\tremaining: 173ms\n","234:\tlearn: 0.4418419\ttotal: 1.45s\tremaining: 167ms\n","235:\tlearn: 0.4418348\ttotal: 1.46s\tremaining: 160ms\n","236:\tlearn: 0.4418250\ttotal: 1.46s\tremaining: 154ms\n","237:\tlearn: 0.4418135\ttotal: 1.46s\tremaining: 148ms\n","238:\tlearn: 0.4418011\ttotal: 1.47s\tremaining: 141ms\n","239:\tlearn: 0.4417961\ttotal: 1.47s\tremaining: 135ms\n","240:\tlearn: 0.4417878\ttotal: 1.48s\tremaining: 129ms\n","241:\tlearn: 0.4417739\ttotal: 1.48s\tremaining: 122ms\n","242:\tlearn: 0.4417671\ttotal: 1.48s\tremaining: 116ms\n","243:\tlearn: 0.4417601\ttotal: 1.49s\tremaining: 110ms\n","244:\tlearn: 0.4417514\ttotal: 1.49s\tremaining: 103ms\n","245:\tlearn: 0.4417443\ttotal: 1.5s\tremaining: 97.3ms\n","246:\tlearn: 0.4417343\ttotal: 1.5s\tremaining: 91.1ms\n","247:\tlearn: 0.4417262\ttotal: 1.5s\tremaining: 84.9ms\n","248:\tlearn: 0.4417130\ttotal: 1.51s\tremaining: 78.7ms\n","249:\tlearn: 0.4417037\ttotal: 1.51s\tremaining: 72.5ms\n","250:\tlearn: 0.4416974\ttotal: 1.51s\tremaining: 66.4ms\n","251:\tlearn: 0.4416871\ttotal: 1.52s\tremaining: 60.3ms\n","252:\tlearn: 0.4416708\ttotal: 1.52s\tremaining: 54.2ms\n","253:\tlearn: 0.4416615\ttotal: 1.53s\tremaining: 48.1ms\n","254:\tlearn: 0.4416530\ttotal: 1.53s\tremaining: 42ms\n","255:\tlearn: 0.4416415\ttotal: 1.53s\tremaining: 36ms\n","256:\tlearn: 0.4416323\ttotal: 1.54s\tremaining: 29.9ms\n","257:\tlearn: 0.4416226\ttotal: 1.54s\tremaining: 23.9ms\n","258:\tlearn: 0.4416074\ttotal: 1.54s\tremaining: 17.9ms\n","259:\tlearn: 0.4415965\ttotal: 1.55s\tremaining: 11.9ms\n","260:\tlearn: 0.4415887\ttotal: 1.55s\tremaining: 5.95ms\n","261:\tlearn: 0.4415770\ttotal: 1.56s\tremaining: 0us\n"]},{"output_type":"execute_result","data":{"text/plain":["array([4.36446781, 3.49505211, 5.10258856, ..., 4.43528411, 4.62568325,\n","       4.36330245])"]},"metadata":{},"execution_count":258}],"source":["cat_model = CatBoostRegressor(**cat_params, random_state=SEED)\n","cat_model.fit(train_x, target)\n","cat_pred = cat_model.predict(test_x)\n","cat_pred = np.expm1(cat_pred) # log 역 변환\n","cat_pred"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cEUNyMXlF9ib","colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1701126611685,"user_tz":-540,"elapsed":309,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}},"outputId":"6437eefd-4b27-4491-d3e4-e730276af899"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                   ID      ECLO       cat      lgbm       xgb     avg_3\n","0      ACCIDENT_39609  4.364468  4.042959  4.042324  4.866451  4.317244\n","1      ACCIDENT_39610  3.495052  3.532445  3.541957  4.398742  3.824381\n","2      ACCIDENT_39611  5.102589  5.100870  5.091918  4.286572  4.826454\n","3      ACCIDENT_39612  4.977128  4.954069  4.969166  5.084240  5.002492\n","4      ACCIDENT_39613  4.642570  4.569868  4.657457  3.872896  4.366740\n","...               ...       ...       ...       ...       ...       ...\n","10958  ACCIDENT_50567  4.364468  4.042959  4.042324  4.866451  4.317244\n","10959  ACCIDENT_50568  4.435284  4.486348  4.457663  4.085699  4.343236\n","10960  ACCIDENT_50569  4.435284  4.486348  4.457663  4.085699  4.343236\n","10961  ACCIDENT_50570  4.625683  4.547651  4.513192  3.571238  4.210694\n","10962  ACCIDENT_50571  4.363302  4.417614  4.544230  4.800778  4.587541\n","\n","[10963 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-cf355d24-6e6d-4e25-a4f7-19757341c853\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>ECLO</th>\n","      <th>cat</th>\n","      <th>lgbm</th>\n","      <th>xgb</th>\n","      <th>avg_3</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ACCIDENT_39609</td>\n","      <td>4.364468</td>\n","      <td>4.042959</td>\n","      <td>4.042324</td>\n","      <td>4.866451</td>\n","      <td>4.317244</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ACCIDENT_39610</td>\n","      <td>3.495052</td>\n","      <td>3.532445</td>\n","      <td>3.541957</td>\n","      <td>4.398742</td>\n","      <td>3.824381</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ACCIDENT_39611</td>\n","      <td>5.102589</td>\n","      <td>5.100870</td>\n","      <td>5.091918</td>\n","      <td>4.286572</td>\n","      <td>4.826454</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ACCIDENT_39612</td>\n","      <td>4.977128</td>\n","      <td>4.954069</td>\n","      <td>4.969166</td>\n","      <td>5.084240</td>\n","      <td>5.002492</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ACCIDENT_39613</td>\n","      <td>4.642570</td>\n","      <td>4.569868</td>\n","      <td>4.657457</td>\n","      <td>3.872896</td>\n","      <td>4.366740</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>10958</th>\n","      <td>ACCIDENT_50567</td>\n","      <td>4.364468</td>\n","      <td>4.042959</td>\n","      <td>4.042324</td>\n","      <td>4.866451</td>\n","      <td>4.317244</td>\n","    </tr>\n","    <tr>\n","      <th>10959</th>\n","      <td>ACCIDENT_50568</td>\n","      <td>4.435284</td>\n","      <td>4.486348</td>\n","      <td>4.457663</td>\n","      <td>4.085699</td>\n","      <td>4.343236</td>\n","    </tr>\n","    <tr>\n","      <th>10960</th>\n","      <td>ACCIDENT_50569</td>\n","      <td>4.435284</td>\n","      <td>4.486348</td>\n","      <td>4.457663</td>\n","      <td>4.085699</td>\n","      <td>4.343236</td>\n","    </tr>\n","    <tr>\n","      <th>10961</th>\n","      <td>ACCIDENT_50570</td>\n","      <td>4.625683</td>\n","      <td>4.547651</td>\n","      <td>4.513192</td>\n","      <td>3.571238</td>\n","      <td>4.210694</td>\n","    </tr>\n","    <tr>\n","      <th>10962</th>\n","      <td>ACCIDENT_50571</td>\n","      <td>4.363302</td>\n","      <td>4.417614</td>\n","      <td>4.544230</td>\n","      <td>4.800778</td>\n","      <td>4.587541</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>10963 rows × 6 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cf355d24-6e6d-4e25-a4f7-19757341c853')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-cf355d24-6e6d-4e25-a4f7-19757341c853 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-cf355d24-6e6d-4e25-a4f7-19757341c853');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-4118939d-38d3-452a-8482-db2ff32a5bdf\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-4118939d-38d3-452a-8482-db2ff32a5bdf')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-4118939d-38d3-452a-8482-db2ff32a5bdf button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":260}],"source":["cat_sub = submission.copy()\n","cat_sub['ECLO'] = cat_pred\n","cat_sub"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gHyF7fCjF9ic"},"outputs":[],"source":["cat_sub.to_csv(f\"{DATA_PATH}feature_exp_v10_1127_cat.csv\", index=False)\n","cat_sub.to_csv(\"feature_exp_v10_1127_cat.csv\", index=False)"]},{"cell_type":"markdown","metadata":{"id":"3B-D_Ad9F9ic"},"source":["# 앙상블"]},{"cell_type":"code","source":["# dl_predict = pd.read_csv('feature_exp_v9__1127_dl.csv')\n","# xgb_sub = pd.read_csv('feature_exp_v9__1127_xgb.csv')\n","# lgbm_sub = pd.read_csv('feature_exp_v9__1127_lgbm.csv')\n","# cat_sub = pd.read_csv('feature_exp_v9__1127_cat.csv')"],"metadata":{"id":"N9opwWFZZMoV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["dl_predict"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"erM31xriZq0z","executionInfo":{"status":"ok","timestamp":1701123432102,"user_tz":-540,"elapsed":33,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}},"outputId":"ff580ea2-a58b-46c5-a14c-4d48a713cdc7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[nan],\n","       [nan],\n","       [nan],\n","       ...,\n","       [nan],\n","       [nan],\n","       [nan]], dtype=float32)"]},"metadata":{},"execution_count":248}]},{"cell_type":"code","source":["submission['ECLO']"],"metadata":{"id":"uh6pXM-1QXoI","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701123432102,"user_tz":-540,"elapsed":31,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}},"outputId":"74711ad4-5e7e-4102-c8df-e2d73000ee4b"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0       NaN\n","1       NaN\n","2       NaN\n","3       NaN\n","4       NaN\n","         ..\n","10958   NaN\n","10959   NaN\n","10960   NaN\n","10961   NaN\n","10962   NaN\n","Name: ECLO, Length: 10963, dtype: float32"]},"metadata":{},"execution_count":249}]},{"cell_type":"code","source":["\n","# submission['ECLO'] = dl_predict['ECLO']\n","submission['cat'] =cat_sub['ECLO']\n","submission['lgbm'] =lgbm_sub['ECLO']\n","submission['xgb'] =xgb_sub['ECLO']\n","\n","submission['avg_3'] = (cat_sub['ECLO'] + lgbm_sub['ECLO'] + xgb_sub['ECLO'])/3\n","# submission['avg_4'] = (submission['ECLO'] + cat_sub['ECLO'] + lgbm_sub['ECLO'] + xgb_sub['ECLO'])/4\n","# submission['avg_5'] = submission['ECLO']*0.1 + cat_sub['ECLO']*0.3 + lgbm_sub['ECLO']*0.3 + xgb_sub['ECLO']*0.3\n","\n","submission"],"metadata":{"id":"BIkQ4d6KNqtA","colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1701124003555,"user_tz":-540,"elapsed":10,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}},"outputId":"773a46ed-f40a-4e71-deeb-6123bd84861f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                   ID  ECLO       cat      lgbm       xgb     avg_3\n","0      ACCIDENT_39609   NaN  4.042959  4.042324  4.866451  4.317244\n","1      ACCIDENT_39610   NaN  3.532445  3.541957  4.398742  3.824381\n","2      ACCIDENT_39611   NaN  5.100870  5.091918  4.286572  4.826454\n","3      ACCIDENT_39612   NaN  4.954069  4.969166  5.084240  5.002492\n","4      ACCIDENT_39613   NaN  4.569868  4.657457  3.872896  4.366740\n","...               ...   ...       ...       ...       ...       ...\n","10958  ACCIDENT_50567   NaN  4.042959  4.042324  4.866451  4.317244\n","10959  ACCIDENT_50568   NaN  4.486348  4.457663  4.085699  4.343236\n","10960  ACCIDENT_50569   NaN  4.486348  4.457663  4.085699  4.343236\n","10961  ACCIDENT_50570   NaN  4.547651  4.513192  3.571238  4.210694\n","10962  ACCIDENT_50571   NaN  4.417614  4.544230  4.800778  4.587541\n","\n","[10963 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-a1fa9ad0-1695-4084-be4c-b27611e41ec1\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>ECLO</th>\n","      <th>cat</th>\n","      <th>lgbm</th>\n","      <th>xgb</th>\n","      <th>avg_3</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ACCIDENT_39609</td>\n","      <td>NaN</td>\n","      <td>4.042959</td>\n","      <td>4.042324</td>\n","      <td>4.866451</td>\n","      <td>4.317244</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ACCIDENT_39610</td>\n","      <td>NaN</td>\n","      <td>3.532445</td>\n","      <td>3.541957</td>\n","      <td>4.398742</td>\n","      <td>3.824381</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ACCIDENT_39611</td>\n","      <td>NaN</td>\n","      <td>5.100870</td>\n","      <td>5.091918</td>\n","      <td>4.286572</td>\n","      <td>4.826454</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ACCIDENT_39612</td>\n","      <td>NaN</td>\n","      <td>4.954069</td>\n","      <td>4.969166</td>\n","      <td>5.084240</td>\n","      <td>5.002492</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ACCIDENT_39613</td>\n","      <td>NaN</td>\n","      <td>4.569868</td>\n","      <td>4.657457</td>\n","      <td>3.872896</td>\n","      <td>4.366740</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>10958</th>\n","      <td>ACCIDENT_50567</td>\n","      <td>NaN</td>\n","      <td>4.042959</td>\n","      <td>4.042324</td>\n","      <td>4.866451</td>\n","      <td>4.317244</td>\n","    </tr>\n","    <tr>\n","      <th>10959</th>\n","      <td>ACCIDENT_50568</td>\n","      <td>NaN</td>\n","      <td>4.486348</td>\n","      <td>4.457663</td>\n","      <td>4.085699</td>\n","      <td>4.343236</td>\n","    </tr>\n","    <tr>\n","      <th>10960</th>\n","      <td>ACCIDENT_50569</td>\n","      <td>NaN</td>\n","      <td>4.486348</td>\n","      <td>4.457663</td>\n","      <td>4.085699</td>\n","      <td>4.343236</td>\n","    </tr>\n","    <tr>\n","      <th>10961</th>\n","      <td>ACCIDENT_50570</td>\n","      <td>NaN</td>\n","      <td>4.547651</td>\n","      <td>4.513192</td>\n","      <td>3.571238</td>\n","      <td>4.210694</td>\n","    </tr>\n","    <tr>\n","      <th>10962</th>\n","      <td>ACCIDENT_50571</td>\n","      <td>NaN</td>\n","      <td>4.417614</td>\n","      <td>4.544230</td>\n","      <td>4.800778</td>\n","      <td>4.587541</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>10963 rows × 6 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a1fa9ad0-1695-4084-be4c-b27611e41ec1')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-a1fa9ad0-1695-4084-be4c-b27611e41ec1 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-a1fa9ad0-1695-4084-be4c-b27611e41ec1');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-0739e1cb-88c7-4a7e-8d0c-8c6a58d5e00c\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-0739e1cb-88c7-4a7e-8d0c-8c6a58d5e00c')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-0739e1cb-88c7-4a7e-8d0c-8c6a58d5e00c button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":251}]},{"cell_type":"code","source":["submission['avg_3'].max()"],"metadata":{"id":"OKwq-1akSI7Q","executionInfo":{"status":"ok","timestamp":1701124152628,"user_tz":-540,"elapsed":376,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"0d42e5ca-2eca-4ea9-e378-4a1c26cdd4cd"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["8.445165593587015"]},"metadata":{},"execution_count":252}]},{"cell_type":"code","source":["submission_final = pd.read_csv(f'{DATA_PATH}sample_submission.csv')\n","submission_final"],"metadata":{"id":"T8tuU-ArP-I7","executionInfo":{"status":"ok","timestamp":1701124154654,"user_tz":-540,"elapsed":293,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}},"colab":{"base_uri":"https://localhost:8080/","height":424},"outputId":"50262ba5-3e0f-459b-b15f-95f975263605"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                   ID  ECLO\n","0      ACCIDENT_39609     0\n","1      ACCIDENT_39610     0\n","2      ACCIDENT_39611     0\n","3      ACCIDENT_39612     0\n","4      ACCIDENT_39613     0\n","...               ...   ...\n","10958  ACCIDENT_50567     0\n","10959  ACCIDENT_50568     0\n","10960  ACCIDENT_50569     0\n","10961  ACCIDENT_50570     0\n","10962  ACCIDENT_50571     0\n","\n","[10963 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-01de5bd7-f1b9-4eea-8fd7-8f89169ad17d\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>ECLO</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ACCIDENT_39609</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ACCIDENT_39610</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ACCIDENT_39611</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ACCIDENT_39612</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ACCIDENT_39613</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>10958</th>\n","      <td>ACCIDENT_50567</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>10959</th>\n","      <td>ACCIDENT_50568</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>10960</th>\n","      <td>ACCIDENT_50569</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>10961</th>\n","      <td>ACCIDENT_50570</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>10962</th>\n","      <td>ACCIDENT_50571</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>10963 rows × 2 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-01de5bd7-f1b9-4eea-8fd7-8f89169ad17d')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-01de5bd7-f1b9-4eea-8fd7-8f89169ad17d button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-01de5bd7-f1b9-4eea-8fd7-8f89169ad17d');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-0f7b7b60-5e2e-4b5a-80d7-be6e0ebbced8\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-0f7b7b60-5e2e-4b5a-80d7-be6e0ebbced8')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-0f7b7b60-5e2e-4b5a-80d7-be6e0ebbced8 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":253}]},{"cell_type":"code","source":["submission_final['ECLO'] = submission['avg_3']\n","submission_final"],"metadata":{"id":"qe5WHhrER-TK","executionInfo":{"status":"ok","timestamp":1701124159571,"user_tz":-540,"elapsed":264,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}},"colab":{"base_uri":"https://localhost:8080/","height":424},"outputId":"15c6522a-1a4d-46e0-dd3d-3dac00260df4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                   ID      ECLO\n","0      ACCIDENT_39609  4.317244\n","1      ACCIDENT_39610  3.824381\n","2      ACCIDENT_39611  4.826454\n","3      ACCIDENT_39612  5.002492\n","4      ACCIDENT_39613  4.366740\n","...               ...       ...\n","10958  ACCIDENT_50567  4.317244\n","10959  ACCIDENT_50568  4.343236\n","10960  ACCIDENT_50569  4.343236\n","10961  ACCIDENT_50570  4.210694\n","10962  ACCIDENT_50571  4.587541\n","\n","[10963 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-6bd5c8f6-d3a6-4b6a-9882-39e6741db3bd\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>ECLO</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ACCIDENT_39609</td>\n","      <td>4.317244</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ACCIDENT_39610</td>\n","      <td>3.824381</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ACCIDENT_39611</td>\n","      <td>4.826454</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ACCIDENT_39612</td>\n","      <td>5.002492</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ACCIDENT_39613</td>\n","      <td>4.366740</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>10958</th>\n","      <td>ACCIDENT_50567</td>\n","      <td>4.317244</td>\n","    </tr>\n","    <tr>\n","      <th>10959</th>\n","      <td>ACCIDENT_50568</td>\n","      <td>4.343236</td>\n","    </tr>\n","    <tr>\n","      <th>10960</th>\n","      <td>ACCIDENT_50569</td>\n","      <td>4.343236</td>\n","    </tr>\n","    <tr>\n","      <th>10961</th>\n","      <td>ACCIDENT_50570</td>\n","      <td>4.210694</td>\n","    </tr>\n","    <tr>\n","      <th>10962</th>\n","      <td>ACCIDENT_50571</td>\n","      <td>4.587541</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>10963 rows × 2 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6bd5c8f6-d3a6-4b6a-9882-39e6741db3bd')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-6bd5c8f6-d3a6-4b6a-9882-39e6741db3bd button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-6bd5c8f6-d3a6-4b6a-9882-39e6741db3bd');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-60cbe390-f6d3-479b-a50e-ac54844ae021\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-60cbe390-f6d3-479b-a50e-ac54844ae021')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-60cbe390-f6d3-479b-a50e-ac54844ae021 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":254}]},{"cell_type":"code","source":["submission_final['ECLO'].min()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":180},"id":"HAM4KkmJnj2J","executionInfo":{"status":"error","timestamp":1701136201363,"user_tz":-540,"elapsed":11,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"}},"outputId":"54920410-1924-4084-ab4f-7cc502dd4e6c"},"execution_count":187,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-187-7a5dd4a05b39>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0msubmission_final\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'ECLO'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mNameError\u001b[0m: name 'submission_final' is not defined"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sjRDqGfTF9id"},"outputs":[],"source":["# submission_final.to_csv(f\"{DATA_PATH}ensemble_v8_avg3_1127.csv\", index=False)\n","# submission_final.to_csv(\"ensemble_v8_avg3_1127.csv\", index=False)"]},{"cell_type":"code","source":["submission_final.to_csv(f\"{DATA_PATH}ensemble_v10_avg3_1128.csv\", index=False)\n","submission_final.to_csv(\"ensemble_v10_avg3_1128.csv\", index=False)"],"metadata":{"id":"u6RUp3C3SaDU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submission_final['ECLO'] = submission['avg_3']\n","submission_final"],"metadata":{"id":"wwpWhRzCa4aE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submission_final.to_csv(f\"{DATA_PATH}ensemble_v10_avg3_1127.csv\", index=False)\n","submission_final.to_csv(\"ensemble_v10_avg3_1127.csv\", index=False)"],"metadata":{"id":"SN385ousaqYm"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.13"}},"nbformat":4,"nbformat_minor":0}